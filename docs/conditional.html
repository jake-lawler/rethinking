<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Conditional Manatees | Statistical Rethinking Notes</title>
  <meta name="description" content="My notes on Richard McElreath’s ‘Statistical Rethinking.’" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Conditional Manatees | Statistical Rethinking Notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="My notes on Richard McElreath’s ‘Statistical Rethinking.’" />
  <meta name="github-repo" content="jake-lawler/rethinking" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Conditional Manatees | Statistical Rethinking Notes" />
  
  <meta name="twitter:description" content="My notes on Richard McElreath’s ‘Statistical Rethinking.’" />
  

<meta name="author" content="Jake Lawler" />


<meta name="date" content="2022-02-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ulysses.html"/>
<link rel="next" href="markov_chain.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="prague.html"><a href="prague.html"><i class="fa fa-check"></i><b>1</b> The Golem of Prague</a>
<ul>
<li class="chapter" data-level="1.1" data-path="prague.html"><a href="prague.html#chapter-notes"><i class="fa fa-check"></i><b>1.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="1.2" data-path="prague.html"><a href="prague.html#questions"><i class="fa fa-check"></i><b>1.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="prague.html"><a href="prague.html#further-reading"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="small_worlds.html"><a href="small_worlds.html"><i class="fa fa-check"></i><b>2</b> Small Worlds and Large Worlds</a>
<ul>
<li class="chapter" data-level="2.1" data-path="small_worlds.html"><a href="small_worlds.html#chapter-notes-1"><i class="fa fa-check"></i><b>2.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="2.2" data-path="small_worlds.html"><a href="small_worlds.html#questions-1"><i class="fa fa-check"></i><b>2.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e1"><i class="fa fa-check"></i>2E1</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e2"><i class="fa fa-check"></i>2E2</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e3"><i class="fa fa-check"></i>2E3</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e4"><i class="fa fa-check"></i>2E4</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m1"><i class="fa fa-check"></i>2M1</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m2"><i class="fa fa-check"></i>2M2</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m3"><i class="fa fa-check"></i>2M3</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m4"><i class="fa fa-check"></i>2M4</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m5"><i class="fa fa-check"></i>2M5</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m6"><i class="fa fa-check"></i>2M6</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m7"><i class="fa fa-check"></i>2M7</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h1"><i class="fa fa-check"></i>2H1</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h2"><i class="fa fa-check"></i>2H2</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h3"><i class="fa fa-check"></i>2H3</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h4"><i class="fa fa-check"></i>2H4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#further-reading-1"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html"><i class="fa fa-check"></i><b>3</b> Sampling the Imaginary</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#chapter-notes-2"><i class="fa fa-check"></i><b>3.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="3.2" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#questions-2"><i class="fa fa-check"></i><b>3.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e1-1"><i class="fa fa-check"></i>3E1</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e2-1"><i class="fa fa-check"></i>3E2</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e3-1"><i class="fa fa-check"></i>3E3</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e4-1"><i class="fa fa-check"></i>3E4</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e5"><i class="fa fa-check"></i>3E5</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e6"><i class="fa fa-check"></i>3E6</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e7"><i class="fa fa-check"></i>3E7</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m1-1"><i class="fa fa-check"></i>3M1</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m2-1"><i class="fa fa-check"></i>3M2</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m3-1"><i class="fa fa-check"></i>3M3</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m4-1"><i class="fa fa-check"></i>3M4</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m5-1"><i class="fa fa-check"></i>3M5</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m6-1"><i class="fa fa-check"></i>3M6</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h1-1"><i class="fa fa-check"></i>3H1</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h2-1"><i class="fa fa-check"></i>3H2</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h3-1"><i class="fa fa-check"></i>3H3</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h4-1"><i class="fa fa-check"></i>3H4</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h5"><i class="fa fa-check"></i>3H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#further-reading-2"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geocentric.html"><a href="geocentric.html"><i class="fa fa-check"></i><b>4</b> Geocentric Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="geocentric.html"><a href="geocentric.html#chapter-notes-3"><i class="fa fa-check"></i><b>4.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="geocentric.html"><a href="geocentric.html#model-using-grid-approximation"><i class="fa fa-check"></i><b>4.1.1</b> Model Using Grid Approximation</a></li>
<li class="chapter" data-level="4.1.2" data-path="geocentric.html"><a href="geocentric.html#model-using-quadratic-approximation"><i class="fa fa-check"></i><b>4.1.2</b> Model Using Quadratic Approximation</a></li>
<li class="chapter" data-level="4.1.3" data-path="geocentric.html"><a href="geocentric.html#adding-predictors"><i class="fa fa-check"></i><b>4.1.3</b> Adding Predictors</a></li>
<li class="chapter" data-level="4.1.4" data-path="geocentric.html"><a href="geocentric.html#polynomial-regression"><i class="fa fa-check"></i><b>4.1.4</b> Polynomial Regression</a></li>
<li class="chapter" data-level="4.1.5" data-path="geocentric.html"><a href="geocentric.html#b-splines"><i class="fa fa-check"></i><b>4.1.5</b> B-Splines</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="geocentric.html"><a href="geocentric.html#questions-3"><i class="fa fa-check"></i><b>4.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e1-2"><i class="fa fa-check"></i>4E1</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e2-2"><i class="fa fa-check"></i>4E2</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e3-2"><i class="fa fa-check"></i>4E3</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e4-2"><i class="fa fa-check"></i>4E4</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e5-1"><i class="fa fa-check"></i>4E5</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m1-2"><i class="fa fa-check"></i>4M1</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m2-2"><i class="fa fa-check"></i>4M2</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m3-2"><i class="fa fa-check"></i>4M3</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m4-2"><i class="fa fa-check"></i>4M4</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m5-2"><i class="fa fa-check"></i>4M5</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m6-2"><i class="fa fa-check"></i>4M6</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m7-1"><i class="fa fa-check"></i>4M7</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#further-reading-3"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="many_variables.html"><a href="many_variables.html"><i class="fa fa-check"></i><b>5</b> The Many Variables &amp; The Spurious Waffles</a>
<ul>
<li class="chapter" data-level="5.1" data-path="many_variables.html"><a href="many_variables.html#chapter-notes-4"><i class="fa fa-check"></i><b>5.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="5.2" data-path="many_variables.html"><a href="many_variables.html#questions-4"><i class="fa fa-check"></i><b>5.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e1-3"><i class="fa fa-check"></i>5E1</a></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e2-3"><i class="fa fa-check"></i>5E2</a></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e3-3"><i class="fa fa-check"></i>5E3</a></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e4-3"><i class="fa fa-check"></i>5E4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#further-reading-4"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="haunted_dag.html"><a href="haunted_dag.html"><i class="fa fa-check"></i><b>6</b> The Haunted DAG &amp; The Causal Terror</a>
<ul>
<li class="chapter" data-level="6.1" data-path="haunted_dag.html"><a href="haunted_dag.html#chapter-notes-5"><i class="fa fa-check"></i><b>6.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#multicollinearity"><i class="fa fa-check"></i>Multicollinearity</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#post-treatment-bias"><i class="fa fa-check"></i>Post-Treatment Bias</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#collider-bias"><i class="fa fa-check"></i>Collider Bias</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="haunted_dag.html"><a href="haunted_dag.html#questions-5"><i class="fa fa-check"></i><b>6.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#e1-4"><i class="fa fa-check"></i>6E1</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#e3-4"><i class="fa fa-check"></i>6E3</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#e4-4"><i class="fa fa-check"></i>6E4</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#m1-3"><i class="fa fa-check"></i>6M1</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#m2-3"><i class="fa fa-check"></i>6M2</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#m3-3"><i class="fa fa-check"></i>6M3</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h1-2"><i class="fa fa-check"></i>6H1</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h2-2"><i class="fa fa-check"></i>6H2</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h3-2"><i class="fa fa-check"></i>6H3</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h4-2"><i class="fa fa-check"></i>6H4</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h5-1"><i class="fa fa-check"></i>6H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#further-reading-5"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ulysses.html"><a href="ulysses.html"><i class="fa fa-check"></i><b>7</b> Ulysses’ Compass</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ulysses.html"><a href="ulysses.html#chapter-notes-6"><i class="fa fa-check"></i><b>7.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#brain-volume-model"><i class="fa fa-check"></i>Brain Volume model</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#log-pointwise-predictive-density"><i class="fa fa-check"></i>Log Pointwise Predictive Density</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#simulating-in-and-out-of-sample-deviance-for-varying-parameter-numbers"><i class="fa fa-check"></i>Simulating in and out of sample deviance for varying parameter numbers</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#predicting-predicitve-accuracy"><i class="fa fa-check"></i>Predicting Predicitve Accuracy</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ulysses.html"><a href="ulysses.html#questions-6"><i class="fa fa-check"></i><b>7.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e1-5"><i class="fa fa-check"></i>7E1</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e2-4"><i class="fa fa-check"></i>7E2</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e3-5"><i class="fa fa-check"></i>7E3</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e4-5"><i class="fa fa-check"></i>7E4</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m1-4"><i class="fa fa-check"></i>7M1</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m2-4"><i class="fa fa-check"></i>7M2</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m3-4"><i class="fa fa-check"></i>7M3</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m4-3"><i class="fa fa-check"></i>7M4</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m5-3"><i class="fa fa-check"></i>7M5</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m6-3"><i class="fa fa-check"></i>7M6</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h1-3"><i class="fa fa-check"></i>7H1</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h2-3"><i class="fa fa-check"></i>7H2</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h3-3"><i class="fa fa-check"></i>7H3</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h4-3"><i class="fa fa-check"></i>7H4</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h5-2"><i class="fa fa-check"></i>7H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#further-reading-6"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="conditional.html"><a href="conditional.html"><i class="fa fa-check"></i><b>8</b> Conditional Manatees</a>
<ul>
<li class="chapter" data-level="8.1" data-path="conditional.html"><a href="conditional.html#chapter-notes-7"><i class="fa fa-check"></i><b>8.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#ruggedness-gdp-model"><i class="fa fa-check"></i>Ruggedness &amp; GDP Model</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="conditional.html"><a href="conditional.html#questions-7"><i class="fa fa-check"></i><b>8.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#e1-6"><i class="fa fa-check"></i>8E1</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#e2-5"><i class="fa fa-check"></i>8E2</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#e3-6"><i class="fa fa-check"></i>8E3</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#m1-5"><i class="fa fa-check"></i>8M1</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#m2-5"><i class="fa fa-check"></i>8M2</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#m3-5"><i class="fa fa-check"></i>8M3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="markov_chain.html"><a href="markov_chain.html"><i class="fa fa-check"></i><b>9</b> Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="markov_chain.html"><a href="markov_chain.html#chapter-notes-8"><i class="fa fa-check"></i><b>9.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#a-metropolis-algorithm"><i class="fa fa-check"></i>A Metropolis Algorithm</a></li>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#gibbs-sampling-and-hamiltonian-monte-carlo"><i class="fa fa-check"></i>Gibbs Sampling and Hamiltonian Monte Carlo</a></li>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#posterior-predictive-checks-with-stan"><i class="fa fa-check"></i>Posterior Predictive Checks with Stan</a></li>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#prior-predictive-checks-with-stan"><i class="fa fa-check"></i>Prior Predictive Checks with Stan</a></li>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#diagnostics-comparison---trace-plots-waic-psis"><i class="fa fa-check"></i>Diagnostics &amp; Comparison - Trace Plots, WAIC &amp; PSIS</a></li>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#care-and-feeding-of-your-markov-chain"><i class="fa fa-check"></i>Care and Feeding of Your Markov Chain</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="markov_chain.html"><a href="markov_chain.html#questions-8"><i class="fa fa-check"></i><b>9.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#e1-7"><i class="fa fa-check"></i>9E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#further-reading-7"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="big_entropy.html"><a href="big_entropy.html"><i class="fa fa-check"></i><b>10</b> Big Entropy and the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="10.1" data-path="big_entropy.html"><a href="big_entropy.html#chapter-notes-9"><i class="fa fa-check"></i><b>10.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="big_entropy.html"><a href="big_entropy.html#maximum-entropy"><i class="fa fa-check"></i>Maximum Entropy</a></li>
<li class="chapter" data-level="" data-path="big_entropy.html"><a href="big_entropy.html#generalized-linear-models"><i class="fa fa-check"></i>Generalized Linear Models</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="big_entropy.html"><a href="big_entropy.html#questions-9"><i class="fa fa-check"></i><b>10.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="big_entropy.html"><a href="big_entropy.html#further-resources"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="god_spiked.html"><a href="god_spiked.html"><i class="fa fa-check"></i><b>11</b> God Spiked the Integers</a>
<ul>
<li class="chapter" data-level="11.1" data-path="god_spiked.html"><a href="god_spiked.html#chapter-notes-10"><i class="fa fa-check"></i><b>11.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#binomial-regression"><i class="fa fa-check"></i>Binomial Regression</a></li>
<li class="chapter" data-level="11.1.1" data-path="god_spiked.html"><a href="god_spiked.html#poisson-regression"><i class="fa fa-check"></i><b>11.1.1</b> Poisson Regression</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#multinomial-and-categorical-models"><i class="fa fa-check"></i>Multinomial and Categorical Models</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="god_spiked.html"><a href="god_spiked.html#questions-10"><i class="fa fa-check"></i><b>11.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e1-8"><i class="fa fa-check"></i>11E1</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e2-6"><i class="fa fa-check"></i>11E2</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e3-7"><i class="fa fa-check"></i>11E3</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e4-6"><i class="fa fa-check"></i>11E4</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m1-6"><i class="fa fa-check"></i>11M1</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m2-6"><i class="fa fa-check"></i>11M2</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m3-6"><i class="fa fa-check"></i>11M3</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m4-4"><i class="fa fa-check"></i>11M4</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m5-4"><i class="fa fa-check"></i>11M5</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m6-4"><i class="fa fa-check"></i>11M6</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m7-2"><i class="fa fa-check"></i>11M7</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m8"><i class="fa fa-check"></i>11M8</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h1-4"><i class="fa fa-check"></i>11H1</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h2-4"><i class="fa fa-check"></i>11H2</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h3-4"><i class="fa fa-check"></i>11H3</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h4-4"><i class="fa fa-check"></i>11H4</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h5-3"><i class="fa fa-check"></i>11H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#further-resources-1"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html"><i class="fa fa-check"></i><b>12</b> Monsters and Mixtures</a>
<ul>
<li class="chapter" data-level="12.1" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#chapter-notes-11"><i class="fa fa-check"></i><b>12.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#over-dispersed-counts"><i class="fa fa-check"></i>Over-Dispersed Counts</a></li>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#zero-inflated-outcomes"><i class="fa fa-check"></i>Zero-Inflated Outcomes</a></li>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#ordered-categorical-outcomes"><i class="fa fa-check"></i>Ordered Categorical Outcomes</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#questions-11"><i class="fa fa-check"></i><b>12.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#e1-9"><i class="fa fa-check"></i>12E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#further-resources-2"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="models_memory.html"><a href="models_memory.html"><i class="fa fa-check"></i><b>13</b> Models With Memory</a>
<ul>
<li class="chapter" data-level="13.1" data-path="models_memory.html"><a href="models_memory.html#chapter-notes-12"><i class="fa fa-check"></i><b>13.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#more-than-one-type-of-cluster"><i class="fa fa-check"></i>More Than One Type of Cluster</a></li>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#divergent-transitions-and-non-centered-priors"><i class="fa fa-check"></i>Divergent Transitions and Non-Centered Priors</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="models_memory.html"><a href="models_memory.html#questions-12"><i class="fa fa-check"></i><b>13.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#e1-10"><i class="fa fa-check"></i>13E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#further-resources-3"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="covariance.html"><a href="covariance.html"><i class="fa fa-check"></i><b>14</b> Adventures in Covariance</a>
<ul>
<li class="chapter" data-level="14.1" data-path="covariance.html"><a href="covariance.html#chapter-notes-13"><i class="fa fa-check"></i><b>14.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#varying-slopes-by-construction"><i class="fa fa-check"></i>Varying Slopes by Construction</a></li>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#instruments-and-causal-designs"><i class="fa fa-check"></i>Instruments and Causal Designs</a></li>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#continuous-categories-and-the-gaussian-process"><i class="fa fa-check"></i>Continuous Categories and the Gaussian Process</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="covariance.html"><a href="covariance.html#questions-13"><i class="fa fa-check"></i><b>14.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#e1-11"><i class="fa fa-check"></i>14E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#further-resources-4"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="missing_data.html"><a href="missing_data.html"><i class="fa fa-check"></i><b>15</b> Missing Data and Other Opportunities</a>
<ul>
<li class="chapter" data-level="15.1" data-path="missing_data.html"><a href="missing_data.html#chapter-notes-14"><i class="fa fa-check"></i><b>15.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="missing_data.html"><a href="missing_data.html#measurement-error"><i class="fa fa-check"></i>Measurement Error</a></li>
<li class="chapter" data-level="" data-path="missing_data.html"><a href="missing_data.html#missing-data"><i class="fa fa-check"></i>Missing Data</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="missing_data.html"><a href="missing_data.html#questions-14"><i class="fa fa-check"></i><b>15.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="missing_data.html"><a href="missing_data.html#further-reading-8"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="generalized.html"><a href="generalized.html"><i class="fa fa-check"></i><b>16</b> Generalized Linear Madness</a>
<ul>
<li class="chapter" data-level="16.1" data-path="generalized.html"><a href="generalized.html#chapter-notes-15"><i class="fa fa-check"></i><b>16.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#geometric-people"><i class="fa fa-check"></i>Geometric People</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#hidden-minds-and-observed-behaviour"><i class="fa fa-check"></i>Hidden Minds and Observed Behaviour</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#ordinary-differential-nut-cracking"><i class="fa fa-check"></i>Ordinary Differential Nut Cracking</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#population-dynamics"><i class="fa fa-check"></i>Population Dynamics</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="generalized.html"><a href="generalized.html#questions-15"><i class="fa fa-check"></i><b>16.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#further-reading-9"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Rethinking Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="conditional" class="section level1" number="8">
<h1><span class="header-section-number">Chapter 8</span> Conditional Manatees</h1>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="conditional.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Colours by Paul Tol.</span></span>
<span id="cb225-2"><a href="conditional.html#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Defined in R by Joachim Goedhart </span></span>
<span id="cb225-3"><a href="conditional.html#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Source: doi 10.5281/zenodo.3381072</span></span>
<span id="cb225-4"><a href="conditional.html#cb225-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-5"><a href="conditional.html#cb225-5" aria-hidden="true" tabindex="-1"></a>tol_light <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;#BBCC33&#39;</span>, <span class="st">&#39;#AAAA00&#39;</span>, <span class="st">&#39;#77AADD&#39;</span>, <span class="st">&#39;#EE8866&#39;</span>, <span class="st">&#39;#EEDD88&#39;</span>, <span class="st">&#39;#FFAABB&#39;</span>, <span class="st">&#39;#99DDFF&#39;</span>, <span class="st">&#39;#44BB99&#39;</span>, <span class="st">&#39;#DDDDDD&#39;</span>)</span></code></pre></div>
<div id="chapter-notes-7" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Chapter Notes</h2>
<p>This model introduces interaction effects. The bulk of the chapter is made up of an example about the relationship between terrain ruggedness and GDP, and how this relationship changes with continent. For countries outside of Africa, terrain ruggedness is associated with a lower GDP. This relationship is reversed for countries within Africa. Here’s a DAG:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="conditional.html#cb226-1" aria-hidden="true" tabindex="-1"></a>dag_rugged <span class="ot">&lt;-</span> <span class="fu">dagitty</span>( <span class="st">&quot;dag {U [unobserved];R -&gt; G; C -&gt; G; U-&gt;R; U -&gt; G}&quot;</span>)</span>
<span id="cb226-2"><a href="conditional.html#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coordinates</span>(dag_rugged) <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">x=</span><span class="fu">c</span>(<span class="at">R=</span><span class="dv">0</span>,<span class="at">G=</span><span class="dv">1</span>,<span class="at">U=</span><span class="dv">1</span>,<span class="at">C=</span><span class="dv">2</span>) , <span class="at">y=</span><span class="fu">c</span>(<span class="at">R=</span><span class="dv">0</span>,<span class="at">G=</span><span class="dv">0</span>,<span class="at">C=</span><span class="dv">0</span>,<span class="at">U=</span><span class="dv">1</span>) )</span>
<span id="cb226-3"><a href="conditional.html#cb226-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-4"><a href="conditional.html#cb226-4" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>(dag_rugged)</span></code></pre></div>
<p><img src="08-conditional_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<ul>
<li>R - terrain ruggedness</li>
<li>G - GDP</li>
<li>C - continent</li>
<li>U - unobserved confounds that we’ll ignore for now</li>
</ul>
<p>Note that the DAG is neutral on whether there’s an interaction effect here. Continent and ruggedness could independently effect GDP, or there could be some interaction (i.e. that the way ruggedness effects GDP is dependent on continent).</p>
<p>How do we model interaction effects? The chapter warns against splitting the data by continent, for these reasons:</p>
<ol style="list-style-type: decimal">
<li>Some parameters (like <span class="math inline">\(\sigma\)</span>) don’t depend on continent. Splitting the data makes the model less confident about these parameters unnecessarily.</li>
<li>Without including continent in the model, you can’t quantify the value of distinguishing between African and non-African nations.</li>
<li>If we want to compare models with e.g. information criteria, the models need to all be trained on the same data set.</li>
<li>There are other advantages to pooling data that will become clear once we reach multi-level models in chapter 13.</li>
</ol>
<p>Alright let’s get started with some modelling. We start by loading and processing the data.</p>
<div id="ruggedness-gdp-model" class="section level3 unnumbered">
<h3>Ruggedness &amp; GDP Model</h3>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="conditional.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(rugged) </span>
<span id="cb227-2"><a href="conditional.html#cb227-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-3"><a href="conditional.html#cb227-3" aria-hidden="true" tabindex="-1"></a>data_rugged <span class="ot">&lt;-</span> rugged <span class="sc">%&gt;%</span></span>
<span id="cb227-4"><a href="conditional.html#cb227-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_gdp =</span> <span class="fu">log</span>(rgdppc_2000))<span class="sc">%&gt;%</span></span>
<span id="cb227-5"><a href="conditional.html#cb227-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(log_gdp)) <span class="sc">%&gt;%</span></span>
<span id="cb227-6"><a href="conditional.html#cb227-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_gdp_std =</span> log_gdp<span class="sc">/</span> <span class="fu">mean</span>(log_gdp), <span class="co"># standardising</span></span>
<span id="cb227-7"><a href="conditional.html#cb227-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">rugged_std =</span> rugged<span class="sc">/</span> <span class="fu">max</span>(rugged), <span class="co"># keeping zero ruggedness as a reference point</span></span>
<span id="cb227-8"><a href="conditional.html#cb227-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">cid=</span> <span class="fu">if_else</span>(cont_africa<span class="sc">==</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="co"># continent ID</span></span>
<span id="cb227-9"><a href="conditional.html#cb227-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">cid =</span> <span class="fu">factor</span>(cid))</span></code></pre></div>
<p>Here’s our first pass model, no interaction effects:</p>
<p><span class="math display">\[
\begin{aligned}
\log(y_i) &amp;\sim \text{Normal}(\mu_i,\sigma)\\
\mu_i &amp;= \alpha + \beta(r_i - \bar{r}) \\
\alpha &amp;\sim \text{Normal}(1,0.1)\\
\beta &amp;\sim \text{Normal}(0,0.3)\\
\sigma &amp;\sim \text{Exponential}(1)
\end{aligned}
\]</span>
The chapter does a bit of prior predictive simulation to compare the following priors:</p>
<ul>
<li>Prior Set 1 - <span class="math inline">\(\alpha \sim \text{Normal}(1.1), \beta \sim \text{Normal}(0,1)\)</span></li>
<li>Prior Set 2 - <span class="math inline">\(\alpha \sim \text{Normal}(1.0.1), \beta \sim \text{Normal}(0,0.3)\)</span></li>
</ul>
<p>and settles on the latter. Here’s a plot of 100 prior samples from each:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="conditional.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we generate 100 samples from each of our prior distributions</span></span>
<span id="cb228-2"><a href="conditional.html#cb228-2" aria-hidden="true" tabindex="-1"></a>priors_rugged <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">a=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd=</span><span class="dv">1</span>),<span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd=</span><span class="fl">0.1</span>)),</span>
<span id="cb228-3"><a href="conditional.html#cb228-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">b=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>),<span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd=</span><span class="fl">0.3</span>)),</span>
<span id="cb228-4"><a href="conditional.html#cb228-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">prior_set =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;prior_set_1&quot;</span>,<span class="dv">100</span>),<span class="fu">rep</span>(<span class="st">&quot;prior_set_2&quot;</span>,<span class="dv">100</span>)))</span>
<span id="cb228-5"><a href="conditional.html#cb228-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-6"><a href="conditional.html#cb228-6" aria-hidden="true" tabindex="-1"></a><span class="co"># we plot the lines they imply</span></span>
<span id="cb228-7"><a href="conditional.html#cb228-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(priors_rugged)<span class="sc">+</span></span>
<span id="cb228-8"><a href="conditional.html#cb228-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> b,</span>
<span id="cb228-9"><a href="conditional.html#cb228-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">intercept =</span> a <span class="sc">-</span> b<span class="sc">*</span><span class="fu">mean</span>(data_rugged<span class="sc">$</span>rugged_std) ),<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span> <span class="co"># setting intercept so that x-axis ranges over (0,1)</span></span>
<span id="cb228-10"><a href="conditional.html#cb228-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb228-11"><a href="conditional.html#cb228-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb228-12"><a href="conditional.html#cb228-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">max</span>(data_rugged<span class="sc">$</span>log_gdp_std), <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span> </span>
<span id="cb228-13"><a href="conditional.html#cb228-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(data_rugged<span class="sc">$</span>log_gdp_std), <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb228-14"><a href="conditional.html#cb228-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;ruggedness&quot;</span>)<span class="sc">+</span></span>
<span id="cb228-15"><a href="conditional.html#cb228-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;log GDP (standardised)&quot;</span>)<span class="sc">+</span></span>
<span id="cb228-16"><a href="conditional.html#cb228-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>prior_set) </span></code></pre></div>
<p><img src="08-conditional_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>The red lines are the maximum and minimum GDP observed. Here’s the model with quap, and its posterior:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="conditional.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># regression of log gdp on ruggedness with no interactions</span></span>
<span id="cb229-2"><a href="conditional.html#cb229-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-3"><a href="conditional.html#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb229-4"><a href="conditional.html#cb229-4" aria-hidden="true" tabindex="-1"></a>m8_1 <span class="ot">&lt;-</span> <span class="fu">quap</span>( <span class="fu">alist</span>(</span>
<span id="cb229-5"><a href="conditional.html#cb229-5" aria-hidden="true" tabindex="-1"></a>log_gdp_std <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb229-6"><a href="conditional.html#cb229-6" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b<span class="sc">*</span>( rugged_std <span class="sc">-</span> <span class="fl">0.215</span> ) , </span>
<span id="cb229-7"><a href="conditional.html#cb229-7" aria-hidden="true" tabindex="-1"></a>a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">1</span> , <span class="fl">0.1</span> ) , </span>
<span id="cb229-8"><a href="conditional.html#cb229-8" aria-hidden="true" tabindex="-1"></a>b <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.3</span> ) , sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb229-9"><a href="conditional.html#cb229-9" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data=</span>data_rugged )</span>
<span id="cb229-10"><a href="conditional.html#cb229-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-11"><a href="conditional.html#cb229-11" aria-hidden="true" tabindex="-1"></a><span class="co"># posterior draws with tidybayes</span></span>
<span id="cb229-12"><a href="conditional.html#cb229-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-13"><a href="conditional.html#cb229-13" aria-hidden="true" tabindex="-1"></a>m8_1 <span class="sc">%&gt;%</span></span>
<span id="cb229-14"><a href="conditional.html#cb229-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(a, b, sigma) <span class="sc">%&gt;%</span></span>
<span id="cb229-15"><a href="conditional.html#cb229-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_qi</span>(<span class="at">.width=</span><span class="fl">0.89</span>)<span class="sc">%&gt;%</span></span>
<span id="cb229-16"><a href="conditional.html#cb229-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 7
##   .variable  .value  .lower .upper .width .point .interval
##   &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 a         1.00     0.983  1.02     0.89 mean   qi       
## 2 b         0.00150 -0.0867 0.0870   0.89 mean   qi       
## 3 sigma     0.137    0.125  0.149    0.89 mean   qi</code></pre>
<p>Looking at <span class="math inline">\(b\)</span>, we can see that there’s not much of an association between ruggedness and GDP.</p>
<p>Now to interaction effects. We start by letting the intercept vary with continent (in Africa or not in Africa). That looks like this:</p>
<p><span class="math display">\[
\mu_i = \alpha_{\text{CID}[i]} + \beta(r_i - \bar{r})
\]</span>
where CID is an index variable - 1 for for African nations, 2 otherwise. Here’s the model, and the posterior:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="conditional.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb231-2"><a href="conditional.html#cb231-2" aria-hidden="true" tabindex="-1"></a>m8_2 <span class="ot">&lt;-</span> <span class="fu">quap</span>( <span class="fu">alist</span>(</span>
<span id="cb231-3"><a href="conditional.html#cb231-3" aria-hidden="true" tabindex="-1"></a>log_gdp_std <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb231-4"><a href="conditional.html#cb231-4" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> a[cid] <span class="sc">+</span> b<span class="sc">*</span>( rugged_std <span class="sc">-</span> <span class="fl">0.215</span> ) , </span>
<span id="cb231-5"><a href="conditional.html#cb231-5" aria-hidden="true" tabindex="-1"></a>a[cid] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">1</span> , <span class="fl">0.1</span> ) , </span>
<span id="cb231-6"><a href="conditional.html#cb231-6" aria-hidden="true" tabindex="-1"></a>b <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.3</span> ) , </span>
<span id="cb231-7"><a href="conditional.html#cb231-7" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb231-8"><a href="conditional.html#cb231-8" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data=</span>data_rugged )</span>
<span id="cb231-9"><a href="conditional.html#cb231-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-10"><a href="conditional.html#cb231-10" aria-hidden="true" tabindex="-1"></a>m8_2 <span class="sc">%&gt;%</span></span>
<span id="cb231-11"><a href="conditional.html#cb231-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(a[CID], b, sigma) <span class="sc">%&gt;%</span> <span class="co"># is this the best way to display index variables with tidybayes? revisit</span></span>
<span id="cb231-12"><a href="conditional.html#cb231-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_qi</span>(<span class="at">.width=</span><span class="fl">0.89</span>)<span class="sc">%&gt;%</span></span>
<span id="cb231-13"><a href="conditional.html#cb231-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Warning: `gather_()` was deprecated in tidyr 1.2.0.
## Please use `gather()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<pre><code>## # A tibble: 4 x 8
##     CID .variable  .value .lower .upper .width .point .interval
##   &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1     1 a          0.880   0.854 0.905    0.89 mean   qi       
## 2     2 a          1.05    1.03  1.07     0.89 mean   qi       
## 3    NA b         -0.0461 -0.118 0.0275   0.89 mean   qi       
## 4    NA sigma      0.112   0.103 0.122    0.89 mean   qi</code></pre>
<p>The intercept for African nations seems to be notably lower.</p>
<p>Now we compare the two models using WAIC:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="conditional.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>( m8_1 , m8_2 )</span></code></pre></div>
<pre><code>##           WAIC       SE    dWAIC      dSE    pWAIC       weight
## m8_2 -251.8309 15.30478  0.00000       NA 4.442314 1.000000e+00
## m8_1 -188.7003 13.33426 63.13055 15.18786 2.720143 1.956026e-14</code></pre>
<p>The varying intercept model gets all of the model weight.</p>
<p>Here’s the posterior plot for this model.</p>
<p>Revisit this - wrote this last year and it could be much cleaner. Would prefer to recreate it using tidybayes, ggdist.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="conditional.html#cb236-1" aria-hidden="true" tabindex="-1"></a>rugged_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from=</span><span class="sc">-</span><span class="fl">0.1</span> , <span class="at">to=</span><span class="fl">1.1</span> , <span class="at">length.out=</span><span class="dv">30</span> ) <span class="co"># compute mu over samples, fixing cid=2 and then cid=1 </span></span>
<span id="cb236-2"><a href="conditional.html#cb236-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-3"><a href="conditional.html#cb236-3" aria-hidden="true" tabindex="-1"></a>mu_not_africa <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">link</span>( m8_2 ,</span>
<span id="cb236-4"><a href="conditional.html#cb236-4" aria-hidden="true" tabindex="-1"></a><span class="at">data=</span><span class="fu">tibble</span>( <span class="at">cid=</span><span class="dv">2</span> , <span class="at">rugged_std=</span>rugged_seq ) ))</span>
<span id="cb236-5"><a href="conditional.html#cb236-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-6"><a href="conditional.html#cb236-6" aria-hidden="true" tabindex="-1"></a>mu_africa <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">link</span>( m8_2 ,</span>
<span id="cb236-7"><a href="conditional.html#cb236-7" aria-hidden="true" tabindex="-1"></a><span class="at">data=</span><span class="fu">tibble</span>( <span class="at">cid=</span><span class="dv">1</span> , <span class="at">rugged_std=</span>rugged_seq ) ))</span>
<span id="cb236-8"><a href="conditional.html#cb236-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-9"><a href="conditional.html#cb236-9" aria-hidden="true" tabindex="-1"></a>not_africa_lower <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_dbl</span>(mu_not_africa,quantile,<span class="at">probs=</span><span class="fl">0.025</span>,<span class="at">names=</span><span class="cn">FALSE</span>)</span>
<span id="cb236-10"><a href="conditional.html#cb236-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-11"><a href="conditional.html#cb236-11" aria-hidden="true" tabindex="-1"></a>not_africa_mean <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_dbl</span>(mu_not_africa,mean)</span>
<span id="cb236-12"><a href="conditional.html#cb236-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-13"><a href="conditional.html#cb236-13" aria-hidden="true" tabindex="-1"></a>not_africa_upper <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_dbl</span>(mu_not_africa,quantile,<span class="at">probs=</span><span class="fl">0.975</span>,<span class="at">names=</span><span class="cn">FALSE</span>)</span>
<span id="cb236-14"><a href="conditional.html#cb236-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-15"><a href="conditional.html#cb236-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-16"><a href="conditional.html#cb236-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-17"><a href="conditional.html#cb236-17" aria-hidden="true" tabindex="-1"></a>africa_lower <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_dbl</span>(mu_africa,quantile,<span class="at">probs=</span><span class="fl">0.025</span>,<span class="at">names=</span><span class="cn">FALSE</span>)</span>
<span id="cb236-18"><a href="conditional.html#cb236-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-19"><a href="conditional.html#cb236-19" aria-hidden="true" tabindex="-1"></a>africa_mean <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_dbl</span>(mu_africa,mean)</span>
<span id="cb236-20"><a href="conditional.html#cb236-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-21"><a href="conditional.html#cb236-21" aria-hidden="true" tabindex="-1"></a>africa_upper <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_dbl</span>(mu_africa,quantile,<span class="at">probs=</span><span class="fl">0.975</span>,<span class="at">names=</span><span class="cn">FALSE</span>)</span>
<span id="cb236-22"><a href="conditional.html#cb236-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-23"><a href="conditional.html#cb236-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-24"><a href="conditional.html#cb236-24" aria-hidden="true" tabindex="-1"></a>shaded_interval <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">rugged =</span> rugged_seq, <span class="at">na_lower =</span> not_africa_lower, <span class="at">na_mean =</span> not_africa_mean, <span class="at">na_upper =</span> not_africa_upper,</span>
<span id="cb236-25"><a href="conditional.html#cb236-25" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">a_lower =</span> africa_lower, <span class="at">a_mean =</span> africa_mean, <span class="at">a_upper =</span> africa_upper)</span>
<span id="cb236-26"><a href="conditional.html#cb236-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-27"><a href="conditional.html#cb236-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-28"><a href="conditional.html#cb236-28" aria-hidden="true" tabindex="-1"></a>rugged_precis <span class="ot">&lt;-</span> <span class="fu">precis</span>(m8_2,<span class="at">depth=</span><span class="dv">2</span>)</span>
<span id="cb236-29"><a href="conditional.html#cb236-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-30"><a href="conditional.html#cb236-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> shaded_interval)<span class="sc">+</span></span>
<span id="cb236-31"><a href="conditional.html#cb236-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_rugged, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>rugged_std, <span class="at">y =</span> log_gdp_std, <span class="at">colour =</span> cid))<span class="sc">+</span></span>
<span id="cb236-32"><a href="conditional.html#cb236-32" aria-hidden="true" tabindex="-1"></a><span class="co"># geom_line(aes(x=rugged,y=na_mean),colour=&quot;#00BFC4&quot;)+</span></span>
<span id="cb236-33"><a href="conditional.html#cb236-33" aria-hidden="true" tabindex="-1"></a><span class="co"># geom_line(aes(x=rugged,y=a_mean),colour=&quot;#F8766D&quot;)+</span></span>
<span id="cb236-34"><a href="conditional.html#cb236-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data=</span>rugged_precis, <span class="fu">aes</span>(<span class="at">intercept =</span> mean[<span class="dv">2</span>],<span class="at">slope =</span> mean[<span class="dv">3</span>]), <span class="at">colour=</span> <span class="st">&quot;#00BFC4&quot;</span>)<span class="sc">+</span> </span>
<span id="cb236-35"><a href="conditional.html#cb236-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data=</span>rugged_precis, <span class="fu">aes</span>(<span class="at">intercept =</span> mean[<span class="dv">1</span>],<span class="at">slope =</span> mean[<span class="dv">3</span>]), <span class="at">colour=</span> <span class="st">&quot;#F8766D&quot;</span>)<span class="sc">+</span></span>
<span id="cb236-36"><a href="conditional.html#cb236-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>rugged,<span class="at">ymin=</span>na_lower,<span class="at">ymax=</span>na_upper),<span class="at">alpha=</span><span class="fl">0.1</span>,<span class="at">fill=</span><span class="st">&quot;#00BFC4&quot;</span>)<span class="sc">+</span></span>
<span id="cb236-37"><a href="conditional.html#cb236-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x=</span>rugged,<span class="at">ymin=</span>a_lower,<span class="at">ymax=</span>a_upper),<span class="at">alpha=</span><span class="fl">0.1</span>,<span class="at">fill=</span><span class="st">&quot;#F8766D&quot;</span>)<span class="sc">+</span></span>
<span id="cb236-38"><a href="conditional.html#cb236-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb236-39"><a href="conditional.html#cb236-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Ruggedness&quot;</span>)<span class="sc">+</span></span>
<span id="cb236-40"><a href="conditional.html#cb236-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Log GDP&quot;</span>)<span class="sc">+</span></span>
<span id="cb236-41"><a href="conditional.html#cb236-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span>  <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="08-conditional_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Our model does not allow the slope to vary by continent. Here’s what we need for that:</p>
<p><span class="math display">\[
\mu_i = \alpha_{\text{CID}[i]} + \beta_{\text{CID}[i]}(r_i - \bar{r})
\]</span></p>
<p>And here’s the model with the posterior:</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="conditional.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model allowing slopes to vary</span></span>
<span id="cb237-2"><a href="conditional.html#cb237-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3"><a href="conditional.html#cb237-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb237-4"><a href="conditional.html#cb237-4" aria-hidden="true" tabindex="-1"></a>m8_3 <span class="ot">&lt;-</span> <span class="fu">quap</span>( <span class="fu">alist</span>(</span>
<span id="cb237-5"><a href="conditional.html#cb237-5" aria-hidden="true" tabindex="-1"></a>log_gdp_std <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb237-6"><a href="conditional.html#cb237-6" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> a[cid] <span class="sc">+</span> b[cid]<span class="sc">*</span>( rugged_std <span class="sc">-</span> <span class="fl">0.215</span> ) , </span>
<span id="cb237-7"><a href="conditional.html#cb237-7" aria-hidden="true" tabindex="-1"></a>a[cid] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">1</span> , <span class="fl">0.1</span> ) , </span>
<span id="cb237-8"><a href="conditional.html#cb237-8" aria-hidden="true" tabindex="-1"></a>b[cid] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.3</span> ) , </span>
<span id="cb237-9"><a href="conditional.html#cb237-9" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb237-10"><a href="conditional.html#cb237-10" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data=</span>data_rugged )  </span>
<span id="cb237-11"><a href="conditional.html#cb237-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-12"><a href="conditional.html#cb237-12" aria-hidden="true" tabindex="-1"></a>m8_3 <span class="sc">%&gt;%</span></span>
<span id="cb237-13"><a href="conditional.html#cb237-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(a[CID], b[CID], sigma) <span class="sc">%&gt;%</span> <span class="co"># is this the best way to display index variables with tidybayes? revisit</span></span>
<span id="cb237-14"><a href="conditional.html#cb237-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_qi</span>(<span class="at">.width=</span><span class="fl">0.89</span>)<span class="sc">%&gt;%</span></span>
<span id="cb237-15"><a href="conditional.html#cb237-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 8
##     CID .variable .value  .lower  .upper .width .point .interval
##   &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1     1 a          0.887  0.861   0.912    0.89 mean   qi       
## 2     1 b          0.133  0.0171  0.252    0.89 mean   qi       
## 3     2 a          1.05   1.03    1.07     0.89 mean   qi       
## 4     2 b         -0.141 -0.225  -0.0541   0.89 mean   qi       
## 5    NA sigma      0.109  0.0999  0.119    0.89 mean   qi</code></pre>
<p>Compare the slope <span class="math inline">\(\beta\)</span> for countries inside Africa (CID 1) to the slope for non-African countires (CID 2). It is reversed.</p>
<p>We compare the models using PSIS:</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="conditional.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>( m8_1 , m8_2 , m8_3 , <span class="at">func=</span>PSIS )</span></code></pre></div>
<pre><code>## Some Pareto k values are high (&gt;0.5). Set pointwise=TRUE to inspect individual points.</code></pre>
<pre><code>##           PSIS       SE     dPSIS       dSE    pPSIS       weight
## m8_3 -258.9662 15.25083  0.000000        NA 5.221461 9.716247e-01
## m8_2 -251.8993 15.42071  7.066903  6.574883 4.430118 2.837527e-02
## m8_1 -188.6182 13.27438 70.347931 15.482071 2.752669 5.148010e-16</code></pre>
<p>As well as the table attributing almost all of the weight to the interacting slopes model, we also get a warning about some high-influence countries.</p>
<p>Here’s a plot:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="conditional.html#cb242-1" aria-hidden="true" tabindex="-1"></a>grid_rugged <span class="ot">&lt;-</span> <span class="fu">data_grid</span>(data_rugged,</span>
<span id="cb242-2"><a href="conditional.html#cb242-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">rugged_std=</span><span class="fu">seq_range</span>(rugged_std, <span class="at">n =</span> <span class="dv">11</span>),</span>
<span id="cb242-3"><a href="conditional.html#cb242-3" aria-hidden="true" tabindex="-1"></a>                         cid)</span>
<span id="cb242-4"><a href="conditional.html#cb242-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-5"><a href="conditional.html#cb242-5" aria-hidden="true" tabindex="-1"></a><span class="fu">add_predicted_draws</span>(grid_rugged,m8_3,</span>
<span id="cb242-6"><a href="conditional.html#cb242-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">value =</span> <span class="st">&quot;log_gdp_std&quot;</span>)<span class="sc">%&gt;%</span> <span class="co"># naming the draw outputs to be consistent with data_rugged for convenience</span></span>
<span id="cb242-7"><a href="conditional.html#cb242-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nation =</span> <span class="fu">if_else</span>(cid<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;African Nations&quot;</span>,<span class="st">&quot;Non-African Nations&quot;</span>))<span class="sc">%&gt;%</span> <span class="co"># for plot titles</span></span>
<span id="cb242-8"><a href="conditional.html#cb242-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>rugged_std, <span class="at">y =</span> log_gdp_std))<span class="sc">+</span></span>
<span id="cb242-9"><a href="conditional.html#cb242-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>()<span class="sc">+</span></span>
<span id="cb242-10"><a href="conditional.html#cb242-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>data_rugged<span class="sc">%&gt;%</span></span>
<span id="cb242-11"><a href="conditional.html#cb242-11" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mutate</span>(<span class="at">nation =</span> <span class="fu">if_else</span>(cid<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;African Nations&quot;</span>,<span class="st">&quot;Non-African Nations&quot;</span>)) <span class="co"># need to also add nation here for facetting</span></span>
<span id="cb242-12"><a href="conditional.html#cb242-12" aria-hidden="true" tabindex="-1"></a>             , <span class="fu">aes</span>(<span class="at">colour =</span> nation))<span class="sc">+</span></span>
<span id="cb242-13"><a href="conditional.html#cb242-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>nation)<span class="sc">+</span></span>
<span id="cb242-14"><a href="conditional.html#cb242-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Greys&quot;</span>)<span class="sc">+</span></span>
<span id="cb242-15"><a href="conditional.html#cb242-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="08-conditional_files/figure-html/unnamed-chunk-12-1.png" width="672" />
Now our intercepts and slopes are allowed to vary. I am a bit concerned that the uncertainty around the mean doesn’t seem to change very much over the range of ruggedness. There are a lot more flat countries than rugged ones. I’m pretty sure stat_lineribbon does not force the homogeneity here. Need to revisit. Cf. the plots in the chapter, page 250. Pretty confident this shouldn’t be happening, and it doesn’t happen when I recreate this same plot with Stan and draw samples (see the version of the same plot in the next chapter).</p>
<p>The chapter notes that from the perspective of the model, the interactions are symmetrical. The questions:</p>
<ul>
<li>How much the association between ruggedness and GDP depend on whether the nation is in Africa?, and</li>
<li>How much does the association between whether the nation is in Africa and GDP depend on ruggedness?</li>
</ul>
<p>cannot be distinguished by the model.</p>
<p>The next example in the chapter concerns interaction effects between two or more continuous variables. The categorical case we’ve just seen means we create a new slope and intercept for each category. The continuous case is harder - we must allow the slope to vary continuously with a continuous variable.</p>
<p>The example in the chapter concerns the size of tulip blooms under different soil and lighting conditions. We load in the data:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="conditional.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(tulips) </span>
<span id="cb243-2"><a href="conditional.html#cb243-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-3"><a href="conditional.html#cb243-3" aria-hidden="true" tabindex="-1"></a>data_tulips <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(tulips) <span class="sc">%&gt;%</span></span>
<span id="cb243-4"><a href="conditional.html#cb243-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">blooms_std =</span> blooms <span class="sc">/</span> <span class="fu">max</span>(blooms), <span class="co"># setting between 0 and 1</span></span>
<span id="cb243-5"><a href="conditional.html#cb243-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">water_cent =</span> water <span class="sc">-</span> <span class="fu">mean</span>(water), <span class="co"># centering on 0</span></span>
<span id="cb243-6"><a href="conditional.html#cb243-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">shade_cent =</span> shade <span class="sc">-</span> <span class="fu">mean</span>(shade))</span></code></pre></div>
<p>Here’s the model where both water and shade predict bloom size, but there are no interactions:</p>
<p><span class="math display">\[
\begin{aligned}
B_i &amp;\sim \text{Normal}(\mu_i,\sigma) \\
\mu_i &amp;= \alpha + \beta_WW_i + \beta_SS_i
\end{aligned}
\]</span></p>
<p>After some thinking about priors, here’s the model:</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="conditional.html#cb244-1" aria-hidden="true" tabindex="-1"></a>m8_4 <span class="ot">&lt;-</span> <span class="fu">quap</span>( <span class="fu">alist</span>(</span>
<span id="cb244-2"><a href="conditional.html#cb244-2" aria-hidden="true" tabindex="-1"></a>blooms_std <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb244-3"><a href="conditional.html#cb244-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bw<span class="sc">*</span>water_cent <span class="sc">+</span> bs<span class="sc">*</span>shade_cent , </span>
<span id="cb244-4"><a href="conditional.html#cb244-4" aria-hidden="true" tabindex="-1"></a>a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="fl">0.5</span> , <span class="fl">0.25</span> ) , </span>
<span id="cb244-5"><a href="conditional.html#cb244-5" aria-hidden="true" tabindex="-1"></a>bw <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.25</span> ) , </span>
<span id="cb244-6"><a href="conditional.html#cb244-6" aria-hidden="true" tabindex="-1"></a>bs <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.25</span> ) , </span>
<span id="cb244-7"><a href="conditional.html#cb244-7" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb244-8"><a href="conditional.html#cb244-8" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data=</span>data_tulips )</span></code></pre></div>
<p>But we want interactions. We want the impact of changing either water or shade to be conditional on the level of the other variable. As the chapter puts it:</p>
<blockquote>
<p>if water is low, then decreasing the shade can’t help as much as when water is high.</p>
</blockquote>
<p>We’ll end up with something like this:</p>
<p><span class="math display">\[
\begin{aligned}
B_i &amp;\sim \text{Normal}(\mu_i,\sigma) \\
\mu_i &amp;= \alpha + \gamma_{W,i}W_i + \beta_SS_i \\
\gamma_{W,i} &amp; = \beta_W + \beta_{WS}S_i
\end{aligned}
\]</span></p>
<p>Our parameter <span class="math inline">\(\gamma_{W,i}\)</span> is now the slope that defines how the size of the blooms change with the level of water, and this depends partly on shade. The point about symmetry from earlier still holds, we can expand out the above to get:</p>
<p><span class="math display">\[
\begin{aligned}
B_i &amp;\sim \text{Normal}(\mu_i,\sigma) \\
\mu_i &amp;= \alpha + \beta_W W  + \beta_SS_i + \beta_{WS}S_iW_i\\
\end{aligned}
\]</span></p>
<p>Here’s the model:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="conditional.html#cb245-1" aria-hidden="true" tabindex="-1"></a>m8_5 <span class="ot">&lt;-</span> <span class="fu">quap</span>( <span class="fu">alist</span>(</span>
<span id="cb245-2"><a href="conditional.html#cb245-2" aria-hidden="true" tabindex="-1"></a>blooms_std <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb245-3"><a href="conditional.html#cb245-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bw<span class="sc">*</span>water_cent <span class="sc">+</span> bs<span class="sc">*</span>shade_cent <span class="sc">+</span> bws<span class="sc">*</span>water_cent<span class="sc">*</span>shade_cent , </span>
<span id="cb245-4"><a href="conditional.html#cb245-4" aria-hidden="true" tabindex="-1"></a>a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="fl">0.5</span> , <span class="fl">0.25</span> ) , </span>
<span id="cb245-5"><a href="conditional.html#cb245-5" aria-hidden="true" tabindex="-1"></a>bw <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.25</span> ) , </span>
<span id="cb245-6"><a href="conditional.html#cb245-6" aria-hidden="true" tabindex="-1"></a>bs <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.25</span> ) , </span>
<span id="cb245-7"><a href="conditional.html#cb245-7" aria-hidden="true" tabindex="-1"></a>bws <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.25</span> ) , </span>
<span id="cb245-8"><a href="conditional.html#cb245-8" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb245-9"><a href="conditional.html#cb245-9" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data=</span>data_tulips )</span></code></pre></div>
<p>Let’s try to plot from the posterior. The way the chapter recommends doing this is by creating multiple charts to show the slopes for different levels of one of the variables. Facetting by this variable, in ggplot terms.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="conditional.html#cb246-1" aria-hidden="true" tabindex="-1"></a>grid_tulips <span class="ot">&lt;-</span> <span class="fu">data_grid</span>(data_tulips,</span>
<span id="cb246-2"><a href="conditional.html#cb246-2" aria-hidden="true" tabindex="-1"></a>                         <span class="co"># using 11 grid points for water</span></span>
<span id="cb246-3"><a href="conditional.html#cb246-3" aria-hidden="true" tabindex="-1"></a>                         <span class="co"># there are really only 3 levels in the data but I want to be able to extend this to other continuous variables</span></span>
<span id="cb246-4"><a href="conditional.html#cb246-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">water_cent=</span><span class="fu">seq_range</span>(water_cent, <span class="at">n =</span> <span class="dv">11</span>),</span>
<span id="cb246-5"><a href="conditional.html#cb246-5" aria-hidden="true" tabindex="-1"></a>                         <span class="co"># however I only need as many grid points for shade as facets I want in the plot. I&#39;ve chosen 3</span></span>
<span id="cb246-6"><a href="conditional.html#cb246-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">shade_cent=</span><span class="fu">seq_range</span>(shade_cent, <span class="at">n =</span> <span class="dv">3</span>))</span>
<span id="cb246-7"><a href="conditional.html#cb246-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-8"><a href="conditional.html#cb246-8" aria-hidden="true" tabindex="-1"></a><span class="fu">add_predicted_draws</span>(grid_tulips,m8_5,</span>
<span id="cb246-9"><a href="conditional.html#cb246-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">value =</span> <span class="st">&quot;blooms_std&quot;</span>)<span class="sc">%&gt;%</span> <span class="co"># naming the draw outputs to be consistent with data_tulips for convenience</span></span>
<span id="cb246-10"><a href="conditional.html#cb246-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">shade_level =</span> <span class="fu">paste</span>(<span class="st">&quot;Shade =&quot;</span>,shade_cent))<span class="sc">%&gt;%</span></span>
<span id="cb246-11"><a href="conditional.html#cb246-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>water_cent, <span class="at">y =</span> blooms_std))<span class="sc">+</span></span>
<span id="cb246-12"><a href="conditional.html#cb246-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>()<span class="sc">+</span></span>
<span id="cb246-13"><a href="conditional.html#cb246-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>data_tulips<span class="sc">%&gt;%</span></span>
<span id="cb246-14"><a href="conditional.html#cb246-14" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mutate</span>(<span class="at">shade_level =</span> <span class="fu">paste</span>(<span class="st">&quot;Shade =&quot;</span>,shade_cent)) <span class="co"># need to create shade_level here also for facetting to work. bit clumsy.</span></span>
<span id="cb246-15"><a href="conditional.html#cb246-15" aria-hidden="true" tabindex="-1"></a>             , <span class="at">colour =</span> tol_light[[<span class="dv">4</span>]],<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb246-16"><a href="conditional.html#cb246-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>shade_level)<span class="sc">+</span></span>
<span id="cb246-17"><a href="conditional.html#cb246-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Greys&quot;</span>)</span></code></pre></div>
<p><img src="08-conditional_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Nice. When shade is lowest, water has its highest effect on bloom size.</p>
</div>
</div>
<div id="questions-7" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Questions</h2>
<div id="e1-6" class="section level3 unnumbered">
<h3>8E1</h3>
<div id="question-75" class="section level4 unnumbered">
<h4>Question</h4>
<p>For each of the causal relationships below, name a hypothetical third variable that would lead to an interaction effect.</p>
<ol style="list-style-type: decimal">
<li><p>Bread dough rises because of yeast.</p></li>
<li><p>Education leads to higher income.</p></li>
<li><p>Gasoline makes a car go.</p></li>
</ol>
</div>
<div id="answer-75" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Here are three hypotheses about interaction effects:</p>
<ol style="list-style-type: decimal">
<li><p>The amount that yeast causes bread dough to rise depends on temperature.</p></li>
<li><p>The effect that education has on income depends on the industry you work in.</p></li>
<li><p>That effect that gasoline has on car speed depends on whether the engine is running.</p></li>
</ol>
</div>
</div>
<div id="e2-5" class="section level3 unnumbered">
<h3>8E2</h3>
<div id="question-76" class="section level4 unnumbered">
<h4>Question</h4>
<p>Which of the following explanations invokes an interaction?</p>
<ol style="list-style-type: decimal">
<li><p>Caramelizing onions requires cooking over low heat and making sure the onions do not dry out.</p></li>
<li><p>A car will go faster when it has more cylinders or when it has a better fuel injector.</p></li>
<li><p>Most people acquire their political beliefs from their parents, unless they get them instead from their friends.</p></li>
<li><p>Intelligent animal species tend to be either highly social or have manipulative appendages (hands, tentacles, etc.).</p></li>
</ol>
</div>
<div id="answer-76" class="section level4 unnumbered">
<h4>Answer</h4>
<ol style="list-style-type: decimal">
<li><p>This is an interaction effect. The effect of low heat on caramelisation depends on moisture.</p></li>
<li><p>I don’t know enough about car engines to know if this is an interaction effect. The question doesn’t suggest that the effect of additional cylinders depends on fuel injector quality, so this wouldn’t be an interaction effect.</p></li>
<li><p>Can interpret this sentence as an interaction effect: the effect a person’s parents’ political beliefs on them depends on whether they have adopted their friends’ beliefs.</p></li>
<li><p>Don’t think this suggests an interaction effect.</p></li>
</ol>
</div>
</div>
<div id="e3-6" class="section level3 unnumbered">
<h3>8E3</h3>
<div id="question-77" class="section level4 unnumbered">
<h4>Question</h4>
<p>For each of the explanations in 8E2, write a linear model that expresses the stated relationship.</p>
</div>
<div id="answer-77" class="section level4 unnumbered">
<h4>Answer</h4>
<ol style="list-style-type: decimal">
<li>Caramelizing onions requires cooking over low heat and making sure the onions do not dry out.</li>
</ol>
<p><span class="math display">\[
\begin{aligned}
&amp;\text{Caramelisation} \sim \text{Normal}(\mu,\sigma) \\
&amp;\mu = \alpha + \beta_{h} * \text{heat} + \beta_w * \text{water} + \beta_i * \text{heat}*\text{water} 
\end{aligned}
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>A car will go faster when it has more cylinders or when it has a better fuel injector.</li>
</ol>
<p><span class="math display">\[
\begin{aligned}
&amp;\text{Speed} \sim \text{Normal}(\mu,\sigma) \\
&amp;\mu = \alpha + \beta_{c} * \text{cylinders} + \beta_f * \text{fuel injector quality}  \\
\end{aligned}
\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Most people acquire their political beliefs from their parents, unless they get them instead from their friends.</li>
</ol>
<p><span class="math display">\[
\begin{aligned}
&amp;\text{beliefs} \sim \text{Normal}(\mu,\sigma) \\
&amp;\mu_i = \alpha + \beta_{p} * \text{parents&#39; beliefs}_i + \beta_f * \text{friends&#39; beliefs}_i + \beta_i * \text{parents&#39; beliefs}_i*\text{friends&#39; beliefs}_i  \\
\end{aligned}
\]</span></p>
<ol start="4" style="list-style-type: decimal">
<li>Intelligent animal species tend to be either highly social or have manipulative appendages (hands, tentacles, etc.).</li>
</ol>
<p><span class="math display">\[
\begin{aligned}
&amp;\text{intelligence} \sim \text{Normal}(\mu,\sigma) \\
&amp;\mu_i = \alpha + \beta_{s} * \text{sociality}_i + \beta_a * \text{appendages}_i  \\
\end{aligned}
\]</span></p>
<p>The statement above doesn’t suggest that sociality or manipulative appendages cause intelligence. But that if you want to predict a species’ intelligence, having information about either of those two traits will help you.</p>
</div>
</div>
<div id="m1-5" class="section level3 unnumbered">
<h3>8M1</h3>
<div id="question-78" class="section level4 unnumbered">
<h4>Question</h4>
<p>Recall the tulips example from the chapter. Suppose another set of treatments adjusted the temperature in the greenhouse over two levels: cold and hot.
The data in the chapter were collected at the cold temperature. You find none of the plants grown under the hot temperature developed any blooms at all, regardless of the water and shade levels.</p>
<p>Can you explain this result in terms of interactions between water, shade, and temperature?</p>
</div>
<div id="answer-78" class="section level4 unnumbered">
<h4>Answer</h4>
<p>The effect of water and shade on the development of blooms depends on temperature. At hot temperatures, no amount of light and water will cause blooms.</p>
</div>
</div>
<div id="m2-5" class="section level3 unnumbered">
<h3>8M2</h3>
<div id="question-79" class="section level4 unnumbered">
<h4>Question</h4>
<p>Can you invent a regression equation that would make the bloom size zero, whenever the temperature is hot?</p>
</div>
<div id="answer-79" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Here’s the original model:</p>
<p><span class="math display">\[
\begin{aligned}
&amp;\text{B}_i \sim \text{Normal}(\mu,\sigma) \\
&amp;\mu = \alpha + \beta_{W} * \text{W}_i + \beta_S * \text{S}_i + \beta_{WS} * \text{W}_i* \text{S}_i  \\
\end{aligned}
\]</span></p>
<p>Here’s one that produces no blooms whenever temperature is hot:</p>
<p><span class="math display">\[
\begin{aligned}
&amp;\text{B}_i \sim \text{Normal}(\mu,\sigma) \\
&amp;\mu = \left( alpha + \beta_{W} * \text{W}_i + \beta_S * \text{S}_i + \beta_{WS} * \text{W}_i* \text{S}_i \right) * \text{cold}  \\
\end{aligned}
\]</span></p>
<p>Where the cold variable can take two values, 1 for cold and 0 for hot.</p>
</div>
</div>
<div id="m3-5" class="section level3 unnumbered">
<h3>8M3</h3>
<div id="question-80" class="section level4 unnumbered">
<h4>Question</h4>
<p>In parts of North America, ravens depend upon wolves for their food. This is because ravens are carnivorous but cannot usually kill or open carcasses of prey. Wolves however can and do kill and tear open animals, and they tolerate ravens co-feeding at their kills. This species relationship is generally described as a “species interaction.”</p>
<p>Can you invent a hypothetical set of data on raven population size in which this relationship would manifest as a statistical interaction? Do you think the biological interaction could be linear? Why or why not?</p>
</div>
<div id="answer-80" class="section level4 unnumbered">
<h4>Answer</h4>
<p>What is the outcome variable of interest? Is it population of ravens?</p>
<p>Raven population size
Wolf population size
Prey population size</p>
<p>It may not be linear - perhaps when there are few wolves, increasing the number of wolves permits the raven population to increase with the number of prey animals</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ulysses.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="markov_chain.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/08-conditional.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
