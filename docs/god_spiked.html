<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 God Spiked the Integers | Statistical Rethinking Notes</title>
  <meta name="description" content="My notes on Richard McElreath’s ‘Statistical Rethinking.’" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 God Spiked the Integers | Statistical Rethinking Notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="My notes on Richard McElreath’s ‘Statistical Rethinking.’" />
  <meta name="github-repo" content="jake-lawler/rethinking" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 God Spiked the Integers | Statistical Rethinking Notes" />
  
  <meta name="twitter:description" content="My notes on Richard McElreath’s ‘Statistical Rethinking.’" />
  

<meta name="author" content="Jake Lawler" />


<meta name="date" content="2022-02-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="big_entropy.html"/>
<link rel="next" href="monsters_mixtures.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="prague.html"><a href="prague.html"><i class="fa fa-check"></i><b>1</b> The Golem of Prague</a>
<ul>
<li class="chapter" data-level="1.1" data-path="prague.html"><a href="prague.html#chapter-notes"><i class="fa fa-check"></i><b>1.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="1.2" data-path="prague.html"><a href="prague.html#questions"><i class="fa fa-check"></i><b>1.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="prague.html"><a href="prague.html#further-reading"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="small_worlds.html"><a href="small_worlds.html"><i class="fa fa-check"></i><b>2</b> Small Worlds and Large Worlds</a>
<ul>
<li class="chapter" data-level="2.1" data-path="small_worlds.html"><a href="small_worlds.html#chapter-notes-1"><i class="fa fa-check"></i><b>2.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="2.2" data-path="small_worlds.html"><a href="small_worlds.html#questions-1"><i class="fa fa-check"></i><b>2.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e1"><i class="fa fa-check"></i>2E1</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e2"><i class="fa fa-check"></i>2E2</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e3"><i class="fa fa-check"></i>2E3</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e4"><i class="fa fa-check"></i>2E4</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m1"><i class="fa fa-check"></i>2M1</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m2"><i class="fa fa-check"></i>2M2</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m3"><i class="fa fa-check"></i>2M3</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m4"><i class="fa fa-check"></i>2M4</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m5"><i class="fa fa-check"></i>2M5</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m6"><i class="fa fa-check"></i>2M6</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m7"><i class="fa fa-check"></i>2M7</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h1"><i class="fa fa-check"></i>2H1</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h2"><i class="fa fa-check"></i>2H2</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h3"><i class="fa fa-check"></i>2H3</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h4"><i class="fa fa-check"></i>2H4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#further-reading-1"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html"><i class="fa fa-check"></i><b>3</b> Sampling the Imaginary</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#chapter-notes-2"><i class="fa fa-check"></i><b>3.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="3.2" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#questions-2"><i class="fa fa-check"></i><b>3.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e1-1"><i class="fa fa-check"></i>3E1</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e2-1"><i class="fa fa-check"></i>3E2</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e3-1"><i class="fa fa-check"></i>3E3</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e4-1"><i class="fa fa-check"></i>3E4</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e5"><i class="fa fa-check"></i>3E5</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e6"><i class="fa fa-check"></i>3E6</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e7"><i class="fa fa-check"></i>3E7</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m1-1"><i class="fa fa-check"></i>3M1</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m2-1"><i class="fa fa-check"></i>3M2</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m3-1"><i class="fa fa-check"></i>3M3</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m4-1"><i class="fa fa-check"></i>3M4</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m5-1"><i class="fa fa-check"></i>3M5</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m6-1"><i class="fa fa-check"></i>3M6</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h1-1"><i class="fa fa-check"></i>3H1</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h2-1"><i class="fa fa-check"></i>3H2</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h3-1"><i class="fa fa-check"></i>3H3</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h4-1"><i class="fa fa-check"></i>3H4</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h5"><i class="fa fa-check"></i>3H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#further-reading-2"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geocentric.html"><a href="geocentric.html"><i class="fa fa-check"></i><b>4</b> Geocentric Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="geocentric.html"><a href="geocentric.html#chapter-notes-3"><i class="fa fa-check"></i><b>4.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="geocentric.html"><a href="geocentric.html#model-using-grid-approximation"><i class="fa fa-check"></i><b>4.1.1</b> Model Using Grid Approximation</a></li>
<li class="chapter" data-level="4.1.2" data-path="geocentric.html"><a href="geocentric.html#model-using-quadratic-approximation"><i class="fa fa-check"></i><b>4.1.2</b> Model Using Quadratic Approximation</a></li>
<li class="chapter" data-level="4.1.3" data-path="geocentric.html"><a href="geocentric.html#adding-predictors"><i class="fa fa-check"></i><b>4.1.3</b> Adding Predictors</a></li>
<li class="chapter" data-level="4.1.4" data-path="geocentric.html"><a href="geocentric.html#polynomial-regression"><i class="fa fa-check"></i><b>4.1.4</b> Polynomial Regression</a></li>
<li class="chapter" data-level="4.1.5" data-path="geocentric.html"><a href="geocentric.html#b-splines"><i class="fa fa-check"></i><b>4.1.5</b> B-Splines</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="geocentric.html"><a href="geocentric.html#questions-3"><i class="fa fa-check"></i><b>4.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e1-2"><i class="fa fa-check"></i>4E1</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e2-2"><i class="fa fa-check"></i>4E2</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e3-2"><i class="fa fa-check"></i>4E3</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e4-2"><i class="fa fa-check"></i>4E4</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e5-1"><i class="fa fa-check"></i>4E5</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m1-2"><i class="fa fa-check"></i>4M1</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m2-2"><i class="fa fa-check"></i>4M2</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m3-2"><i class="fa fa-check"></i>4M3</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m4-2"><i class="fa fa-check"></i>4M4</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m5-2"><i class="fa fa-check"></i>4M5</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m6-2"><i class="fa fa-check"></i>4M6</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m7-1"><i class="fa fa-check"></i>4M7</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#further-reading-3"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="many_variables.html"><a href="many_variables.html"><i class="fa fa-check"></i><b>5</b> The Many Variables &amp; The Spurious Waffles</a>
<ul>
<li class="chapter" data-level="5.1" data-path="many_variables.html"><a href="many_variables.html#chapter-notes-4"><i class="fa fa-check"></i><b>5.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="5.2" data-path="many_variables.html"><a href="many_variables.html#questions-4"><i class="fa fa-check"></i><b>5.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e1-3"><i class="fa fa-check"></i>5E1</a></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e2-3"><i class="fa fa-check"></i>5E2</a></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e3-3"><i class="fa fa-check"></i>5E3</a></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e4-3"><i class="fa fa-check"></i>5E4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#further-reading-4"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="haunted_dag.html"><a href="haunted_dag.html"><i class="fa fa-check"></i><b>6</b> The Haunted DAG &amp; The Causal Terror</a>
<ul>
<li class="chapter" data-level="6.1" data-path="haunted_dag.html"><a href="haunted_dag.html#chapter-notes-5"><i class="fa fa-check"></i><b>6.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#multicollinearity"><i class="fa fa-check"></i>Multicollinearity</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#post-treatment-bias"><i class="fa fa-check"></i>Post-Treatment Bias</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#collider-bias"><i class="fa fa-check"></i>Collider Bias</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="haunted_dag.html"><a href="haunted_dag.html#questions-5"><i class="fa fa-check"></i><b>6.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#e1-4"><i class="fa fa-check"></i>6E1</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#e3-4"><i class="fa fa-check"></i>6E3</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#e4-4"><i class="fa fa-check"></i>6E4</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#m1-3"><i class="fa fa-check"></i>6M1</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#m2-3"><i class="fa fa-check"></i>6M2</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#m3-3"><i class="fa fa-check"></i>6M3</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h1-2"><i class="fa fa-check"></i>6H1</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h2-2"><i class="fa fa-check"></i>6H2</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h3-2"><i class="fa fa-check"></i>6H3</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h4-2"><i class="fa fa-check"></i>6H4</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h5-1"><i class="fa fa-check"></i>6H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#further-reading-5"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ulysses.html"><a href="ulysses.html"><i class="fa fa-check"></i><b>7</b> Ulysses’ Compass</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ulysses.html"><a href="ulysses.html#chapter-notes-6"><i class="fa fa-check"></i><b>7.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#brain-volume-model"><i class="fa fa-check"></i>Brain Volume model</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#log-pointwise-predictive-density"><i class="fa fa-check"></i>Log Pointwise Predictive Density</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#simulating-in-and-out-of-sample-deviance-for-varying-parameter-numbers"><i class="fa fa-check"></i>Simulating in and out of sample deviance for varying parameter numbers</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#predicting-predicitve-accuracy"><i class="fa fa-check"></i>Predicting Predicitve Accuracy</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ulysses.html"><a href="ulysses.html#questions-6"><i class="fa fa-check"></i><b>7.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e1-5"><i class="fa fa-check"></i>7E1</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e2-4"><i class="fa fa-check"></i>7E2</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e3-5"><i class="fa fa-check"></i>7E3</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e4-5"><i class="fa fa-check"></i>7E4</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m1-4"><i class="fa fa-check"></i>7M1</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m2-4"><i class="fa fa-check"></i>7M2</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m3-4"><i class="fa fa-check"></i>7M3</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m4-3"><i class="fa fa-check"></i>7M4</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m5-3"><i class="fa fa-check"></i>7M5</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m6-3"><i class="fa fa-check"></i>7M6</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h1-3"><i class="fa fa-check"></i>7H1</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h2-3"><i class="fa fa-check"></i>7H2</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h3-3"><i class="fa fa-check"></i>7H3</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h4-3"><i class="fa fa-check"></i>7H4</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h5-2"><i class="fa fa-check"></i>7H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#further-reading-6"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="conditional.html"><a href="conditional.html"><i class="fa fa-check"></i><b>8</b> Conditional Manatees</a>
<ul>
<li class="chapter" data-level="8.1" data-path="conditional.html"><a href="conditional.html#chapter-notes-7"><i class="fa fa-check"></i><b>8.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#ruggedness-gdp-model"><i class="fa fa-check"></i>Ruggedness &amp; GDP Model</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="conditional.html"><a href="conditional.html#questions-7"><i class="fa fa-check"></i><b>8.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#e1-6"><i class="fa fa-check"></i>8E1</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#e2-5"><i class="fa fa-check"></i>8E2</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#e3-6"><i class="fa fa-check"></i>8E3</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#m1-5"><i class="fa fa-check"></i>8M1</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#m2-5"><i class="fa fa-check"></i>8M2</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#m3-5"><i class="fa fa-check"></i>8M3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="markov_chain.html"><a href="markov_chain.html"><i class="fa fa-check"></i><b>9</b> Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="markov_chain.html"><a href="markov_chain.html#chapter-notes-8"><i class="fa fa-check"></i><b>9.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#simulating-king-markovs-journey-a-metropolis-algorithm"><i class="fa fa-check"></i>Simulating King Markov’s Journey (A Metropolis Algorithm)</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="markov_chain.html"><a href="markov_chain.html#questions-8"><i class="fa fa-check"></i><b>9.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#e1-7"><i class="fa fa-check"></i>9E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#further-reading-7"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="big_entropy.html"><a href="big_entropy.html"><i class="fa fa-check"></i><b>10</b> Big Entropy and the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="10.1" data-path="big_entropy.html"><a href="big_entropy.html#chapter-notes-9"><i class="fa fa-check"></i><b>10.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="big_entropy.html"><a href="big_entropy.html#maximum-entropy"><i class="fa fa-check"></i>Maximum Entropy</a></li>
<li class="chapter" data-level="" data-path="big_entropy.html"><a href="big_entropy.html#generalized-linear-models"><i class="fa fa-check"></i>Generalized Linear Models</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="big_entropy.html"><a href="big_entropy.html#questions-9"><i class="fa fa-check"></i><b>10.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="big_entropy.html"><a href="big_entropy.html#further-resources"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="god_spiked.html"><a href="god_spiked.html"><i class="fa fa-check"></i><b>11</b> God Spiked the Integers</a>
<ul>
<li class="chapter" data-level="11.1" data-path="god_spiked.html"><a href="god_spiked.html#chapter-notes-10"><i class="fa fa-check"></i><b>11.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#binomial-regression"><i class="fa fa-check"></i>Binomial Regression</a></li>
<li class="chapter" data-level="11.1.1" data-path="god_spiked.html"><a href="god_spiked.html#poisson-regression"><i class="fa fa-check"></i><b>11.1.1</b> Poisson Regression</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#multinomial-and-categorical-models"><i class="fa fa-check"></i>Multinomial and Categorical Models</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="god_spiked.html"><a href="god_spiked.html#questions-10"><i class="fa fa-check"></i><b>11.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e1-8"><i class="fa fa-check"></i>11E1</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e2-6"><i class="fa fa-check"></i>11E2</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e3-7"><i class="fa fa-check"></i>11E3</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e4-6"><i class="fa fa-check"></i>11E4</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m1-6"><i class="fa fa-check"></i>11M1</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m2-6"><i class="fa fa-check"></i>11M2</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m3-6"><i class="fa fa-check"></i>11M3</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m4-4"><i class="fa fa-check"></i>11M4</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m5-4"><i class="fa fa-check"></i>11M5</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m6-4"><i class="fa fa-check"></i>11M6</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m7-2"><i class="fa fa-check"></i>11M7</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m8"><i class="fa fa-check"></i>11M8</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h1-4"><i class="fa fa-check"></i>11H1</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h2-4"><i class="fa fa-check"></i>11H2</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h3-4"><i class="fa fa-check"></i>11H3</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h4-4"><i class="fa fa-check"></i>11H4</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h5-3"><i class="fa fa-check"></i>11H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#further-resources-1"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html"><i class="fa fa-check"></i><b>12</b> Monsters and Mixtures</a>
<ul>
<li class="chapter" data-level="12.1" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#chapter-notes-11"><i class="fa fa-check"></i><b>12.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#over-dispersed-counts"><i class="fa fa-check"></i>Over-Dispersed Counts</a></li>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#zero-inflated-outcomes"><i class="fa fa-check"></i>Zero-Inflated Outcomes</a></li>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#ordered-categorical-outcomes"><i class="fa fa-check"></i>Ordered Categorical Outcomes</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#questions-11"><i class="fa fa-check"></i><b>12.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#e1-9"><i class="fa fa-check"></i>12E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#further-resources-2"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="models_memory.html"><a href="models_memory.html"><i class="fa fa-check"></i><b>13</b> Models With Memory</a>
<ul>
<li class="chapter" data-level="13.1" data-path="models_memory.html"><a href="models_memory.html#chapter-notes-12"><i class="fa fa-check"></i><b>13.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#more-than-one-type-of-cluster"><i class="fa fa-check"></i>More Than One Type of Cluster</a></li>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#divergent-transitions-and-non-centered-priors"><i class="fa fa-check"></i>Divergent Transitions and Non-Centered Priors</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="models_memory.html"><a href="models_memory.html#questions-12"><i class="fa fa-check"></i><b>13.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#e1-10"><i class="fa fa-check"></i>13E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#further-resources-3"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="covariance.html"><a href="covariance.html"><i class="fa fa-check"></i><b>14</b> Adventures in Covariance</a>
<ul>
<li class="chapter" data-level="14.1" data-path="covariance.html"><a href="covariance.html#chapter-notes-13"><i class="fa fa-check"></i><b>14.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#varying-slopes-by-construction"><i class="fa fa-check"></i>Varying Slopes by Construction</a></li>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#instruments-and-causal-designs"><i class="fa fa-check"></i>Instruments and Causal Designs</a></li>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#continuous-categories-and-the-gaussian-process"><i class="fa fa-check"></i>Continuous Categories and the Gaussian Process</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="covariance.html"><a href="covariance.html#questions-13"><i class="fa fa-check"></i><b>14.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#e1-11"><i class="fa fa-check"></i>14E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#further-resources-4"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="missing_data.html"><a href="missing_data.html"><i class="fa fa-check"></i><b>15</b> Missing Data and Other Opportunities</a>
<ul>
<li class="chapter" data-level="15.1" data-path="missing_data.html"><a href="missing_data.html#chapter-notes-14"><i class="fa fa-check"></i><b>15.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="missing_data.html"><a href="missing_data.html#measurement-error"><i class="fa fa-check"></i>Measurement Error</a></li>
<li class="chapter" data-level="" data-path="missing_data.html"><a href="missing_data.html#missing-data"><i class="fa fa-check"></i>Missing Data</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="missing_data.html"><a href="missing_data.html#questions-14"><i class="fa fa-check"></i><b>15.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="missing_data.html"><a href="missing_data.html#further-reading-8"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="generalized.html"><a href="generalized.html"><i class="fa fa-check"></i><b>16</b> Generalized Linear Madness</a>
<ul>
<li class="chapter" data-level="16.1" data-path="generalized.html"><a href="generalized.html#chapter-notes-15"><i class="fa fa-check"></i><b>16.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#geometric-people"><i class="fa fa-check"></i>Geometric People</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#hidden-minds-and-observed-behaviour"><i class="fa fa-check"></i>Hidden Minds and Observed Behaviour</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#ordinary-differential-nut-cracking"><i class="fa fa-check"></i>Ordinary Differential Nut Cracking</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#population-dynamics"><i class="fa fa-check"></i>Population Dynamics</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="generalized.html"><a href="generalized.html#questions-15"><i class="fa fa-check"></i><b>16.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#further-reading-9"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Rethinking Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="god_spiked" class="section level1" number="11">
<h1><span class="header-section-number">Chapter 11</span> God Spiked the Integers</h1>
<div id="chapter-notes-10" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Chapter Notes</h2>
<div id="binomial-regression" class="section level3 unnumbered">
<h3>Binomial Regression</h3>
<p>The chapter introduces a case where we might want to use logistic regression. It describes an experiment in which chimpanzees were given the option to pull one of two levers (left or right). Each lever would deliver a tray to the chimpanzee, and also to the opposite end of the table where a partner chimpanzee may or may not be sitting. In all cases the trays delivered to the lever-pulling chimpanzee would contain food, but only one of the levers would deliver food to the partner. The aim of the experiment was to determine whether chimpanzees were more likely to pull the lever that delivers food to the other end of the table if a partner chimpanzee was present.</p>
<p>We start by loading the data and defining an index variable (“treatment”) that takes digits 1-4 with the following meaning:</p>
<ol style="list-style-type: decimal">
<li>Right-hand lever delivers food to both ends of the table, and no partner is present.</li>
<li>Left-hand lever delivers food to both ends of the table, and no partner is present.</li>
<li>Right-hand lever delivers food to both ends of the table, and a partner is present.</li>
<li>Left-hand lever delivers food to both ends of the table, and a partner is present.</li>
</ol>
<p>We model the outcome that the left lever is pulled like so:</p>
<p><span class="math display">\[
\begin{aligned}
L_i &amp;\sim \text{Binomial}(1,p_i) \\
\text{logit}(p_i) &amp;= \alpha_{actor[i]} + \beta_{treatment[i]} \\
\alpha_j &amp;\sim \text{Normal}(0,1.5) \\
\beta_k &amp;\sim \text{Normal}(0,0.5)
\end{aligned}
\]</span></p>
<p>In R:</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="god_spiked.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb241-2"><a href="god_spiked.html#cb241-2" aria-hidden="true" tabindex="-1"></a>m11<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">ulam</span>( <span class="fu">alist</span>(</span>
<span id="cb241-3"><a href="god_spiked.html#cb241-3" aria-hidden="true" tabindex="-1"></a>  pulled_left <span class="sc">~</span> <span class="fu">dbinom</span>( <span class="dv">1</span> , p ) , </span>
<span id="cb241-4"><a href="god_spiked.html#cb241-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> a[actor] <span class="sc">+</span> b[treatment] , </span>
<span id="cb241-5"><a href="god_spiked.html#cb241-5" aria-hidden="true" tabindex="-1"></a>  a[actor] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">1.5</span> ), </span>
<span id="cb241-6"><a href="god_spiked.html#cb241-6" aria-hidden="true" tabindex="-1"></a>  b[treatment] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> )</span>
<span id="cb241-7"><a href="god_spiked.html#cb241-7" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data=</span>data_chimp , <span class="at">chains=</span><span class="dv">4</span> , <span class="at">log_lik=</span><span class="cn">TRUE</span>, <span class="at">cmdstan =</span> <span class="cn">TRUE</span> )</span></code></pre></div>
<p>After transforming them into the outcome scale, we can plot the parameters that represent each chimpanzee:</p>
<pre><code>##         mean         sd      5.5%     94.5%
## a1 0.3906872 0.07593051 0.2713121 0.5170867
## a2 0.9742894 0.01716667 0.9429495 0.9940104
## a3 0.3222523 0.06929863 0.2169651 0.4433149
## a4 0.3234947 0.07037946 0.2213532 0.4426394
## a5 0.3900974 0.07652739 0.2717665 0.5146987
## a6 0.6101797 0.07560688 0.4854886 0.7234966
## a7 0.8694970 0.04508907 0.7920538 0.9310104</code></pre>
<p><img src="11-god_spiked_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Here, values close to zero indicate a preference for the right lever, and values close to one a preference for the left lever.</p>
<p>And here is the same graph for the treatment effects:</p>
<p><img src="11-god_spiked_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Here R and L refer to which level was the pro-social option - right or left. N and P refer to whether a partner was present. If the chimps in this experiment exhibited pro-social behaviour, we’d expect that the pro-social lever would be pulled more often in the presence of a partner. I.e. we want to compare R/P against R/N, and L/P against L/N.</p>
<p>We can see that when right is the pro-social option there is a slight tendency for the chimps to pull the right lever more when a partner is present. There is no similar tendency to pull the left lever more when a partner is present when the left lever is the pro-social choice.</p>
<p>Revisit: Recreate Figure 11.4?</p>
</div>
<div id="poisson-regression" class="section level3" number="11.1.1">
<h3><span class="header-section-number">11.1.1</span> Poisson Regression</h3>
<p>The chapter introduces the Poisson distribution, and then sets up an example model using data on tool use among historical societies in Oceania.</p>
<p>We want to model tool use among these societies, with predictors populations size, and amount of contact with other populations. Our model is:</p>
<p><span class="math display">\[
\begin{aligned}
T_i &amp;\sim \text{Poisson}(\lambda_i) \\
\log \lambda_i &amp;= \alpha_{\text{CID}[i]}+ \beta_{\text{CID}[i]} \log P_i \\
\alpha_j &amp;\sim \text{Normal}(3,0.5) \\
\beta_j &amp;\sim \text{Normal}(0,0.2)\\
\end{aligned}
\]</span></p>
<p>Here it is in R:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="god_spiked.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb243-2"><a href="god_spiked.html#cb243-2" aria-hidden="true" tabindex="-1"></a>m11<span class="fl">.10</span> <span class="ot">&lt;-</span> <span class="fu">ulam</span>( <span class="fu">alist</span>( </span>
<span id="cb243-3"><a href="god_spiked.html#cb243-3" aria-hidden="true" tabindex="-1"></a>  T <span class="sc">~</span> <span class="fu">dpois</span>( lambda ), </span>
<span id="cb243-4"><a href="god_spiked.html#cb243-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(lambda) <span class="ot">&lt;-</span> a[cid] <span class="sc">+</span> b[cid]<span class="sc">*</span>P, </span>
<span id="cb243-5"><a href="god_spiked.html#cb243-5" aria-hidden="true" tabindex="-1"></a>  a[cid] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">3</span> , <span class="fl">0.5</span> ), </span>
<span id="cb243-6"><a href="god_spiked.html#cb243-6" aria-hidden="true" tabindex="-1"></a>  b[cid] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.2</span> )</span>
<span id="cb243-7"><a href="god_spiked.html#cb243-7" aria-hidden="true" tabindex="-1"></a>), <span class="at">data=</span>data_tool , <span class="at">chains=</span><span class="dv">4</span> , <span class="at">log_lik=</span><span class="cn">TRUE</span>, <span class="at">cmdstan =</span> <span class="cn">TRUE</span> )</span></code></pre></div>
<p>We plot the posterior predictions:</p>
<p><img src="11-god_spiked_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Here blue dots are high contact, and red low contact societies. The size of the points is scaled by Pareto k-value.</p>
<p>Revisit: Theory-based model - include</p>
<div id="negative-binomial-models" class="section level4 unnumbered">
<h4>Negative Binomial Models</h4>
<p>The chapter introduces an extension of the Poisson generalised linear model that uses the negative binomial distribution. This adds the ability to adjust our model for data over varying exposures. A toy example is introduced to explain.</p>
<p>We own a monastery that produces manuscripts at a rate <span class="math inline">\(\lambda\)</span> of 1.5 per day. We simulate data over a month:</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="god_spiked.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">47</span>)</span>
<span id="cb244-2"><a href="god_spiked.html#cb244-2" aria-hidden="true" tabindex="-1"></a>num_days <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb244-3"><a href="god_spiked.html#cb244-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-4"><a href="god_spiked.html#cb244-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rpois</span>(num_days, <span class="fl">1.5</span>)</span></code></pre></div>
<p>We are considering acquiring a new monastery, and want to compare its productivity. However this one does not keep a daily record of manuscript production, but instead a weekly one. The <em>exposure</em> is different: seven days instead of one. Our task will be to model the rate of manuscript production at each monastery in order to inform our purchasing decision.</p>
<p>The (unknown to us) daily rate of the second monastery is actually 0.5 manuscripts per day, and we simulate 4 weeks worth of data on that basis:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="god_spiked.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">47</span>)</span>
<span id="cb245-2"><a href="god_spiked.html#cb245-2" aria-hidden="true" tabindex="-1"></a>num_weeks <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb245-3"><a href="god_spiked.html#cb245-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-4"><a href="god_spiked.html#cb245-4" aria-hidden="true" tabindex="-1"></a>y_new <span class="ot">&lt;-</span> <span class="fu">rpois</span>(num_weeks, <span class="fl">0.5</span><span class="sc">*</span><span class="dv">7</span>)</span></code></pre></div>
<p>We collect these two sets of data into one data frame.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="god_spiked.html#cb246-1" aria-hidden="true" tabindex="-1"></a>data_manu <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">y_all =</span> <span class="fu">c</span>(y,y_new),</span>
<span id="cb246-2"><a href="god_spiked.html#cb246-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">exposure =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">30</span>),<span class="fu">rep</span>(<span class="dv">7</span>,<span class="dv">4</span>)),</span>
<span id="cb246-3"><a href="god_spiked.html#cb246-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">monastery =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">30</span>),<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>))) <span class="co"># monastery indicator</span></span></code></pre></div>
<p>The introduction of a new term into our model allows us to compare rates across our varying exposures. This term is the logarithm of the exposure.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="god_spiked.html#cb247-1" aria-hidden="true" tabindex="-1"></a>data_manu <span class="ot">&lt;-</span> data_manu <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">log_exp =</span> <span class="fu">log</span>(exposure))</span>
<span id="cb247-2"><a href="god_spiked.html#cb247-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-3"><a href="god_spiked.html#cb247-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb247-4"><a href="god_spiked.html#cb247-4" aria-hidden="true" tabindex="-1"></a>m11<span class="fl">.12</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>( <span class="fu">alist</span>( </span>
<span id="cb247-5"><a href="god_spiked.html#cb247-5" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> <span class="fu">dpois</span>( lambda ), </span>
<span id="cb247-6"><a href="god_spiked.html#cb247-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(lambda) <span class="ot">&lt;-</span> log_exp <span class="sc">+</span> a <span class="sc">+</span> b<span class="sc">*</span>monastery, </span>
<span id="cb247-7"><a href="god_spiked.html#cb247-7" aria-hidden="true" tabindex="-1"></a>  a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ), </span>
<span id="cb247-8"><a href="god_spiked.html#cb247-8" aria-hidden="true" tabindex="-1"></a>  b <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> )</span>
<span id="cb247-9"><a href="god_spiked.html#cb247-9" aria-hidden="true" tabindex="-1"></a>), <span class="at">data=</span>data_manu )</span></code></pre></div>
<p>Why does the addition of this term adjust for the varying exposures?</p>
<p>If we think about <span class="math inline">\(\lambda\)</span> as a rate we can express it as a number of manuscripts <span class="math inline">\(\mu\)</span> produced over a number of days <span class="math inline">\(\tau\)</span>: <span class="math inline">\(\lambda = \mu/\tau\)</span>. If we return to the definition of the Poisson GLM with the log link function we can see how this helps us to scale our rate parameter to adjust for the varying exposures:</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\sim \text{Poisson}(\lambda_i) \\
\log \lambda_i &amp;= \log \left( \frac{\mu_i}{\tau_i} \right)= \alpha + \beta x_i \\
\implies \log \lambda_i &amp;= \log\mu_i - \log\tau_i = \alpha + \beta x_i \\
\implies \log\mu_i &amp;= \log\tau_i + \alpha + \beta x_i \\
\end{aligned}
\]</span>
We define a new model with the exposures on the daily scale.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\sim \text{Poisson}(\mu_i) \\
\log \mu_i &amp;= \log \tau_i + \alpha + \beta x_i \\
\end{aligned}
\]</span></p>
<p>When the exposure <span class="math inline">\(\tau_i\)</span> equals one, <span class="math inline">\(\log(\tau_i) = 0\)</span> and we get back the initial model.</p>
<p>We can now compare the production of the two monasteries:</p>
<pre><code>##                 mean        sd      5.5%     94.5%
## lambda_old 1.2398507 0.2001562 0.9464707 1.5844527
## lambda_new 0.4151877 0.1213752 0.2502575 0.6281128</code></pre>
<p>These are daily rates. We can see that the new monastery is about a third as productive as the old, and we can adjust the price we’re willing to pay accordingly.</p>
</div>
</div>
<div id="multinomial-and-categorical-models" class="section level3 unnumbered">
<h3>Multinomial and Categorical Models</h3>
<p>The chapter introduces the multi-nomial distribution as an extension of the binomial. It has probability mass function:</p>
<p><span class="math display">\[
\text{Pr}(y_i, \dots , y_K | n, p_i, \dots , p_K) = \frac{n!}{\prod_i y_i!} \prod^K_{i=1}p_i^{y_i}
\]</span></p>
<p>Here there are <span class="math inline">\(K\)</span> kinds of events (not just two) and we observe <span class="math inline">\(y_i\)</span> events of each type <span class="math inline">\(i\)</span> over <span class="math inline">\(n\)</span> total trials. Imagine an urn filled with balls of <span class="math inline">\(K\)</span> different colours. We pull <span class="math inline">\(n\)</span> balls from the urn with replacement and count up how many of each colour we get. The</p>
<p><span class="math display">\[
\frac{n!}{\prod_i y_i!}
\]</span>
term is analogous to the</p>
<p><span class="math display">\[
{n \choose y} = \frac{n!}{y! (n-y)!}
\]</span>
term in the binomial PMF.</p>
<p>The equivalent to the inverse logit function we used in the binomial case is called the softmax function, and it looks like this:</p>
<p><span class="math display">\[
\text{Pr}(k| s_1, s_2, \dots, s_K) = \frac{\exp(s_k)}{\sum^K_{i=1} \exp(s_i)}
\]</span>
where <span class="math inline">\(s_i\)</span> is a <em>score</em> assigned to event type <span class="math inline">\(i\)</span>.</p>
<p>To illustrate, the chapter introduces a simulated example. We are trying to model career choice in 500 young adults. There are three career options, each comes with its own expected income.</p>
<p>The following code assigns an income to each career option, converts this to a score, and converts the score to a set of probabilities using the softmax function. Then the 500 individuals pick one of the three options, with the choice weighted by the calculated probabilities. We end up with a vector of length 500, where each entry is one of the three career options.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="god_spiked.html#cb249-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb249-2"><a href="god_spiked.html#cb249-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-3"><a href="god_spiked.html#cb249-3" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>)</span>
<span id="cb249-4"><a href="god_spiked.html#cb249-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-5"><a href="god_spiked.html#cb249-5" aria-hidden="true" tabindex="-1"></a>score <span class="ot">&lt;-</span> income<span class="sc">*</span><span class="fl">0.5</span></span>
<span id="cb249-6"><a href="god_spiked.html#cb249-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-7"><a href="god_spiked.html#cb249-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">softmax</span>(score[<span class="dv">1</span>],score[<span class="dv">2</span>],score[<span class="dv">3</span>])</span>
<span id="cb249-8"><a href="god_spiked.html#cb249-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-9"><a href="god_spiked.html#cb249-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-10"><a href="god_spiked.html#cb249-10" aria-hidden="true" tabindex="-1"></a>career <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb249-11"><a href="god_spiked.html#cb249-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-12"><a href="god_spiked.html#cb249-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">34302</span>)</span>
<span id="cb249-13"><a href="god_spiked.html#cb249-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb249-14"><a href="god_spiked.html#cb249-14" aria-hidden="true" tabindex="-1"></a>  career[i] <span class="ot">&lt;-</span> <span class="fu">sample</span>( <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">size =</span><span class="dv">1</span>, <span class="at">prob =</span> p)</span>
<span id="cb249-15"><a href="god_spiked.html#cb249-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The chapter presents the code for the multi-nomial model in raw Stan code. This is the first model written in raw Stan in the book.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="god_spiked.html#cb250-1" aria-hidden="true" tabindex="-1"></a>code_m11<span class="fl">.13</span> <span class="ot">&lt;-</span> <span class="st">&quot; data{</span></span>
<span id="cb250-2"><a href="god_spiked.html#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="st">int N; // number of individuals </span></span>
<span id="cb250-3"><a href="god_spiked.html#cb250-3" aria-hidden="true" tabindex="-1"></a><span class="st">int K; // number of possible careers </span></span>
<span id="cb250-4"><a href="god_spiked.html#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="st">int career[N]; // outcome </span></span>
<span id="cb250-5"><a href="god_spiked.html#cb250-5" aria-hidden="true" tabindex="-1"></a><span class="st">vector[K] career_income;</span></span>
<span id="cb250-6"><a href="god_spiked.html#cb250-6" aria-hidden="true" tabindex="-1"></a><span class="st">} </span></span>
<span id="cb250-7"><a href="god_spiked.html#cb250-7" aria-hidden="true" tabindex="-1"></a><span class="st">parameters{</span></span>
<span id="cb250-8"><a href="god_spiked.html#cb250-8" aria-hidden="true" tabindex="-1"></a><span class="st">vector[K-1] a; // intercepts </span></span>
<span id="cb250-9"><a href="god_spiked.html#cb250-9" aria-hidden="true" tabindex="-1"></a><span class="st">real&lt;lower=0&gt; b; // association of income with choice</span></span>
<span id="cb250-10"><a href="god_spiked.html#cb250-10" aria-hidden="true" tabindex="-1"></a><span class="st">} </span></span>
<span id="cb250-11"><a href="god_spiked.html#cb250-11" aria-hidden="true" tabindex="-1"></a><span class="st">model{</span></span>
<span id="cb250-12"><a href="god_spiked.html#cb250-12" aria-hidden="true" tabindex="-1"></a><span class="st">vector[K] p; </span></span>
<span id="cb250-13"><a href="god_spiked.html#cb250-13" aria-hidden="true" tabindex="-1"></a><span class="st">vector[K] s; </span></span>
<span id="cb250-14"><a href="god_spiked.html#cb250-14" aria-hidden="true" tabindex="-1"></a><span class="st">a ~ normal( 0 , 1 ); </span></span>
<span id="cb250-15"><a href="god_spiked.html#cb250-15" aria-hidden="true" tabindex="-1"></a><span class="st">b ~ normal( 0 , 0.5 ); </span></span>
<span id="cb250-16"><a href="god_spiked.html#cb250-16" aria-hidden="true" tabindex="-1"></a><span class="st">s[1] = a[1] + b*career_income[1]; </span></span>
<span id="cb250-17"><a href="god_spiked.html#cb250-17" aria-hidden="true" tabindex="-1"></a><span class="st">s[2] = a[2] + b*career_income[2]; </span></span>
<span id="cb250-18"><a href="god_spiked.html#cb250-18" aria-hidden="true" tabindex="-1"></a><span class="st">s[3] = 0; // pivot </span></span>
<span id="cb250-19"><a href="god_spiked.html#cb250-19" aria-hidden="true" tabindex="-1"></a><span class="st">p = softmax( s ); </span></span>
<span id="cb250-20"><a href="god_spiked.html#cb250-20" aria-hidden="true" tabindex="-1"></a><span class="st">career ~ categorical( p );</span></span>
<span id="cb250-21"><a href="god_spiked.html#cb250-21" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb250-22"><a href="god_spiked.html#cb250-22" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span></code></pre></div>
<p>The string of code is fed to Stan like so:</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="god_spiked.html#cb251-1" aria-hidden="true" tabindex="-1"></a>data_career <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">N=</span>N , <span class="at">K=</span><span class="dv">3</span> , <span class="at">career=</span>career , <span class="at">career_income=</span>income ) </span>
<span id="cb251-2"><a href="god_spiked.html#cb251-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-3"><a href="god_spiked.html#cb251-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb251-4"><a href="god_spiked.html#cb251-4" aria-hidden="true" tabindex="-1"></a>m11<span class="fl">.13</span> <span class="ot">&lt;-</span> <span class="fu">stan</span>( <span class="at">model_code=</span>code_m11<span class="fl">.13</span> , <span class="at">data=</span>data_career , <span class="at">chains=</span><span class="dv">4</span> )</span>
<span id="cb251-5"><a href="god_spiked.html#cb251-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-6"><a href="god_spiked.html#cb251-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-7"><a href="god_spiked.html#cb251-7" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>( m11<span class="fl">.13</span> , <span class="dv">2</span> )</span></code></pre></div>
<p>Revisit: I got lost here. Return after attempting some questions.</p>
</div>
</div>
<div id="questions-10" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Questions</h2>
<div id="e1-8" class="section level3 unnumbered">
<h3>11E1</h3>
<div id="question-81" class="section level4 unnumbered">
<h4>Question</h4>
<p>If an event has probability 0.35, what are the log-odds of this event?</p>
</div>
<div id="answer-81" class="section level4 unnumbered">
<h4>Answer</h4>
<p>We expect a ratio of 35 “successes” to 65 “failures,” which equates to odds of <span class="math inline">\(\frac{35}{65} = \frac{7}{13}\)</span>. Taking the natural log of this value gives <span class="math inline">\(-0.62\)</span>.</p>
</div>
</div>
<div id="e2-6" class="section level3 unnumbered">
<h3>11E2</h3>
<div id="question-82" class="section level4 unnumbered">
<h4>Question</h4>
<p>If an event has log-odds 3.2, what is the probability of this event?</p>
</div>
<div id="answer-82" class="section level4 unnumbered">
<h4>Answer</h4>
<p><span class="math display">\[
\begin{aligned}
\exp(3.2) = 24.53 &amp;= \frac{p}{1-p} \\
\implies p &amp;= 0.96
\end{aligned}
\]</span></p>
</div>
</div>
<div id="e3-7" class="section level3 unnumbered">
<h3>11E3</h3>
<div id="question-83" class="section level4 unnumbered">
<h4>Question</h4>
<p>Suppose that a coefficient in a logistic regression has value 1.7. What does this imply about the proportional change in odds of the outcome?</p>
</div>
<div id="answer-83" class="section level4 unnumbered">
<h4>Answer</h4>
<p>This question asks us to compute the <em>relative effect</em> of a parameter. If we exponentiate the coefficient then we get the proportional odds: $ exp(1.7) = 5.47 $ which suggests a 447% increase in the odds of the outcome when we increase the parameter in question by one unit.</p>
<p>As outlined in the Overthinking box on page 337, this works because the ratio in odds that we get with a one unit increase in the parameter is:</p>
<p><span class="math display">\[
\begin{aligned}
q &amp;= \frac{\exp(\alpha + \beta(x_i + 1) )}{\exp(\alpha + \beta(x_i))} = \frac{\exp(\alpha) \exp(\beta x_i) \exp(\beta)}{\exp(\alpha) \exp(\beta x_i)} \\
 &amp;= \exp(\beta)
\end{aligned}
\]</span></p>
</div>
</div>
<div id="e4-6" class="section level3 unnumbered">
<h3>11E4</h3>
<div id="question-84" class="section level4 unnumbered">
<h4>Question</h4>
<p>Why do Poisson regressions sometimes require the use of an offset? Provide an example.</p>
</div>
<div id="answer-84" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Sometimes we get count data reported with varying exposures. The example in the chapter in one monastery reports daily counts of manuscripts produced, and one reports weekly. The offset allows us to compare rates across varying exposures. The offset is the logarithm of the exposure.</p>
<p>Why does the offset adjust for the varying exposures?</p>
<p>If we think about <span class="math inline">\(\lambda\)</span> as a rate we can express it as a number of manuscripts <span class="math inline">\(\mu\)</span> produced over a number of days <span class="math inline">\(\tau\)</span>: <span class="math inline">\(\lambda = \mu/\tau\)</span>. If we return to the definition of the Poisson GLM with the log link function we can see how this helps us to scale our rate parameter to adjust for the varying exposures:</p>
<p><span class="math display">\[
\begin{aligned}
\log \lambda_i &amp;= \log \left( \frac{\mu_i}{\tau_i} \right)= \alpha + \beta x_i \\
\implies \log \lambda_i &amp;= \log\mu_i - \log\tau_i = \alpha + \beta x_i \\
\implies \log\mu_i &amp;= \log\tau_i + \alpha + \beta x_i \\
\end{aligned}
\]</span></p>
<p>We can then define a new model with the exposures on the daily scale.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\sim \text{Poisson}(\mu_i) \\
\log \mu_i &amp;= \log \tau_i + \alpha + \beta x_i \\
\end{aligned}
\]</span></p>
</div>
</div>
<div id="m1-6" class="section level3 unnumbered">
<h3>11M1</h3>
<div id="question-85" class="section level4 unnumbered">
<h4>Question</h4>
<p>As explained in the chapter, binomial data can be organized in aggregated and disaggregated forms, without any impact on inference. But the likelihood of the data does change when the data are converted between the two formats. Can you explain why?</p>
</div>
<div id="answer-85" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Let’s follow the example explanation in the chapter (page 339) and talk about 9 trials with 6 successes. The likelihood of this data in the aggregate model is</p>
<p><span class="math display">\[
\text{Pr}(6|9,p) = \frac{6!}{6!(9-6)!}p^6(1-p)^{9-6}
\]</span></p>
<p>The fraction on the right hand side is <span class="math inline">\({9 \choose 6}\)</span> which multiplies the likelihood by the number of different ways you could see 6 successes in 9 trials.</p>
<p>The joint probability of the same disaggregated data is</p>
<p><span class="math display">\[
\text{Pr}(1,1,1,1,1,1,0,0,0,p) = p \times p \times p \times p \times p \times p \times (1-p) \times (1-p) \times (1-p) =p^6(1-p)^{9-6}.
\]</span></p>
</div>
</div>
<div id="m2-6" class="section level3 unnumbered">
<h3>11M2</h3>
<div id="question-86" class="section level4 unnumbered">
<h4>Question</h4>
<p>If a coefficient in a Poisson regression has value 1.7, what does this imply about the change in the outcome?</p>
</div>
<div id="answer-86" class="section level4 unnumbered">
<h4>Answer</h4>
<p>In a Possion regression with a log link our parameter is the exponentiation of the linear model:</p>
<p><span class="math display">\[
\log(\mu_i) = \alpha + \beta x_i
\]</span></p>
<p>with a one unit increase in the parameter we get</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\exp(\alpha + \beta(x_i + 1) )}{\exp(\alpha + \beta(x_i))} = \frac{\exp(\alpha) \exp(\beta x_i) \exp(\beta)}{\exp(\alpha) \exp(\beta x_i)}
 = \exp(\beta)
\end{aligned}
\]</span>
Our outcome value has been increased by a factor of <span class="math inline">\(\exp(\beta)\)</span>. In this case if the coefficient has value 1.7, then an increase of one unit in the parameter translates to an outcome value that has increased by a factor of 5.47.</p>
</div>
</div>
<div id="m3-6" class="section level3 unnumbered">
<h3>11M3</h3>
<div id="question-87" class="section level4 unnumbered">
<h4>Question</h4>
<p>Explain why the logit link is appropriate for a binomial generalized linear model.</p>
</div>
<div id="answer-87" class="section level4 unnumbered">
<h4>Answer</h4>
<p>In a binomial GLM we have observed a number of trials where there are two possible outcomes, and we are looking to make inferences about the unobserved “underlying” probabilities that influence these outcomes.</p>
<p>These probabilities must be between zero and one, and an inverse-logit transform of the linear model will constrain the parameter to these values.</p>
</div>
</div>
<div id="m4-4" class="section level3 unnumbered">
<h3>11M4</h3>
<div id="question-88" class="section level4 unnumbered">
<h4>Question</h4>
<p>Explain why the log link is appropriate for a Poisson generalized linear model.</p>
</div>
<div id="answer-88" class="section level4 unnumbered">
<h4>Answer</h4>
<p>In a Poisson GLM our observed outcomes are counts that occur over time or space, and we are looking to make inferences about the unobserved “underlying” rates that influence these outcomes.</p>
<p>A rate must be non-negative, and exponentiation (inverse log) of the linear model will constrain the parameter to these values.</p>
</div>
</div>
<div id="m5-4" class="section level3 unnumbered">
<h3>11M5</h3>
<div id="question-89" class="section level4 unnumbered">
<h4>Question</h4>
<p>What would it imply to use a logit link for the mean of a Poisson generalized linear model? Can you think of a real research problem for which this would make sense?</p>
</div>
<div id="answer-89" class="section level4 unnumbered">
<h4>Answer</h4>
<p>You would be constraining the mean rate to be between 0 and 1. If your research question is considering many small intervals, where for each interval the probability of observing an event is low then a logit function would be suitable.</p>
</div>
</div>
<div id="m6-4" class="section level3 unnumbered">
<h3>11M6</h3>
<div id="question-90" class="section level4 unnumbered">
<h4>Question</h4>
<p>State the constraints for which the binomial and Poisson distributions have maximum entropy. Are the constraints different at all for binomial and Poisson? Why or why not?</p>
</div>
<div id="answer-90" class="section level4 unnumbered">
<h4>Answer</h4>
<p>The binomial distribution has maximum entropy with constraints:</p>
<ol style="list-style-type: decimal">
<li>two unordered events</li>
<li>constant expected value</li>
</ol>
<p>The Poisson distribution is the binomial distribution as <span class="math inline">\(n \to \infty\)</span> and <span class="math inline">\(p \to 0\)</span> as <span class="math inline">\(np\)</span> remains constant. If <span class="math inline">\(n\)</span> is large and <span class="math inline">\(p\)</span> small enough to model with a Poisson distribution, it will have maximum entropy under the same constraints.</p>
</div>
</div>
<div id="m7-2" class="section level3 unnumbered">
<h3>11M7</h3>
<div id="question-91" class="section level4 unnumbered">
<h4>Question</h4>
<p>Use quap to construct a quadratic approximate posterior distribution for the chimpanzee model that includes a unique intercept for each actor, m11.4. Compare the quadratic approximation to the posterior distribution produced instead from MCMC.</p>
<p>Can you explain both the differences and the similarities between the approximate and the MCMC distributions? Relax the prior on the actor intercepts to Normal(0,10). Re-estimate the posterior using both ulam and quap.</p>
<p>Do the differences increase or decrease? Why?</p>
</div>
<div id="answer-91" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Here’s m11.4 using quap instead of ulam:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="god_spiked.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb252-2"><a href="god_spiked.html#cb252-2" aria-hidden="true" tabindex="-1"></a>m11.<span class="fl">4.</span>quap <span class="ot">&lt;-</span> <span class="fu">quap</span>(<span class="fu">alist</span>( </span>
<span id="cb252-3"><a href="god_spiked.html#cb252-3" aria-hidden="true" tabindex="-1"></a>  pulled_left <span class="sc">~</span> <span class="fu">dbinom</span>( <span class="dv">1</span> , p ) , </span>
<span id="cb252-4"><a href="god_spiked.html#cb252-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">logit</span>(p) <span class="ot">&lt;-</span> a[actor] <span class="sc">+</span> b[treatment] , </span>
<span id="cb252-5"><a href="god_spiked.html#cb252-5" aria-hidden="true" tabindex="-1"></a>  a[actor] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">1.5</span> ), </span>
<span id="cb252-6"><a href="god_spiked.html#cb252-6" aria-hidden="true" tabindex="-1"></a>  b[treatment] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> )</span>
<span id="cb252-7"><a href="god_spiked.html#cb252-7" aria-hidden="true" tabindex="-1"></a> ), <span class="at">data=</span>data_chimp)</span></code></pre></div>
<p>And here are the two posterior plots side by side:</p>
<p><img src="11-god_spiked_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>Here is the same chart after relaxing the actor intercept prior to Normal(0,10).</p>
<p><img src="11-god_spiked_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>Can’t quite figure out what’s going on here. Don’t think I’ve made a coding error but will have to revisit later.</p>
</div>
</div>
<div id="m8" class="section level3 unnumbered">
<h3>11M8</h3>
<div id="question-92" class="section level4 unnumbered">
<h4>Question</h4>
<p>Revisit the data(Kline) islands example. This time drop Hawaii from the sample and refit the models. What changes do you observe?</p>
</div>
<div id="answer-92" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Here is a comparison of the posterior predictions with and without Hawaii:</p>
<p><img src="11-god_spiked_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>A couple things have changed here. The model is now a lot less confident about high population, low contact societies - the red compatibility interval gets much wider.
Also, as before the model expects that low contact societies will develop fewer tools than high contact societies, except now the prediction is uniform across the data range. Previously the model predicted that over a certain population size more tools would be produced by low contact societies. We now have reason to believe that this crossover point is an artifact of including Hawaii, with it’s large population and large number of tools, and the lack of data on any large population, high contact societies.</p>
<p>One annoying thing about removing Hawaii is that it changes the automatic scaling on the data point sizes - I should revisit this later to set the scaling manually for consistency.</p>
</div>
</div>
<div id="h1-4" class="section level3 unnumbered">
<h3>11H1</h3>
<div id="question-93" class="section level4 unnumbered">
<h4>Question</h4>
<p>Use WAIC or PSIS to compare the chimpanzee model that includes a unique intercept for each actor, m11.4 (page 330), to the simpler models fit in the same section. Interpret the results.</p>
</div>
<div id="answer-93" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Here are the models we’ll be comparing:</p>
<ul>
<li>11.1 - model with no predictors and flat priors</li>
<li>11.2 - model includes treatment (but not actor) as predictor, flat priors</li>
<li>11.3 - model includes treatment (but not actor) as predictor, more informative priors</li>
<li>11.4 - model includes treatment and actor as predictors. more informative priors</li>
</ul>
<pre><code>##                WAIC        SE    dWAIC      dSE    pWAIC       weight
## m11.4.quap 532.4388 18.538215   0.0000       NA 8.166138 1.000000e+00
## m11.3      682.3300  9.019331 149.8912 18.02068 3.548242 2.828404e-33
## m11.2      682.9577  9.689085 150.5189 18.12860 3.951869 2.066520e-33
## m11.1      688.0776  7.155477 155.6388 18.58770 1.068659 1.597607e-34</code></pre>
<p>It looks like including treatment effect does improve expected accuracy of the model, but it’s nowhere close to as important as including actor. This suggests that the most important predictor of a chimp pulling the left lever is simply handedness, rather than presence / absence of a partner and food for them. Comparing model 2 to 3, it also looks like we have enough data here to overwhelm even very bad priors.</p>
</div>
</div>
<div id="h2-4" class="section level3 unnumbered">
<h3>11H2</h3>
<div id="question-94" class="section level4 unnumbered">
<h4>Question</h4>
<p>The data contained in library(MASS);data(eagles) are records of salmon pirating attempts by Bald Eagles in Washington State. See ?eagles for details. While one eagle feeds, sometimes another will swoop in and try to steal the salmon from it. Call the feeding eagle the “victim” and the thief the “pirate.” Use the available data to build a binomial GLM of successful pirating attempts.</p>
<ol style="list-style-type: lower-alpha">
<li>Consider the following model:</li>
</ol>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\sim \text{Binomial}(n_i,p_i) \\
\text{logit}(p_i) &amp;=  \alpha + \beta_P P_i + \beta_V V_i + \beta_A A_i \\
\alpha &amp;\sim \text{Normal}(0,1.5) \\
\beta_P, \beta_V, \beta_A &amp;\sim \text{Normal}(0,0.5) 
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(y\)</span> is the number of successful attempts, <span class="math inline">\(n\)</span> is the total number of attempts, <span class="math inline">\(P\)</span> is a dummy variable indicating whether or not the pirate had large body size, <span class="math inline">\(V\)</span> is a dummy variable indicating whether or not the victim had large body size, and finally <span class="math inline">\(A\)</span> is a dummy variable indicating whether or not the pirate was an adult.</p>
<p>Fit the model above to the eagles data, using both quap and ulam. Is the quadratic approximation okay?</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Now interpret the estimates. If the quadratic approximation turned out okay, then it’s okay to use the quap estimates. Otherwise stick to ulam estimates. Then plot the posterior predictions. Compute and display both:</li>
</ol>
<ol style="list-style-type: decimal">
<li><p>the predicted probability of success and its 89% interval for each row in the data, as well as</p></li>
<li><p>the predicted success count and its 89% interval.</p></li>
</ol>
<p>What different information does each type of posterior prediction provide?</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Now try to improve the model. Consider an interaction between the pirate’s size and age (immature or adult). Compare this model to the previous one, using WAIC. Interpret.</li>
</ol>
</div>
<div id="answer-94" class="section level4 unnumbered">
<h4>Answer</h4>
<p><img src="11-god_spiked_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>Here the first letter refers to the size of the pirate, large or small. The second refers to whether the pirate is adult or immature. The third refers to the size of the victim.</p>
<p>The plot of probabilities contains information about the proportion of successes expected in each scenario. The count predictions contain information on the number of attempts. The count plot can be thought of as predicting the number of successes for each scenario for 160 trials total.</p>
<p>Here’s a model with an interaction effect between the pirate’s size and age:</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\sim \text{Binomial}(n_i,p_i) \\
\text{logit}(p_i) &amp;=  \alpha + (\beta_P + \beta_A A_i)P_i + \beta_V V_i  \\
\alpha &amp;\sim \text{Normal}(0,1.5) \\
\beta_P, \beta_V, \beta_A &amp;\sim \text{Normal}(0,0.5) 
\end{aligned}
\]</span></p>
<p>Here’s a comparison of the two models by WAIC:</p>
<pre><code>##             WAIC       SE    dWAIC      dSE    pWAIC   weight
## m11.H2b 58.97597 11.46574 0.000000       NA 8.280315 0.765901
## m11.H2c 61.34659 15.25543 2.370618 5.891377 7.982785 0.234099</code></pre>
</div>
</div>
<div id="h3-4" class="section level3 unnumbered">
<h3>11H3</h3>
<div id="question-95" class="section level4 unnumbered">
<h4>Question</h4>
<p>The data contained in data(salamanders) are counts of salamanders (Plethodon elongatus) from <span class="math inline">\(47\)</span> different <span class="math inline">\(49m^2\)</span> plots in northern California. The column SALAMAN is the count in each plot, and the columns PCTCOVER and FORESTAGE are percent of ground cover and age of trees in the plot, respectively. You will model SALAMAN as a Poisson variable.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Model the relationship between density and percent cover, using a log-link (same as the example in the book and lecture). Use weakly informative priors of your choosing. Check the quadratic approximation again, by comparing quap to ulam. Then plot the expected counts and their 89% interval against percent cover. In which ways does the model do a good job? A bad job?</p></li>
<li><p>Can you improve the model by using the other predictor, FORESTAGE? Try any models you think useful. Can you explain why FORESTAGE helps or does not help with prediction?</p></li>
</ol>
</div>
<div id="answer-95" class="section level4 unnumbered">
<h4>Answer</h4>
<p>This is the second questions that asks me to check the performance of the quadratic approximation against Hamiltonian Monte Carlo in ulam before looking at parameter estimates, and I’m not sure how to do this. I’ve been warned against model comparison using WAIC or PSIS when using two different algorithms. I could use a pairs plot to check whether the posterior distribution looks broadly Gaussian. Need to revisit this.</p>
<p>Also I’ve been a bit lazy with my use of ulam over this chapter. I should really be pre-processing all of my variables and only feeding ulam a list of the data I want it to use, rather than a data frame that contains unnecessary columns. Hopefully this will speed up and set me up well for using data with varying lengths once I get to multi-level models.</p>
<p>Alright, this starts off as a fairly straightforward-looking Poisson model, with only percentage ground cover as a predictor. I think it should look like this:</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\sim \text{Poisson}(\lambda_i) \\
\log(\lambda_i) &amp;= \alpha + \beta_{C}(x_i-\bar{x})
\end{aligned}
\]</span></p>
<p>We use the log link since we want our salamander estimates to be non-negative. Here is my data prep:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="god_spiked.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;salamanders&quot;</span>)</span>
<span id="cb255-2"><a href="god_spiked.html#cb255-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-3"><a href="god_spiked.html#cb255-3" aria-hidden="true" tabindex="-1"></a><span class="co"># scaling PCTCOVER to be between 0 and 1 and then centering.</span></span>
<span id="cb255-4"><a href="god_spiked.html#cb255-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-5"><a href="god_spiked.html#cb255-5" aria-hidden="true" tabindex="-1"></a>data_sal <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(salamanders)<span class="sc">%&gt;%</span></span>
<span id="cb255-6"><a href="god_spiked.html#cb255-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cov_cen =</span> <span class="fu">scale</span>(PCTCOVER))</span>
<span id="cb255-7"><a href="god_spiked.html#cb255-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-8"><a href="god_spiked.html#cb255-8" aria-hidden="true" tabindex="-1"></a>list_sal <span class="ot">&lt;-</span> <span class="fu">with</span>(data_sal,<span class="fu">list</span>(<span class="at">sal =</span>SALAMAN,<span class="at">cov_cen =</span> cov_cen)) </span></code></pre></div>
<p>And now for some prior simulation. After some messing around I settled on Normal(1.2,1) for the intercept, and Normal(0,0.2) for <span class="math inline">\(\beta_C\)</span>.</p>
<p><img src="11-god_spiked_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>These prior simulations are displayed two different ways. On the left is a density plot of the number of salamanders in the intercept only model when <span class="math inline">\(a \sim \text{Normal}(1.2,1)\)</span>. The plot on the right shows 50 simulations of how the number of salamanders might vary with the amount of ground cover, when <span class="math inline">\(a\)</span> is as above and <span class="math inline">\(b \sim \text{Normal}(0,0.2)\)</span>.</p>
<p>Now to fit the model and plot the results.</p>
<p><img src="11-god_spiked_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p>I think the model does a good job of capturing the broad relationship here: salamanders like ground cover. The model does a poor job of capturing the variation above 75%.</p>
<p>The next part of the question asks us to add age of trees into the model, using “any model you think useful.” Just for fun, I might create a new index variable for cover (high or low, with the boundary at 75%) and then plot salamander population against forest age.</p>
<p><img src="11-god_spiked_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>Here red is low cover, blue is high cover.</p>
<p>The slope should be able to vary here, it looks like forest age doesn’t seem to have much effect no matter the level of cover.</p>
</div>
</div>
<div id="h4-4" class="section level3 unnumbered">
<h3>11H4</h3>
<div id="question-96" class="section level4 unnumbered">
<h4>Question</h4>
<p>The data in data(NWOGrants) are outcomes for scientific funding applications for the Netherlands Organization for Scientific Research (NWO) from 2010–2012 (see van der Lee and Ellemers (2015) for data and context). These data have a very similar structure to the UCBAdmit data discussed in the chapter. I want you to consider a similar question: What are the total and indirect causal effects of gender on grant awards? Consider a mediation path (a pipe) through discipline. Draw the corresponding DAG and then use one or more binomial GLMs to answer the question. What is your causal interpretation? If NWO’s goal is to equalize rates of funding between men and women, what type of intervention would be most effective?</p>
</div>
<div id="answer-96" class="section level4 unnumbered">
<h4>Answer</h4>
<ul>
<li>G - Gender</li>
<li>D - Department</li>
<li>A - Award</li>
</ul>
<p><img src="11-god_spiked_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<p>I’ll start with a model that only includes gender, and not department. This will give us an estimate of the total effect of gender.</p>
<p>Here are the results:</p>
<pre><code>##              mean         sd        5.5%      94.5%
## diff_a 0.20646480 0.10435218 0.039312400 0.37026665
## diff_p 0.02810227 0.01410845 0.005329711 0.05045711</code></pre>
<p>On the probability scale, applications from women are 1-5% less likely to succeed.</p>
<p>Now we add department to the model, blocking the pipe to estimate the direct effects on gender.</p>
<p>And the results:</p>
<pre><code>##             mean         sd         5.5%      94.5%
## diff_a 0.1415749 0.10123312 -0.021963000 0.30244495
## diff_p 0.0247863 0.01901147 -0.003853548 0.05708239</code></pre>
<p>See comment above, unsure about this one. revisit this.</p>
</div>
</div>
<div id="h5-3" class="section level3 unnumbered">
<h3>11H5</h3>
<div id="question-97" class="section level4 unnumbered">
<h4>Question</h4>
<p>Suppose that the NWO Grants sample has an unobserved confound that influences both choice of discipline and the probability of an award. One example of such a confound could be the career stage of each applicant. Suppose that in some disciplines, junior scholars apply for most of the grants. In other disciplines, scholars from all career stages compete. As a result, career stage influences discipline as well as the probability of being awarded a grant. Add these influences to your DAG from the previous problem.</p>
<p>What happens now when you condition on discipline? Does it provide an un-confounded estimate of the direct path from gender to an award? Why or why not? Justify your answer with the backdoor criterion. If you have trouble thinking this though, try simulating fake data, assuming your DAG is true. Then analyze it using the model from the previous problem. What do you conclude? Is it possible for gender to have a real direct causal influence but for a regression conditioning on both gender and discipline to suggest zero influence?</p>
</div>
<div id="answer-97" class="section level4 unnumbered">
<h4>Answer</h4>
<p><img src="11-god_spiked_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="further-resources-1" class="section level2 unnumbered">
<h2>Further Resources</h2>
<p>On the link between Bayesian conditioning and entropy maximisation:</p>
<p>Williams (1980): Bayesian Conditionalisation and the Principle of Minimum Information (<a href="http://www.yaroslavvb.com/papers/williams-conditionalization.pdf" class="uri">http://www.yaroslavvb.com/papers/williams-conditionalization.pdf</a>)</p>
<p>Caticha, A. and Griffin, A. (2007). Updating probabilities. In Mohammad-Djafari, A., editor, Bayesian Inference and Maximum Entropy Methods in Science and Engineering, volume 872 ofAIP Conf. Proc.</p>
<p>Griffin (2008): Maximum Entropy: The Universal Method for Inference (<a href="https://arxiv.org/ftp/arxiv/papers/0901/0901.2987.pdf" class="uri">https://arxiv.org/ftp/arxiv/papers/0901/0901.2987.pdf</a>)</p>
<p>Conrad’s paper deriving various maximum entropy distributions. <a href="https://kconrad.math.uconn.edu/blurbs/analysis/entropypost.pdf" class="uri">https://kconrad.math.uconn.edu/blurbs/analysis/entropypost.pdf</a>
Work through this and fill out the Gaussian and Binomial arguments above.</p>
<p>An example of multinomial logistic regression in the literature:</p>
<ol start="179" style="list-style-type: decimal">
<li>See Koster and McElreath (2017) for a published Stan example with varying effects, applied to behavioral choice.
(<a href="https://pure.mpg.de/rest/items/item_2479179_5/component/file_2479178/content" class="uri">https://pure.mpg.de/rest/items/item_2479179_5/component/file_2479178/content</a>)</li>
</ol>
<p>Subject of question 11.H.2 on logistic regression:</p>
<p>Knight, R. L. and Skagen, S. K. (1988) Agonistic asymmetries and the foraging ecology of Bald Eagles. Ecology 69, 1188–1194.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="big_entropy.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="monsters_mixtures.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/11-god_spiked.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
