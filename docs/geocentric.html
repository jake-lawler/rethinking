<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Geocentric Models | Statistical Rethinking Notes</title>
  <meta name="description" content="My notes on Richard McElreath’s ‘Statistical Rethinking.’" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Geocentric Models | Statistical Rethinking Notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="My notes on Richard McElreath’s ‘Statistical Rethinking.’" />
  <meta name="github-repo" content="jake-lawler/rethinking" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Geocentric Models | Statistical Rethinking Notes" />
  
  <meta name="twitter:description" content="My notes on Richard McElreath’s ‘Statistical Rethinking.’" />
  

<meta name="author" content="Jake Lawler" />


<meta name="date" content="2022-01-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sampling_imaginary.html"/>
<link rel="next" href="many_variables.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="prague.html"><a href="prague.html"><i class="fa fa-check"></i><b>1</b> The Golem of Prague</a>
<ul>
<li class="chapter" data-level="1.1" data-path="prague.html"><a href="prague.html#chapter-notes"><i class="fa fa-check"></i><b>1.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="1.2" data-path="prague.html"><a href="prague.html#questions"><i class="fa fa-check"></i><b>1.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="prague.html"><a href="prague.html#further-reading"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="small_worlds.html"><a href="small_worlds.html"><i class="fa fa-check"></i><b>2</b> Small Worlds and Large Worlds</a>
<ul>
<li class="chapter" data-level="2.1" data-path="small_worlds.html"><a href="small_worlds.html#chapter-notes-1"><i class="fa fa-check"></i><b>2.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="2.2" data-path="small_worlds.html"><a href="small_worlds.html#questions-1"><i class="fa fa-check"></i><b>2.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e1"><i class="fa fa-check"></i>2E1</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e2"><i class="fa fa-check"></i>2E2</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e3"><i class="fa fa-check"></i>2E3</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e4"><i class="fa fa-check"></i>2E4</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m1"><i class="fa fa-check"></i>2M1</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m2"><i class="fa fa-check"></i>2M2</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m3"><i class="fa fa-check"></i>2M3</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m4"><i class="fa fa-check"></i>2M4</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m5"><i class="fa fa-check"></i>2M5</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m6"><i class="fa fa-check"></i>2M6</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m7"><i class="fa fa-check"></i>2M7</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h1"><i class="fa fa-check"></i>2H1</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h2"><i class="fa fa-check"></i>2H2</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h3"><i class="fa fa-check"></i>2H3</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h4"><i class="fa fa-check"></i>2H4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#further-reading-1"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html"><i class="fa fa-check"></i><b>3</b> Sampling the Imaginary</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#chapter-notes-2"><i class="fa fa-check"></i><b>3.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="3.2" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#questions-2"><i class="fa fa-check"></i><b>3.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e1-1"><i class="fa fa-check"></i>3E1</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e2-1"><i class="fa fa-check"></i>3E2</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e3-1"><i class="fa fa-check"></i>3E3</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e4-1"><i class="fa fa-check"></i>3E4</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e5"><i class="fa fa-check"></i>3E5</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e6"><i class="fa fa-check"></i>3E6</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e7"><i class="fa fa-check"></i>3E7</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m1-1"><i class="fa fa-check"></i>3M1</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m2-1"><i class="fa fa-check"></i>3M2</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m3-1"><i class="fa fa-check"></i>3M3</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m4-1"><i class="fa fa-check"></i>3M4</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m5-1"><i class="fa fa-check"></i>3M5</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m6-1"><i class="fa fa-check"></i>3M6</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h1-1"><i class="fa fa-check"></i>3H1</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h2-1"><i class="fa fa-check"></i>3H2</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h3-1"><i class="fa fa-check"></i>3H3</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h4-1"><i class="fa fa-check"></i>3H4</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h5"><i class="fa fa-check"></i>3H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#further-reading-2"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geocentric.html"><a href="geocentric.html"><i class="fa fa-check"></i><b>4</b> Geocentric Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="geocentric.html"><a href="geocentric.html#chapter-notes-3"><i class="fa fa-check"></i><b>4.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="geocentric.html"><a href="geocentric.html#model-using-grid-approximation"><i class="fa fa-check"></i><b>4.1.1</b> Model Using Grid Approximation</a></li>
<li class="chapter" data-level="4.1.2" data-path="geocentric.html"><a href="geocentric.html#model-using-quadratic-approximation"><i class="fa fa-check"></i><b>4.1.2</b> Model Using Quadratic Approximation</a></li>
<li class="chapter" data-level="4.1.3" data-path="geocentric.html"><a href="geocentric.html#adding-predictors"><i class="fa fa-check"></i><b>4.1.3</b> Adding Predictors</a></li>
<li class="chapter" data-level="4.1.4" data-path="geocentric.html"><a href="geocentric.html#polynomial-regression"><i class="fa fa-check"></i><b>4.1.4</b> Polynomial Regression</a></li>
<li class="chapter" data-level="4.1.5" data-path="geocentric.html"><a href="geocentric.html#b-splines"><i class="fa fa-check"></i><b>4.1.5</b> B-Splines</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="geocentric.html"><a href="geocentric.html#questions-3"><i class="fa fa-check"></i><b>4.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e1-2"><i class="fa fa-check"></i>4E1</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e2-2"><i class="fa fa-check"></i>4E2</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e3-2"><i class="fa fa-check"></i>4E3</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e4-2"><i class="fa fa-check"></i>4E4</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e5-1"><i class="fa fa-check"></i>4E5</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m1-2"><i class="fa fa-check"></i>4M1</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m2-2"><i class="fa fa-check"></i>4M2</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m3-2"><i class="fa fa-check"></i>4M3</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m4-2"><i class="fa fa-check"></i>4M4</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m5-2"><i class="fa fa-check"></i>4M5</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m6-2"><i class="fa fa-check"></i>4M6</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m7-1"><i class="fa fa-check"></i>4M7</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#further-reading-3"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="many_variables.html"><a href="many_variables.html"><i class="fa fa-check"></i><b>5</b> The Many Variables &amp; The Spurious Waffles</a>
<ul>
<li class="chapter" data-level="5.1" data-path="many_variables.html"><a href="many_variables.html#chapter-notes-4"><i class="fa fa-check"></i><b>5.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="5.2" data-path="many_variables.html"><a href="many_variables.html#questions-4"><i class="fa fa-check"></i><b>5.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e1-3"><i class="fa fa-check"></i>5E1</a></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e2-3"><i class="fa fa-check"></i>5E2</a></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e3-3"><i class="fa fa-check"></i>5E3</a></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e4-3"><i class="fa fa-check"></i>5E4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#further-reading-4"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="haunted_dag.html"><a href="haunted_dag.html"><i class="fa fa-check"></i><b>6</b> The Haunted DAG &amp; The Causal Terror</a>
<ul>
<li class="chapter" data-level="6.1" data-path="haunted_dag.html"><a href="haunted_dag.html#chapter-notes-5"><i class="fa fa-check"></i><b>6.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="6.2" data-path="haunted_dag.html"><a href="haunted_dag.html#questions-5"><i class="fa fa-check"></i><b>6.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#e1-4"><i class="fa fa-check"></i>6E1</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#e3-4"><i class="fa fa-check"></i>6E3</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#e4-4"><i class="fa fa-check"></i>6E4</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#m1-3"><i class="fa fa-check"></i>6M1</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#m2-3"><i class="fa fa-check"></i>6M2</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#m3-3"><i class="fa fa-check"></i>6M3</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h1-2"><i class="fa fa-check"></i>6H1</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h2-2"><i class="fa fa-check"></i>6H2</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h3-2"><i class="fa fa-check"></i>6H3</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h4-2"><i class="fa fa-check"></i>6H4</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h5-1"><i class="fa fa-check"></i>6H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#further-reading-5"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ulysses.html"><a href="ulysses.html"><i class="fa fa-check"></i><b>7</b> Ulysses’ Compass</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ulysses.html"><a href="ulysses.html#chapter-notes-6"><i class="fa fa-check"></i><b>7.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#brain-volume-model"><i class="fa fa-check"></i>Brain Volume model</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#log-pointwise-predictive-density"><i class="fa fa-check"></i>Log Pointwise Predictive Density</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#simulating-in-and-out-of-sample-deviance-for-varying-parameter-numbers"><i class="fa fa-check"></i>Simulating in and out of sample deviance for varying parameter numbers</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ulysses.html"><a href="ulysses.html#questions-6"><i class="fa fa-check"></i><b>7.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e1-5"><i class="fa fa-check"></i>7E1</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e2-4"><i class="fa fa-check"></i>7E2</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e3-5"><i class="fa fa-check"></i>7E3</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e4-5"><i class="fa fa-check"></i>7E4</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m1-4"><i class="fa fa-check"></i>7M1</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m2-4"><i class="fa fa-check"></i>7M2</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m3-4"><i class="fa fa-check"></i>7M3</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m4-3"><i class="fa fa-check"></i>7M4</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m5-3"><i class="fa fa-check"></i>7M5</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m6-3"><i class="fa fa-check"></i>7M6</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h1-3"><i class="fa fa-check"></i>7H1</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h2-3"><i class="fa fa-check"></i>7H2</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h3-3"><i class="fa fa-check"></i>7H3</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h4-3"><i class="fa fa-check"></i>7H4</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h5-2"><i class="fa fa-check"></i>7H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#further-reading-6"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="conditional.html"><a href="conditional.html"><i class="fa fa-check"></i><b>8</b> Conditional Manatees</a>
<ul>
<li class="chapter" data-level="8.1" data-path="conditional.html"><a href="conditional.html#chapter-notes-7"><i class="fa fa-check"></i><b>8.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#ruggedness-gdp-model"><i class="fa fa-check"></i>Ruggedness &amp; GDP Model</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="conditional.html"><a href="conditional.html#questions-7"><i class="fa fa-check"></i><b>8.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#e1-6"><i class="fa fa-check"></i>8E1</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#e2-5"><i class="fa fa-check"></i>8E2</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#e3-6"><i class="fa fa-check"></i>8E3</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#m1-5"><i class="fa fa-check"></i>8M1</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#m2-5"><i class="fa fa-check"></i>8M2</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#m3-5"><i class="fa fa-check"></i>8M3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="markov_chain.html"><a href="markov_chain.html"><i class="fa fa-check"></i><b>9</b> Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="markov_chain.html"><a href="markov_chain.html#chapter-notes-8"><i class="fa fa-check"></i><b>9.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#simulating-king-markovs-journey-a-metropolis-algorithm"><i class="fa fa-check"></i>Simulating King Markov’s Journey (A Metropolis Algorithm)</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="markov_chain.html"><a href="markov_chain.html#questions-8"><i class="fa fa-check"></i><b>9.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#e1-7"><i class="fa fa-check"></i>9E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#further-reading-7"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="big_entropy.html"><a href="big_entropy.html"><i class="fa fa-check"></i><b>10</b> Big Entropy and the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="10.1" data-path="big_entropy.html"><a href="big_entropy.html#chapter-notes-9"><i class="fa fa-check"></i><b>10.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="big_entropy.html"><a href="big_entropy.html#maximum-entropy"><i class="fa fa-check"></i>Maximum Entropy</a></li>
<li class="chapter" data-level="" data-path="big_entropy.html"><a href="big_entropy.html#generalized-linear-models"><i class="fa fa-check"></i>Generalized Linear Models</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="big_entropy.html"><a href="big_entropy.html#questions-9"><i class="fa fa-check"></i><b>10.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="big_entropy.html"><a href="big_entropy.html#further-resources"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="god_spiked.html"><a href="god_spiked.html"><i class="fa fa-check"></i><b>11</b> God Spiked the Integers</a>
<ul>
<li class="chapter" data-level="11.1" data-path="god_spiked.html"><a href="god_spiked.html#chapter-notes-10"><i class="fa fa-check"></i><b>11.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#binomial-regression"><i class="fa fa-check"></i>Binomial Regression</a></li>
<li class="chapter" data-level="11.1.1" data-path="god_spiked.html"><a href="god_spiked.html#poisson-regression"><i class="fa fa-check"></i><b>11.1.1</b> Poisson Regression</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#multinomial-and-categorical-models"><i class="fa fa-check"></i>Multinomial and Categorical Models</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="god_spiked.html"><a href="god_spiked.html#questions-10"><i class="fa fa-check"></i><b>11.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e1-8"><i class="fa fa-check"></i>11E1</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e2-6"><i class="fa fa-check"></i>11E2</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e3-7"><i class="fa fa-check"></i>11E3</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e4-6"><i class="fa fa-check"></i>11E4</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m1-6"><i class="fa fa-check"></i>11M1</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m2-6"><i class="fa fa-check"></i>11M2</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m3-6"><i class="fa fa-check"></i>11M3</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m4-4"><i class="fa fa-check"></i>11M4</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m5-4"><i class="fa fa-check"></i>11M5</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m6-4"><i class="fa fa-check"></i>11M6</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m7-2"><i class="fa fa-check"></i>11M7</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m8"><i class="fa fa-check"></i>11M8</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h1-4"><i class="fa fa-check"></i>11H1</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h2-4"><i class="fa fa-check"></i>11H2</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h3-4"><i class="fa fa-check"></i>11H3</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h4-4"><i class="fa fa-check"></i>11H4</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h5-3"><i class="fa fa-check"></i>11H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#further-resources-1"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html"><i class="fa fa-check"></i><b>12</b> Monsters and Mixtures</a>
<ul>
<li class="chapter" data-level="12.1" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#chapter-notes-11"><i class="fa fa-check"></i><b>12.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#over-dispersed-counts"><i class="fa fa-check"></i>Over-Dispersed Counts</a></li>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#zero-inflated-outcomes"><i class="fa fa-check"></i>Zero-Inflated Outcomes</a></li>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#ordered-categorical-outcomes"><i class="fa fa-check"></i>Ordered Categorical Outcomes</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#questions-11"><i class="fa fa-check"></i><b>12.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#e1-9"><i class="fa fa-check"></i>12E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#further-resources-2"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="models_memory.html"><a href="models_memory.html"><i class="fa fa-check"></i><b>13</b> Models With Memory</a>
<ul>
<li class="chapter" data-level="13.1" data-path="models_memory.html"><a href="models_memory.html#chapter-notes-12"><i class="fa fa-check"></i><b>13.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#more-than-one-type-of-cluster"><i class="fa fa-check"></i>More Than One Type of Cluster</a></li>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#divergent-transitions-and-non-centered-priors"><i class="fa fa-check"></i>Divergent Transitions and Non-Centered Priors</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="models_memory.html"><a href="models_memory.html#questions-12"><i class="fa fa-check"></i><b>13.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#e1-10"><i class="fa fa-check"></i>13E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#further-resources-3"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="covariance.html"><a href="covariance.html"><i class="fa fa-check"></i><b>14</b> Adventures in Covariance</a>
<ul>
<li class="chapter" data-level="14.1" data-path="covariance.html"><a href="covariance.html#chapter-notes-13"><i class="fa fa-check"></i><b>14.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#varying-slopes-by-construction"><i class="fa fa-check"></i>Varying Slopes by Construction</a></li>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#instruments-and-causal-designs"><i class="fa fa-check"></i>Instruments and Causal Designs</a></li>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#continuous-categories-and-the-gaussian-process"><i class="fa fa-check"></i>Continuous Categories and the Gaussian Process</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="covariance.html"><a href="covariance.html#questions-13"><i class="fa fa-check"></i><b>14.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#e1-11"><i class="fa fa-check"></i>14E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#further-resources-4"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="missing_data.html"><a href="missing_data.html"><i class="fa fa-check"></i><b>15</b> Missing Data and Other Opportunities</a>
<ul>
<li class="chapter" data-level="15.1" data-path="missing_data.html"><a href="missing_data.html#chapter-notes-14"><i class="fa fa-check"></i><b>15.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="missing_data.html"><a href="missing_data.html#measurement-error"><i class="fa fa-check"></i>Measurement Error</a></li>
<li class="chapter" data-level="" data-path="missing_data.html"><a href="missing_data.html#missing-data"><i class="fa fa-check"></i>Missing Data</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="missing_data.html"><a href="missing_data.html#questions-14"><i class="fa fa-check"></i><b>15.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="missing_data.html"><a href="missing_data.html#further-reading-8"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="generalized.html"><a href="generalized.html"><i class="fa fa-check"></i><b>16</b> Generalized Linear Madness</a>
<ul>
<li class="chapter" data-level="16.1" data-path="generalized.html"><a href="generalized.html#chapter-notes-15"><i class="fa fa-check"></i><b>16.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#geometric-people"><i class="fa fa-check"></i>Geometric People</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#hidden-minds-and-observed-behaviour"><i class="fa fa-check"></i>Hidden Minds and Observed Behaviour</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#ordinary-differential-nut-cracking"><i class="fa fa-check"></i>Ordinary Differential Nut Cracking</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#population-dynamics"><i class="fa fa-check"></i>Population Dynamics</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="generalized.html"><a href="generalized.html#questions-15"><i class="fa fa-check"></i><b>16.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#further-reading-9"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Rethinking Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="geocentric" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Geocentric Models</h1>
<div id="chapter-notes-3" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Chapter Notes</h2>
<p>The chapter opens with an analogy between the geocentric model of the solar system and linear regression - both are useful tools to describe certain natural phenomena, but we should be wary about taking the causal structure they imply literally.</p>
<p>The chapter is going to introduce linear regression with uncertainty described using a normal distribution. I.e. models like this:</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\sim \text{Normal}(\mu_i, \sigma) \\
\mu_i &amp;= \alpha + \beta x_i \\
\alpha &amp;\sim \text{Normal}(0, 10) \\ 
\beta &amp;\sim \text{Normal}(0, 1) \\
\sigma &amp;\sim \text{Exponential}(2) \\
\end{aligned}
\]</span></p>
<p>There is a section justifying the use of the normal distribution here by noting how many different ways we might see this pattern in nature - through additive or multiplicative processes. There is also reference to a maximum entropy argument for the normal curve: if all we have are a mean and a variance, the normal distribution is the most appropriate fit with our assumptions.</p>
<p>Maximum entropy arguments are described later on in Chapter 10.</p>
<p>There is then a section on notation, before the chapter introduces the first linear regression model of the book, a model of human height based on some data on the !Kung San collected by Nancy Howell in the 1960s.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="geocentric.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Howell1) </span>
<span id="cb55-2"><a href="geocentric.html#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="geocentric.html#cb55-3" aria-hidden="true" tabindex="-1"></a>data_howell <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(Howell1)</span>
<span id="cb55-4"><a href="geocentric.html#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="geocentric.html#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_howell)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   height weight   age  male
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
## 1   152.   47.8    63     1
## 2   140.   36.5    63     0
## 3   137.   31.9    65     0
## 4   157.   53.0    41     1
## 5   145.   41.3    51     0
## 6   164.   63.0    35     1</code></pre>
<p>We keep only data on the adult population, and plot the heights:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="geocentric.html#cb57-1" aria-hidden="true" tabindex="-1"></a>data_adults <span class="ot">&lt;-</span> data_howell <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="geocentric.html#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age<span class="sc">&gt;=</span><span class="dv">18</span>)</span>
<span id="cb57-3"><a href="geocentric.html#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="geocentric.html#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_adults)<span class="sc">+</span></span>
<span id="cb57-5"><a href="geocentric.html#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>height), <span class="at">bins =</span> <span class="dv">25</span>)</span></code></pre></div>
<p><img src="04-geocentric_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Here’s a nice bit about choosing modelling assumptions:</p>
<blockquote>
<p>These data look rather Gaussian in shape, as is typical of height data. This may be because height is a sum of many
small growth factors. As you saw at the start of the chapter, a distribution of sums tends to converge to a Gaussian distribution. Whatever the reason, adult heights from a single population are nearly always approximately normal.</p>
<p>So it’s reasonable for the moment to adopt the stance that the model should use a Gaussian distribution for the probability distribution of the data. But be careful about choosing the Gaussian distribution only when the plotted outcome variable looks Gaussian to you. Gawking at the raw data, to try to decide how tomodel them, is usually not a good idea. The data could be a mixture of different Gaussian distributions, for example, and in that case you won’t be able to detect the underlying normality just by eyeballing the outcome distribution. Furthermore, as mentioned earlier in this chapter, the empirical distribution needn’t be actually Gaussian in order to justify using a Gaussian probability distribution.</p>
</blockquote>
<p>We start building up our model:</p>
<p><span class="math display">\[
h_i \sim \text{Normal}(\mu, \sigma)
\]</span>
We are assuming here that every one of the 352 adult heights in the data set <span class="math inline">\(h_i\)</span> can be modelled as if it came from the same normal distribution with mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span>. A box in the chapter explains that this is a epistemological assumption, not one about the physical world. We know for example that height is correlated within family units. In making the assumption that all the heights are independent and identically distributed we are not claiming that these in-family correlations don’t exist, we are only claiming that if we don’t know the correlations, the i.i.d. assumption is a reasonable approximation.</p>
<p>In our model, <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are the parameters we want to estimate, but we start off with some priors:</p>
<p><span class="math display">\[
\begin{aligned}
\mu &amp;\sim \text{Normal}(178, 20) \\
\sigma &amp;\sim \text{Uniform}(0,50)
\end{aligned}
\]</span></p>
<p>The prior for <span class="math inline">\(\sigma\)</span> here is very flat, and the prior for <span class="math inline">\(\mu\)</span> is a normal distribution centred on 178cm, with a fairly large standard deviation of 20cm.</p>
<p>Here’s a plot of our prior for the average height parameter <span class="math inline">\(\mu\)</span>:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="geocentric.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb58-2"><a href="geocentric.html#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">100</span>,<span class="dv">250</span>)<span class="sc">+</span></span>
<span id="cb58-3"><a href="geocentric.html#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">178</span>, <span class="at">sd =</span> <span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb58-4"><a href="geocentric.html#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Density&quot;</span>)<span class="sc">+</span></span>
<span id="cb58-5"><a href="geocentric.html#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="st">&quot;Prior for Average Height&quot;</span> <span class="sc">~</span> mu))</span></code></pre></div>
<p><img src="04-geocentric_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Here’s a plot of the prior for the standard deviation <span class="math inline">\(\sigma\)</span>:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="geocentric.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb59-2"><a href="geocentric.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">60</span>)<span class="sc">+</span></span>
<span id="cb59-3"><a href="geocentric.html#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dunif, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">50</span>))<span class="sc">+</span></span>
<span id="cb59-4"><a href="geocentric.html#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Density&quot;</span>)<span class="sc">+</span></span>
<span id="cb59-5"><a href="geocentric.html#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="st">&quot;Prior for Standard Deviation&quot;</span> <span class="sc">~</span> sigma))</span></code></pre></div>
<p><img src="04-geocentric_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>We now simulate from our priors to see what they imply about height. This is called prior predictive simulation:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="geocentric.html#cb60-1" aria-hidden="true" tabindex="-1"></a>sample_mu <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">178</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb60-2"><a href="geocentric.html#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="geocentric.html#cb60-3" aria-hidden="true" tabindex="-1"></a>sample_sigma <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">50</span>)  </span>
<span id="cb60-4"><a href="geocentric.html#cb60-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-5"><a href="geocentric.html#cb60-5" aria-hidden="true" tabindex="-1"></a>sample_height <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean=</span>sample_mu, <span class="at">sd=</span>sample_sigma)</span>
<span id="cb60-6"><a href="geocentric.html#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="geocentric.html#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb60-8"><a href="geocentric.html#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(sample_height))<span class="sc">+</span></span>
<span id="cb60-9"><a href="geocentric.html#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Height(cm)&quot;</span>)<span class="sc">+</span></span>
<span id="cb60-10"><a href="geocentric.html#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Density&quot;</span>)<span class="sc">+</span></span>
<span id="cb60-11"><a href="geocentric.html#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Model Expectations Before Seeing the Data&quot;</span>)</span></code></pre></div>
<p><img src="04-geocentric_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Most of the probability mass here is in the range of plausible human heights, but some is not. The tallest person ever measured, for example, was Robert Wadlow at 272cm. We could justify tightening up our priors, but in this case we have enough data to overwhelm the priors anyway.</p>
<p>Here is the model, using Bayes’ rule:</p>
<p><span class="math display">\[
\text{Pr}(\mu, \sigma | h) = \frac{\prod_i \text{Normal}(h_i | \mu, \sigma) \text{Normal}(\mu | 178, 20) \text{Uniform}(\sigma |0 ,50) }{\int \int \prod_i \text{Normal}(h_i | \mu, \sigma) \text{Normal}(\mu | 178, 20) \text{Uniform}(\sigma |0 ,50) d\mu d\sigma}
\]</span>
To get the probability of the parameters given the data, we compute the probability of the parameters on each <span class="math inline">\(h_i\)</span> and then multiply them all together. This is what the product symbol is doing in the top row.</p>
<div id="model-using-grid-approximation" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Model Using Grid Approximation</h3>
<p>The chapter then uses grid approximation to get an estimate of the posterior. I think attempting to recreate this will be a useful exercise to understand conceptually the aim of later calculation methods (quadratic approximation and Markov chain Monte Carlo).</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="geocentric.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The calculation begins by defining a sequence over the parameter values</span></span>
<span id="cb61-2"><a href="geocentric.html#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="geocentric.html#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># I assume 150 to 160 are chosen because McElreath knows that this range will contain almost all</span></span>
<span id="cb61-4"><a href="geocentric.html#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># of the probability mass for the average height parameter mu</span></span>
<span id="cb61-5"><a href="geocentric.html#cb61-5" aria-hidden="true" tabindex="-1"></a>seq_mu <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from=</span><span class="dv">150</span>, <span class="at">to=</span><span class="dv">160</span> , <span class="at">length.out=</span><span class="dv">100</span> )</span>
<span id="cb61-6"><a href="geocentric.html#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="geocentric.html#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Similarly for sigma</span></span>
<span id="cb61-8"><a href="geocentric.html#cb61-8" aria-hidden="true" tabindex="-1"></a>seq_sigma <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from=</span><span class="dv">7</span> , <span class="at">to=</span><span class="dv">9</span> , <span class="at">length.out=</span><span class="dv">100</span> )</span>
<span id="cb61-9"><a href="geocentric.html#cb61-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-10"><a href="geocentric.html#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="co"># expand.grid gives essentially the Cartesian product of the two sequences in a data frame</span></span>
<span id="cb61-11"><a href="geocentric.html#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="co"># they each have 100 entries, so the data frame has 100 x 100 = 10,000 rows</span></span>
<span id="cb61-12"><a href="geocentric.html#cb61-12" aria-hidden="true" tabindex="-1"></a>post_grid <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">expand.grid</span>( <span class="at">mu=</span>seq_mu , <span class="at">sigma=</span>seq_sigma ))</span>
<span id="cb61-13"><a href="geocentric.html#cb61-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-14"><a href="geocentric.html#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="co"># The code in the chapter then uses sapply to produce the log likelihood.</span></span>
<span id="cb61-15"><a href="geocentric.html#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="co"># I&#39;m going to try to recreate  this using purrr.</span></span>
<span id="cb61-16"><a href="geocentric.html#cb61-16" aria-hidden="true" tabindex="-1"></a><span class="co"># For each point in the grid we produce a sum of the log likelihoods of the heights.</span></span>
<span id="cb61-17"><a href="geocentric.html#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Summing log likelihoods is equivalent to multiplying likelihoods.</span></span>
<span id="cb61-18"><a href="geocentric.html#cb61-18" aria-hidden="true" tabindex="-1"></a><span class="co"># I.e. For each mu and sigma combination, create a vector length 352 (the number of heights in the data set) </span></span>
<span id="cb61-19"><a href="geocentric.html#cb61-19" aria-hidden="true" tabindex="-1"></a><span class="co"># of log likelihoods, sum that vector, and assign it to that point on the grid</span></span>
<span id="cb61-20"><a href="geocentric.html#cb61-20" aria-hidden="true" tabindex="-1"></a>post_ll <span class="ot">&lt;-</span> post_grid <span class="sc">%&gt;%</span></span>
<span id="cb61-21"><a href="geocentric.html#cb61-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pmap_dbl</span>(<span class="at">.f =</span> <span class="cf">function</span>(mu,sigma){<span class="fu">sum</span>(<span class="fu">dnorm</span>(data_adults<span class="sc">$</span>height,<span class="at">mean=</span>mu, <span class="at">sd =</span> sigma, <span class="at">log =</span> <span class="cn">TRUE</span>))})</span>
<span id="cb61-22"><a href="geocentric.html#cb61-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-23"><a href="geocentric.html#cb61-23" aria-hidden="true" tabindex="-1"></a>post_grid <span class="ot">&lt;-</span> post_grid <span class="sc">%&gt;%</span></span>
<span id="cb61-24"><a href="geocentric.html#cb61-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_likelihood =</span> post_ll)</span>
<span id="cb61-25"><a href="geocentric.html#cb61-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-26"><a href="geocentric.html#cb61-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Then weight by the priors by adding the log probability of seeing each mu, sigma combination</span></span>
<span id="cb61-27"><a href="geocentric.html#cb61-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-28"><a href="geocentric.html#cb61-28" aria-hidden="true" tabindex="-1"></a>post_grid <span class="ot">&lt;-</span> post_grid <span class="sc">%&gt;%</span></span>
<span id="cb61-29"><a href="geocentric.html#cb61-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product =</span> log_likelihood <span class="sc">+</span> </span>
<span id="cb61-30"><a href="geocentric.html#cb61-30" aria-hidden="true" tabindex="-1"></a>           <span class="fu">dnorm</span>( post_grid<span class="sc">$</span>mu , <span class="dv">178</span> , <span class="dv">20</span> , <span class="at">log =</span> <span class="cn">TRUE</span> ) <span class="sc">+</span></span>
<span id="cb61-31"><a href="geocentric.html#cb61-31" aria-hidden="true" tabindex="-1"></a>           <span class="fu">dunif</span>( post_grid<span class="sc">$</span>sigma , <span class="dv">0</span> , <span class="dv">50</span> , <span class="cn">TRUE</span> ))</span>
<span id="cb61-32"><a href="geocentric.html#cb61-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-33"><a href="geocentric.html#cb61-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Finally, we normalise by subtracting the maximum product of likelihoods and priors.</span></span>
<span id="cb61-34"><a href="geocentric.html#cb61-34" aria-hidden="true" tabindex="-1"></a><span class="co"># This is equivalent to division because we are still working at the log scale.</span></span>
<span id="cb61-35"><a href="geocentric.html#cb61-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Finally we exponentiate to get to raw probabilities again.</span></span>
<span id="cb61-36"><a href="geocentric.html#cb61-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-37"><a href="geocentric.html#cb61-37" aria-hidden="true" tabindex="-1"></a>post_grid <span class="ot">&lt;-</span> post_grid <span class="sc">%&gt;%</span></span>
<span id="cb61-38"><a href="geocentric.html#cb61-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">post_prob =</span> <span class="fu">exp</span>( product <span class="sc">-</span> <span class="fu">max</span>(product) ))</span></code></pre></div>
<p>The only part I don’t get yet is why simply using the maximum of the product works to get us to posterior probabilities. Here’s what the chapter end note says on this:</p>
<blockquote>
<p>Finally, the obstacle for getting back on the probability scale is that rounding error is always a threat when moving from log-probability to probability. If you use the obvious approach, like exp( post<span class="math inline">\(prod ), you’ll get a vector full of zeros, which isn’t very helpful. This is a result of R’s rounding very small probabilities to zero. Remember, in large samples, all unique samples are unlikely. This is why you have to work with log-probability. The code in the box dodges this problem by scaling all of the log-products by the maximum log-product. As a result, the values in post\)</span>prob are not all zero, but they also aren’t exactly probabilities. Instead they are relative posterior probabilities. But that’s good enough for what we wish to do with these values.</p>
</blockquote>
<p>Makes sense. We have a list of numbers between 0 and 1 that are correct in proportion to each other, but we don’t have posterior probabilities.</p>
<p>I wonder how we would get the actual posterior probabilities. Why wouldn’t we be able to sum up all of the likelihood-prior products at each grid point and subtract that? Well we don’t have the likelihood-prior products. We have the log versions. And if we try to exponentiate them before scaling they all get set to zero.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="geocentric.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">exp</span>(post_grid<span class="sc">$</span>product))</span></code></pre></div>
<pre><code>## [1] 0 0 0 0 0 0</code></pre>
<p>So we need to scale them before exponentaiting but in order to get the correct scaling factor that will return posterior probabilities we need to exponentiate them.</p>
<p>I’m sure there’s a solution to this but for now I’ll continue on using the relative posterior “probabilities” we’ve already calculated. Here’s a glimpse of our posterior probabilities for the paramters mu and sigma:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="geocentric.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(post_grid[,<span class="sc">-</span><span class="dv">3</span><span class="sc">:-</span><span class="dv">4</span>])</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##      mu sigma post_prob
##   &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
## 1  150      7  1.96e-35
## 2  150.     7  5.35e-34
## 3  150.     7  1.36e-32
## 4  150.     7  3.20e-31
## 5  150.     7  7.00e-30
## 6  151.     7  1.42e-28</code></pre>
<p>We sample the mu and sigma parameters from the posterior, sampling each in proportion to it’s posterior probability. Since each posterior probability represents the relative plausibility of the <em>combination</em> of mu and sigma, we shouldn’t sample them independently. We sample a row number using the probabilities in column post_prob and then sample the posterior mu and sigma from that row:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="geocentric.html#cb66-1" aria-hidden="true" tabindex="-1"></a>sample_rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(post_grid),<span class="fl">1e4</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> post_grid<span class="sc">$</span>post_prob)</span>
<span id="cb66-2"><a href="geocentric.html#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="geocentric.html#cb66-3" aria-hidden="true" tabindex="-1"></a>sample_mu <span class="ot">&lt;-</span> post_grid<span class="sc">$</span>mu[sample_rows]</span>
<span id="cb66-4"><a href="geocentric.html#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="geocentric.html#cb66-5" aria-hidden="true" tabindex="-1"></a>sample_sigma <span class="ot">&lt;-</span> post_grid<span class="sc">$</span>sigma[sample_rows]</span>
<span id="cb66-6"><a href="geocentric.html#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="geocentric.html#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb66-8"><a href="geocentric.html#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bin_2d</span>(<span class="fu">aes</span>(<span class="at">x=</span>sample_mu,<span class="at">y=</span>sample_sigma), <span class="at">bins=</span><span class="dv">30</span>)<span class="sc">+</span></span>
<span id="cb66-9"><a href="geocentric.html#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Parameters Sampled from the Posterior&quot;</span>)</span></code></pre></div>
<p><img src="04-geocentric_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="model-using-quadratic-approximation" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Model Using Quadratic Approximation</h3>
<p>So that was grid approximation. It was useful to be forced to work through the calculation in detail. The chapter now reproduces this model, this time using quadratic approximation instead. The quap function in the Rethinking package takes a model definition in the form of an alist.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="geocentric.html#cb67-1" aria-hidden="true" tabindex="-1"></a>list_height <span class="ot">&lt;-</span> <span class="fu">alist</span>( <span class="co">#alist(), unlike list(), does not try to evaluate its entries</span></span>
<span id="cb67-2"><a href="geocentric.html#cb67-2" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb67-3"><a href="geocentric.html#cb67-3" aria-hidden="true" tabindex="-1"></a>  mu <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">178</span> , <span class="dv">20</span> ) , </span>
<span id="cb67-4"><a href="geocentric.html#cb67-4" aria-hidden="true" tabindex="-1"></a>  sigma <span class="sc">~</span> <span class="fu">dunif</span>( <span class="dv">0</span> , <span class="dv">50</span> )</span>
<span id="cb67-5"><a href="geocentric.html#cb67-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-6"><a href="geocentric.html#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="geocentric.html#cb67-7" aria-hidden="true" tabindex="-1"></a>m4_1 <span class="ot">&lt;-</span> <span class="fu">quap</span>( list_height , <span class="at">data=</span>data_adults )</span></code></pre></div>
<p>One of my goals in working through the book in this way is to become familiar with using Stan and tidybayes. The book won’t introduce Markov chain Monte Carlo until later, but I can start working with tidybayes from this point, because the tidybayes.rethinking package works with models created with the Rethinking package, which is where the function quap comes from.</p>
<p><a href="https://mjskay.github.io/tidybayes.rethinking/articles/tidy-rethinking.html">Here’s</a> the rethinking vignette for tidybayes.</p>
<p>From the vignette:</p>
<blockquote>
<p>The [tidybayes::]spread_draws() function yields a common format for all model types supported by tidybayes. It lets us instead extract draws into a data frame in tidy format, with a .chain and .iteration column storing the chain and iteration for each row (if available — these columns are NA for rethinking::quap() and rethinking::map() models), a .draw column that uniquely indexes each draw, and the remaining columns corresponding to model variables or variable indices. The spread_draws() function accepts any number of column specifications, which can include names for variables and names for variable indices.</p>
</blockquote>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="geocentric.html#cb68-1" aria-hidden="true" tabindex="-1"></a>post_quap <span class="ot">&lt;-</span> m4_1 <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="geocentric.html#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread_draws</span>(mu,sigma)</span>
<span id="cb68-3"><a href="geocentric.html#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="geocentric.html#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(post_quap,<span class="dv">10</span>) <span class="co"># displays the first 10 of 5,000 rows</span></span></code></pre></div>
<pre><code>## # A tibble: 10 x 5
##    .chain .iteration .draw    mu sigma
##     &lt;int&gt;      &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     NA         NA     1  155.  7.77
##  2     NA         NA     2  154.  7.86
##  3     NA         NA     3  155.  7.77
##  4     NA         NA     4  155.  8.03
##  5     NA         NA     5  155.  7.83
##  6     NA         NA     6  154.  6.97
##  7     NA         NA     7  155.  7.33
##  8     NA         NA     8  155.  7.17
##  9     NA         NA     9  154.  7.73
## 10     NA         NA    10  155.  7.65</code></pre>
<p>Here’s a summary of the posterior for our parameters using the point and interval summary functions from tidybayes:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="geocentric.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">74</span>)</span>
<span id="cb70-2"><a href="geocentric.html#cb70-2" aria-hidden="true" tabindex="-1"></a>m4_1 <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="geocentric.html#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(mu, sigma) <span class="sc">%&gt;%</span></span>
<span id="cb70-4"><a href="geocentric.html#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(<span class="at">.width=</span><span class="fl">0.89</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 7
##   .variable .value .lower .upper .width .point .interval
##   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 mu        155.   154.   155.     0.89 median qi       
## 2 sigma       7.73   7.27   8.20   0.89 median qi</code></pre>
<p>Here we return the parameter median in the .value column, and an 89% equi-tailed interval for our two parameters, in the .lower and .higher columns.</p>
<p>We can instead return the mean or mode in the .value column:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="geocentric.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">74</span>)</span>
<span id="cb72-2"><a href="geocentric.html#cb72-2" aria-hidden="true" tabindex="-1"></a>m4_1 <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="geocentric.html#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(mu, sigma) <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="geocentric.html#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mode_qi</span>(<span class="at">.width=</span><span class="fl">0.89</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 7
##   .variable .value .lower .upper .width .point .interval
##   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 mu        155.   154.   155.     0.89 mode   qi       
## 2 sigma       7.72   7.27   8.20   0.89 mode   qi</code></pre>
<p>The .value column has changed, but the .lower and .higher columns still specify the same 89% equi-tailed interval.</p>
<p>If we instead want to return the highest density interval we can do that by replacing “qi” in the function with “hdi”:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="geocentric.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">74</span>)</span>
<span id="cb74-2"><a href="geocentric.html#cb74-2" aria-hidden="true" tabindex="-1"></a>m4_1 <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="geocentric.html#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(mu, sigma) <span class="sc">%&gt;%</span></span>
<span id="cb74-4"><a href="geocentric.html#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_hdi</span>(<span class="at">.width=</span><span class="fl">0.89</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 7
##   .variable .value .lower .upper .width .point .interval
##   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 mu        155.   154.   155.     0.89 median hdi      
## 2 sigma       7.73   7.27   8.20   0.89 median hdi</code></pre>
<p>The summary function names are really intuitive, but if we don’t want to remember them we can use the point_interval() function only with arguments .point = mean/mode/median and .interval = qi/hdi.</p>
<p>The posterior figures above are those produced by quadratic approximation. This means that they represent Gaussian approximations for the marginal distribution of each parameter. This works fine when the posterior is broadly Gaussian.</p>
<p>Here we compare the results from quap:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="geocentric.html#cb76-1" aria-hidden="true" tabindex="-1"></a>m4_1 <span class="sc">%&gt;%</span></span>
<span id="cb76-2"><a href="geocentric.html#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(mu, sigma) <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="geocentric.html#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(<span class="at">.width=</span><span class="fl">0.89</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 7
##   .variable .value .lower .upper .width .point .interval
##   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 mu        155.   154.   155.     0.89 median qi       
## 2 sigma       7.73   7.26   8.18   0.89 median qi</code></pre>
<p>To the results from grid approximation:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="geocentric.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;mu&quot;</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] mu</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="geocentric.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(sample_mu, <span class="at">probs=</span><span class="fu">c</span>(<span class="fl">0.055</span>,<span class="fl">0.945</span>)) <span class="co"># the lower and upper values of an 89% interval</span></span></code></pre></div>
<pre><code>##     5.5%    94.5% 
## 153.9394 155.2525</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="geocentric.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;sigma&quot;</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] sigma</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="geocentric.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(sample_sigma, <span class="at">probs=</span><span class="fu">c</span>(<span class="fl">0.055</span>,<span class="fl">0.945</span>))</span></code></pre></div>
<pre><code>##     5.5%    94.5% 
## 7.323232 8.252525</code></pre>
<p>These are very close, especially for mu. We would expect this since mu is the outcome of a Gaussian likelihood and prior, whereas sigma was given a uniform prior with lower bound at zero. We might expect then that it would have a longer right tail than the quadratic approximation allows.</p>
</div>
<div id="adding-predictors" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Adding Predictors</h3>
<p>We are going to use the weights in our data set to predict heights:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="geocentric.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_adults)<span class="sc">+</span></span>
<span id="cb86-2"><a href="geocentric.html#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>weight, <span class="at">y=</span>height))<span class="sc">+</span></span>
<span id="cb86-3"><a href="geocentric.html#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;!Kung San Adults&quot;</span>)</span></code></pre></div>
<p><img src="04-geocentric_files/figure-html/unnamed-chunk-18-1.png" width="672" />
&gt; The strategy is to make the parameter for the mean of a Gaussian distribution, <span class="math inline">\(\mu\)</span>, into a linear function of the predictor variable and other, new parameters that we invent. This strategy is often simply called the linear model. The linear model strategy instructs the golem to assume that the predictor variable has a constant and additive relationship to the mean of the outcome. The golem then computes the posterior distribution of this constant relationship.</p>
<p>Here’s the previous model:</p>
<p><span class="math display">\[
\begin{aligned}
h_i &amp;\sim \text{Normal}(\mu, \sigma)\\
\mu &amp;\sim \text{Normal}(178, 20) \\
\sigma &amp;\sim \text{Uniform}(0,50)
\end{aligned}
\]</span></p>
<p>And here’s the model including weight as a predictor:</p>
<p><span class="math display">\[
\begin{aligned}
h_i &amp;= \text{Normal}(\mu_i, \sigma)\\
\mu_i &amp;= \alpha + \beta(x_i - \bar{x}) \\
\alpha &amp;\sim \text{Normal}(178, 20) \\
\beta &amp;\sim \text{Normal}(0, 10) \\
\sigma &amp;\sim \text{Uniform}(0,50)
\end{aligned}
\]</span>
Where each <span class="math inline">\(x_i\)</span> is the predictor (weight) associated with each observed height <span class="math inline">\(h_i\)</span>.</p>
<p>We have new parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. The intercept and slope of our linear model. What do our priors imply about them? We use prior predictive simulation:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="geocentric.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we generate 100 samples from our prior distributions</span></span>
<span id="cb87-2"><a href="geocentric.html#cb87-2" aria-hidden="true" tabindex="-1"></a>prior_sim <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">a=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">178</span>, <span class="at">sd=</span><span class="dv">20</span>),</span>
<span id="cb87-3"><a href="geocentric.html#cb87-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">b =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">10</span>))</span>
<span id="cb87-4"><a href="geocentric.html#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="geocentric.html#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co"># we plot the lines they imply</span></span>
<span id="cb87-6"><a href="geocentric.html#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(prior_sim)<span class="sc">+</span></span>
<span id="cb87-7"><a href="geocentric.html#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> b,</span>
<span id="cb87-8"><a href="geocentric.html#cb87-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">intercept =</span> a <span class="sc">-</span> b<span class="sc">*</span><span class="fu">mean</span>(data_adults<span class="sc">$</span>weight) ))<span class="sc">+</span> <span class="co"># explained below</span></span>
<span id="cb87-9"><a href="geocentric.html#cb87-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">min</span>(data_adults<span class="sc">$</span>weight),<span class="fu">max</span>(data_adults<span class="sc">$</span>weight))<span class="sc">+</span></span>
<span id="cb87-10"><a href="geocentric.html#cb87-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">300</span>)<span class="sc">+</span></span>
<span id="cb87-11"><a href="geocentric.html#cb87-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">272</span>, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span> <span class="co"># 272cm is Robert Wadlow&#39;s height</span></span>
<span id="cb87-12"><a href="geocentric.html#cb87-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb87-13"><a href="geocentric.html#cb87-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;weight (kg)&quot;</span>)<span class="sc">+</span></span>
<span id="cb87-14"><a href="geocentric.html#cb87-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;average height (cm)&quot;</span>)<span class="sc">+</span></span>
<span id="cb87-15"><a href="geocentric.html#cb87-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;b ~ Normal(0,10)&quot;</span>)</span></code></pre></div>
<p><img src="04-geocentric_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>For the slope of each line I’ve used the slope we generated from the prior. For the intercept I used</p>
<p><span class="math display">\[
\text{intercept = a - b*mean(weight)}
\]</span>
The reason for this is that I want the x-axis to vary over a natural range of the parameter weight to be more interpretable. And so instead of considering</p>
<p><span class="math display">\[
\mu_i = \alpha + \beta(x_i - \bar{x}) 
\]</span>
over the range <span class="math inline">\((\min( x_i) - \bar{x},\max( x_i) - \bar{x})\)</span>, I’ve looked at the equivalent line</p>
<p><span class="math display">\[
\mu_i = (\alpha - \beta\bar{x}) + \beta(x_i ) 
\]</span></p>
<p>over the range <span class="math inline">\((\min( x_i),\max( x_i)\)</span>.</p>
<p>The plot makes clear that our priors are very permissive. They allow impossible (e.g. negative) heights to be associated with observed weights. Also, just as many lines suggest that height may be negatively correlated with height as suggest a positive correlation.</p>
<p>The chapter also trials the more informative prior</p>
<p><span class="math display">\[
\beta \sim \text{Log-Normal}(0,1)
\]</span></p>
<p>This forces the relationship between weight and height to be positive. It also clusters the range of expected average height more tightly - limiting them for the most part to the range of plausible values. Here’s the same plot as before with the new prior:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="geocentric.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we generate 100 samples from our prior distributions</span></span>
<span id="cb88-2"><a href="geocentric.html#cb88-2" aria-hidden="true" tabindex="-1"></a>prior_sim_log <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">a=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">178</span>, <span class="at">sd=</span><span class="dv">20</span>),</span>
<span id="cb88-3"><a href="geocentric.html#cb88-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">b =</span> <span class="fu">rlnorm</span>(<span class="dv">100</span>, <span class="at">meanlog =</span> <span class="dv">0</span>, <span class="at">sdlog =</span> <span class="dv">1</span>))</span>
<span id="cb88-4"><a href="geocentric.html#cb88-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-5"><a href="geocentric.html#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="co"># we plot the lines they imply</span></span>
<span id="cb88-6"><a href="geocentric.html#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(prior_sim_log)<span class="sc">+</span></span>
<span id="cb88-7"><a href="geocentric.html#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> b,</span>
<span id="cb88-8"><a href="geocentric.html#cb88-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">intercept =</span> a <span class="sc">-</span> b<span class="sc">*</span><span class="fu">mean</span>(data_adults<span class="sc">$</span>weight) ))<span class="sc">+</span> <span class="co"># explained above</span></span>
<span id="cb88-9"><a href="geocentric.html#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">min</span>(data_adults<span class="sc">$</span>weight),<span class="fu">max</span>(data_adults<span class="sc">$</span>weight))<span class="sc">+</span></span>
<span id="cb88-10"><a href="geocentric.html#cb88-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">300</span>)<span class="sc">+</span></span>
<span id="cb88-11"><a href="geocentric.html#cb88-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">272</span>, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span> <span class="co"># 272cm is Robert Wadlow&#39;s height</span></span>
<span id="cb88-12"><a href="geocentric.html#cb88-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb88-13"><a href="geocentric.html#cb88-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;weight (kg)&quot;</span>)<span class="sc">+</span></span>
<span id="cb88-14"><a href="geocentric.html#cb88-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;average height (cm)&quot;</span>)<span class="sc">+</span></span>
<span id="cb88-15"><a href="geocentric.html#cb88-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;b ~ Log-Normal(0,1)&quot;</span>)</span></code></pre></div>
<p><img src="04-geocentric_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Here’s the model we’ll use:</p>
<p><span class="math display">\[
\begin{aligned}
h_i &amp;= \text{Normal}(\mu_i, \sigma)\\
\mu_i &amp;= \alpha + \beta(x_i - \bar{x}) \\
\alpha &amp;\sim \text{Normal}(178, 20) \\
\beta &amp;\sim \text{Log-Normal}(0, 1) \\
\sigma &amp;\sim \text{Uniform}(0,50)
\end{aligned}
\]</span>
We feed it to quap and create a table of the parameters using tidybayes:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="geocentric.html#cb89-1" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(data_adults<span class="sc">$</span>weight)</span>
<span id="cb89-2"><a href="geocentric.html#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="geocentric.html#cb89-3" aria-hidden="true" tabindex="-1"></a>m4_3 <span class="ot">&lt;-</span> <span class="fu">quap</span>( <span class="fu">alist</span>(</span>
<span id="cb89-4"><a href="geocentric.html#cb89-4" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb89-5"><a href="geocentric.html#cb89-5" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b<span class="sc">*</span>( weight <span class="sc">-</span> xbar ) , </span>
<span id="cb89-6"><a href="geocentric.html#cb89-6" aria-hidden="true" tabindex="-1"></a>  a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">178</span> , <span class="dv">20</span> ) , </span>
<span id="cb89-7"><a href="geocentric.html#cb89-7" aria-hidden="true" tabindex="-1"></a>  b <span class="sc">~</span> <span class="fu">dlnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) , </span>
<span id="cb89-8"><a href="geocentric.html#cb89-8" aria-hidden="true" tabindex="-1"></a>  sigma <span class="sc">~</span> <span class="fu">dunif</span>( <span class="dv">0</span> , <span class="dv">50</span> )</span>
<span id="cb89-9"><a href="geocentric.html#cb89-9" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data=</span> data_adults)</span>
<span id="cb89-10"><a href="geocentric.html#cb89-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-11"><a href="geocentric.html#cb89-11" aria-hidden="true" tabindex="-1"></a>m4_3 <span class="sc">%&gt;%</span></span>
<span id="cb89-12"><a href="geocentric.html#cb89-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(a, b, sigma) <span class="sc">%&gt;%</span></span>
<span id="cb89-13"><a href="geocentric.html#cb89-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(<span class="at">.width=</span><span class="fl">0.89</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 7
##   .variable  .value  .lower  .upper .width .point .interval
##   &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 a         155.    154.    155.      0.89 median qi       
## 2 b           0.902   0.835   0.969   0.89 median qi       
## 3 sigma       5.07    4.76    5.38    0.89 median qi</code></pre>
<p>Interpreting these:</p>
<ul>
<li>An <span class="math inline">\(\alpha\)</span> of 154.6cm means that a person of average weight is expected to be 154.6cm tall</li>
<li>A <span class="math inline">\(\beta\)</span> of 0.9 means that an increase in weight of 1kg is associated with a increase in height of 0.9cm</li>
</ul>
<p>We plot draws from the posterior (black lines) over the data (blue dots):</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="geocentric.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#extract 20 draws from the posterior</span></span>
<span id="cb91-2"><a href="geocentric.html#cb91-2" aria-hidden="true" tabindex="-1"></a>post_m4_3 <span class="ot">&lt;-</span> m4_3<span class="sc">%&gt;%</span><span class="fu">spread_draws</span>(a,b,<span class="at">ndraws =</span> <span class="dv">20</span>)</span>
<span id="cb91-3"><a href="geocentric.html#cb91-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-4"><a href="geocentric.html#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb91-5"><a href="geocentric.html#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>data_adults, <span class="fu">aes</span>(<span class="at">x=</span>weight, <span class="at">y=</span>height), <span class="at">colour =</span> <span class="st">&quot;light blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb91-6"><a href="geocentric.html#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data=</span>post_m4_3,<span class="fu">aes</span>(</span>
<span id="cb91-7"><a href="geocentric.html#cb91-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">slope =</span> b,</span>
<span id="cb91-8"><a href="geocentric.html#cb91-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">intercept =</span> a <span class="sc">-</span> b<span class="sc">*</span><span class="fu">mean</span>(data_adults<span class="sc">$</span>weight) ),<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb91-9"><a href="geocentric.html#cb91-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Posterior Samples Drawn over the Data&quot;</span>)</span></code></pre></div>
<p><img src="04-geocentric_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>How can we display the uncertainty in our model? In the plot above, I’ve used 20 draws of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> to manually plot the <em>expected</em> height over the range of weights seen in the data. There is uncertainty about this mean height, and we can display that by plotting many lines as above, or we can use the following, more flexible approach using tidybayes. This doesn’t require the manual calculation of the <span class="math inline">\(\mu\)</span>s that is implicit in the code for the graph above. This will be helpful when we move on to more complicated models.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="geocentric.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use modelr::data_grid to create a grid of 51 weights over the range found in the data </span></span>
<span id="cb92-2"><a href="geocentric.html#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data_grid</span>(data_adults,<span class="at">weight=</span><span class="fu">seq_range</span>(weight, <span class="at">n =</span> <span class="dv">51</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb92-3"><a href="geocentric.html#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_linpred_draws</span>(m4_3) <span class="sc">%&gt;%</span><span class="co"># add draws from the posterior link-level predictor - the expected heights</span></span>
<span id="cb92-4"><a href="geocentric.html#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 5,000 draws x 51 weights = 255,000 rows in this tibble</span></span>
<span id="cb92-5"><a href="geocentric.html#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y=</span>height)) <span class="sc">+</span></span>
<span id="cb92-6"><a href="geocentric.html#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .linpred)) <span class="sc">+</span></span>
<span id="cb92-7"><a href="geocentric.html#cb92-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_adults, <span class="at">colour =</span> <span class="st">&quot;light blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb92-8"><a href="geocentric.html#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Greys&quot;</span>)</span></code></pre></div>
<p><img src="04-geocentric_files/figure-html/unnamed-chunk-23-1.png" width="672" />
The shaded regions display the uncertainty in the expected heights for each weight.</p>
<p>However this is not the only source of uncertainty in our model. We also have uncertainty <em>around</em> the mean heights, represented by <span class="math inline">\(\sigma\)</span> in the model specification:</p>
<p><span class="math display">\[
h_i = \text{Normal}(\mu_i, \sigma)
\]</span>
We can display this in a similar way:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="geocentric.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data_grid</span>(data_adults,<span class="at">weight=</span><span class="fu">seq_range</span>(weight, <span class="at">n =</span> <span class="dv">51</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb93-2"><a href="geocentric.html#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predicted_draws</span>(m4_3) <span class="sc">%&gt;%</span><span class="co"># add draws from the posterior predictive - the posterior distribution of heights</span></span>
<span id="cb93-3"><a href="geocentric.html#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y=</span>height)) <span class="sc">+</span></span>
<span id="cb93-4"><a href="geocentric.html#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .prediction)) <span class="sc">+</span></span>
<span id="cb93-5"><a href="geocentric.html#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_adults, <span class="at">colour =</span> <span class="st">&quot;light blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb93-6"><a href="geocentric.html#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Greys&quot;</span>)</span></code></pre></div>
<p><img src="04-geocentric_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>There is a lot more uncertainty here. The key difference in the above two chunks of code is which tidybayes function is used to create the draws, linpred_draws() or predicted_draws(). The function linpred_draws() draws from the posterior distribution of the linear predictor. I.e. it draws from the distribution of <em>expected heights</em> in the model. Whereas predicted_draws() draws from the entire posterior distribution.</p>
<p>To do the same with Stan models later, we’ll need to use the tidybayes function add_draws() along with rstantools functions like posterior_epred() and posterior_predict().</p>
<p><a href="https://mjskay.github.io/tidybayes/reference/add_draws.html">Documentation for tidybayes::add_draws</a></p>
<p><a href="https://mc-stan.org/rstantools/reference/index.html">Documentation for rstantools functions</a></p>
</div>
<div id="polynomial-regression" class="section level3" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Polynomial Regression</h3>
<p>Here’s a model from the chapter that uses a quadratic link function. It is used to fit the height on weight model over the whole dataset, not just the adults:</p>
<p><span class="math display">\[
\begin{aligned}
h_i &amp;= \text{Normal}(\mu_i, \sigma)\\
\mu_i &amp;= \alpha + \beta_1x_i + \beta_1x_i^2\\
\alpha &amp;\sim \text{Normal}(178, 20) \\
\beta_1 &amp;\sim \text{Log-Normal}(0, 1) \\
\beta_2 &amp;\sim \text{Normal}(0, 1) \\
\sigma &amp;\sim \text{Uniform}(0,50)
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="geocentric.html#cb94-1" aria-hidden="true" tabindex="-1"></a>data_howell <span class="ot">&lt;-</span> data_howell<span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="geocentric.html#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight_s =</span> (weight <span class="sc">-</span> <span class="fu">mean</span>(weight))<span class="sc">/</span><span class="fu">sd</span>(weight),</span>
<span id="cb94-3"><a href="geocentric.html#cb94-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">weight_s2 =</span> weight_s<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb94-4"><a href="geocentric.html#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="geocentric.html#cb94-5" aria-hidden="true" tabindex="-1"></a>m4_5 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb94-6"><a href="geocentric.html#cb94-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb94-7"><a href="geocentric.html#cb94-7" aria-hidden="true" tabindex="-1"></a>        height <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) ,</span>
<span id="cb94-8"><a href="geocentric.html#cb94-8" aria-hidden="true" tabindex="-1"></a>        mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b1<span class="sc">*</span>weight_s <span class="sc">+</span> b2<span class="sc">*</span>weight_s2 ,</span>
<span id="cb94-9"><a href="geocentric.html#cb94-9" aria-hidden="true" tabindex="-1"></a>        a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">178</span> , <span class="dv">20</span> ) ,</span>
<span id="cb94-10"><a href="geocentric.html#cb94-10" aria-hidden="true" tabindex="-1"></a>        b1 <span class="sc">~</span> <span class="fu">dlnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) ,</span>
<span id="cb94-11"><a href="geocentric.html#cb94-11" aria-hidden="true" tabindex="-1"></a>        b2 <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) ,</span>
<span id="cb94-12"><a href="geocentric.html#cb94-12" aria-hidden="true" tabindex="-1"></a>        sigma <span class="sc">~</span> <span class="fu">dunif</span>( <span class="dv">0</span> , <span class="dv">50</span> )</span>
<span id="cb94-13"><a href="geocentric.html#cb94-13" aria-hidden="true" tabindex="-1"></a>    ) , <span class="at">data=</span>data_howell )</span>
<span id="cb94-14"><a href="geocentric.html#cb94-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-15"><a href="geocentric.html#cb94-15" aria-hidden="true" tabindex="-1"></a>m4_5 <span class="sc">%&gt;%</span></span>
<span id="cb94-16"><a href="geocentric.html#cb94-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(a, b1, b2, sigma) <span class="sc">%&gt;%</span></span>
<span id="cb94-17"><a href="geocentric.html#cb94-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(<span class="at">.width=</span><span class="fl">0.89</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 7
##   .variable .value .lower .upper .width .point .interval
##   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 a         146.   145.   147.     0.89 median qi       
## 2 b1         21.7   21.3   22.2    0.89 median qi       
## 3 b2         -7.81  -8.24  -7.37   0.89 median qi       
## 4 sigma       5.77   5.49   6.06   0.89 median qi</code></pre>
<p>Here’s a plot of draws from the posterior:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="geocentric.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data_grid</span>(data_howell,<span class="at">weight_s=</span><span class="fu">seq_range</span>(weight_s, <span class="at">n =</span> <span class="dv">51</span>)) <span class="sc">%&gt;%</span> <span class="co"># grid of standardised weights to range over</span></span>
<span id="cb96-2"><a href="geocentric.html#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight_s2 =</span> weight_s<span class="sc">^</span><span class="dv">2</span>)<span class="sc">%&gt;%</span> <span class="co"># the add_predicted_draws() function expects both weight_s and weight_s2</span></span>
<span id="cb96-3"><a href="geocentric.html#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predicted_draws</span>(m4_5) <span class="sc">%&gt;%</span></span>
<span id="cb96-4"><a href="geocentric.html#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight =</span> weight_s <span class="sc">*</span> <span class="fu">sd</span>(data_howell<span class="sc">$</span>weight) <span class="sc">+</span> <span class="fu">mean</span>(data_howell<span class="sc">$</span>weight) )<span class="sc">%&gt;%</span> <span class="co"># reversing the standardisation</span></span>
<span id="cb96-5"><a href="geocentric.html#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y=</span>height)) <span class="sc">+</span></span>
<span id="cb96-6"><a href="geocentric.html#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .prediction)) <span class="sc">+</span></span>
<span id="cb96-7"><a href="geocentric.html#cb96-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_howell, <span class="at">colour =</span> <span class="st">&quot;light blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb96-8"><a href="geocentric.html#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Greys&quot;</span>)</span></code></pre></div>
<p><img src="04-geocentric_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
<div id="b-splines" class="section level3" number="4.1.5">
<h3><span class="header-section-number">4.1.5</span> B-Splines</h3>
<p>The “B” stands for “basis.”</p>
<p>Here’s the data for the cherry blossom example used in this section:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="geocentric.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(cherry_blossoms) </span>
<span id="cb97-2"><a href="geocentric.html#cb97-2" aria-hidden="true" tabindex="-1"></a>data_blossoms <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(cherry_blossoms)<span class="sc">%&gt;%</span></span>
<span id="cb97-3"><a href="geocentric.html#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(doy)<span class="sc">==</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p>Creating knots for the splines:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="geocentric.html#cb98-1" aria-hidden="true" tabindex="-1"></a>num_knots <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="co"># number of knots</span></span>
<span id="cb98-2"><a href="geocentric.html#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="geocentric.html#cb98-3" aria-hidden="true" tabindex="-1"></a>knot_list <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data_blossoms<span class="sc">$</span>year , <span class="at">probs=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span>num_knots) )</span></code></pre></div>
<p>Constructing the basis functions for a cubic spline using the splines package:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="geocentric.html#cb99-1" aria-hidden="true" tabindex="-1"></a>basis <span class="ot">&lt;-</span> <span class="fu">bs</span>(data_blossoms<span class="sc">$</span>year, <span class="at">knots=</span>knot_list[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,num_knots)] , <span class="co"># function for generating the basis matrix</span></span>
<span id="cb99-2"><a href="geocentric.html#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="at">degree=</span><span class="dv">3</span> , <span class="at">intercept=</span><span class="cn">TRUE</span> ) <span class="co"># we don&#39;t want this as a tibble. We&#39;ll do matrix multiplication with it later on.</span></span></code></pre></div>
<p>Here’s the model for the day in the year when the cherry blossoms appear over time:</p>
<p><span class="math display">\[
\begin{aligned}
D &amp;= \text{Normal}(\mu_i, \sigma)\\
\mu_i &amp;= \alpha + \sum^K_{k=1}w_kB_{k,i}\\
\alpha &amp;\sim \text{Normal}(100, 10) \\
w_j &amp;\sim \text{Normal}(0, 10) \\
\sigma &amp;\sim \text{Exponential}(1)
\end{aligned}
\]</span>
A description from the chapter:</p>
<blockquote>
<p>That linear model might look weird. But all it is doing is multiplying each basis value by a corresponding parameter wk and then adding up all K of those products. This is just a compact way of writing a linear model. The rest should be familiar.</p>
</blockquote>
<p>Using the quap engine:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="geocentric.html#cb100-1" aria-hidden="true" tabindex="-1"></a>m4_7 <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb100-2"><a href="geocentric.html#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>( </span>
<span id="cb100-3"><a href="geocentric.html#cb100-3" aria-hidden="true" tabindex="-1"></a>    D <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb100-4"><a href="geocentric.html#cb100-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> B <span class="sc">%*%</span> w , </span>
<span id="cb100-5"><a href="geocentric.html#cb100-5" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">100</span>,<span class="dv">10</span>), </span>
<span id="cb100-6"><a href="geocentric.html#cb100-6" aria-hidden="true" tabindex="-1"></a>    w <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="dv">10</span>), </span>
<span id="cb100-7"><a href="geocentric.html#cb100-7" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb100-8"><a href="geocentric.html#cb100-8" aria-hidden="true" tabindex="-1"></a>), <span class="at">data=</span><span class="fu">list</span>( <span class="at">D=</span>data_blossoms<span class="sc">$</span>doy , <span class="at">B=</span>basis ) ,</span>
<span id="cb100-9"><a href="geocentric.html#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="at">start=</span><span class="fu">list</span>( <span class="at">w=</span><span class="fu">rep</span>( <span class="dv">0</span> , <span class="fu">ncol</span>(basis) ) ) )</span></code></pre></div>
<p>I’m not familiar enough with tidybayes yet to figure out how to get draws out of this model. I could use the tools in the rethinking package, but these wouldn’t transfer as well to the Stan models later in the book. Will revisit this once I know tidybayes better.</p>
</div>
</div>
<div id="questions-3" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Questions</h2>
<div id="e1-2" class="section level3 unnumbered">
<h3>4E1</h3>
<div id="question-33" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>In the model definition below, which line is the likelihood?</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\sim \text{Normal}(\mu, \sigma) \\
\mu &amp;\sim \text{Normal}(0, 10) \\
\sigma &amp;\sim \text{Exponential}(1)
\end{aligned}
\]</span></p>
</blockquote>
</div>
<div id="answer-33" class="section level4 unnumbered">
<h4>Answer</h4>
<p><span class="math inline">\(y_i ∼ \text{Normal}(µ, σ)\)</span></p>
</div>
</div>
<div id="e2-2" class="section level3 unnumbered">
<h3>4E2</h3>
<div id="question-34" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>In the model definition just above, how many parameters are in the posterior distribution?</p>
</blockquote>
</div>
<div id="answer-34" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Two parameters, <span class="math inline">\(\mu\)</span> &amp; <span class="math inline">\(\sigma\)</span>. <span class="math inline">\(y_i\)</span> is not a parameter, it’s the observed data.</p>
</div>
</div>
<div id="e3-2" class="section level3 unnumbered">
<h3>4E3</h3>
<div id="question-35" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Using the model definition above, write down the appropriate form of Bayes’ theorem that includes the proper likelihood and priors.</p>
</blockquote>
</div>
<div id="answer-35" class="section level4 unnumbered">
<h4>Answer</h4>
<p>In Bayes’ theorem, we want to end up with the probability of some hypothesis, given some data. In this case, our hypotheses are values for parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>. The probability of seeing the data (<span class="math inline">\(y_i\)</span>) that we do comes from our likelihood, in this case we’ve assumed the data is the result of a normal distribution. Let’s say we want to find the probability that our parameter values are <span class="math inline">\(\hat\mu\)</span> and <span class="math inline">\(\hat\sigma\)</span> given some piece of data <span class="math inline">\(y_i\)</span>. We apply Bayes’ theorem like this:</p>
<p><span class="math display">\[
\begin{aligned}
P(\hat\mu,\hat\sigma | y_i) &amp;= \frac{P(y_i | \hat\mu, \hat\sigma)P(\hat\mu)P(\hat\sigma)}{\int\int P(y_i | \mu, \sigma)P(\mu)P(\sigma) d\mu d\sigma}  \\
\\
                    &amp;= \frac{N(y_i | \hat\mu, \hat\sigma)N(\hat\mu | 0,10)\text{Exp}(\hat\sigma|1)}{\int\int N(y_i | \mu, \sigma)N(\mu | 0,10)\text{Exp}(\sigma|1) d\mu d\sigma}
\end{aligned}
\]</span></p>
<p>I mean <span class="math inline">\(N(y_i | \mu, \sigma)\)</span> to be read “the probability of observing <span class="math inline">\(y_i\)</span> given that it is normally distributed with parameters <span class="math inline">\(\mu\)</span> &amp; <span class="math inline">\(\sigma\)</span>. That notation is copied from page 78.</p>
</div>
</div>
<div id="e4-2" class="section level3 unnumbered">
<h3>4E4</h3>
<div id="question-36" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>In the model definition below, which line is the linear model?</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\sim \text{Normal}(\mu, \sigma) \\
\mu_i &amp;= \alpha + \beta x_i \\
\alpha &amp;\sim \text{Normal}(0, 10) \\ 
\beta &amp;\sim \text{Normal}(0, 1) \\
\sigma &amp;\sim \text{Exponential}(2) \\
\end{aligned}
\]</span></p>
</blockquote>
</div>
<div id="answer-36" class="section level4 unnumbered">
<h4>Answer</h4>
<p><span class="math inline">\(\mu_i = \alpha + \beta x_i\)</span></p>
<p>This is the assertion that <span class="math inline">\(\mu_i\)</span> is a linear function of <span class="math inline">\(x_i\)</span>.</p>
</div>
</div>
<div id="e5-1" class="section level3 unnumbered">
<h3>4E5</h3>
<div id="question-37" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>In the model definition just above, how many parameters are in the posterior distribution?</p>
</blockquote>
</div>
<div id="answer-37" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Three parameters, <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span> &amp; <span class="math inline">\(\sigma\)</span>.</p>
</div>
</div>
<div id="m1-2" class="section level3 unnumbered">
<h3>4M1</h3>
<div id="question-38" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>For the model definition below, simulate observed <span class="math inline">\(y\)</span> values from the prior (not the posterior).</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\sim \text{Normal}(\mu, \sigma) \\
\mu &amp;\sim \text{Normal}(0, 10) \\
\sigma &amp;\sim \text{Exponential}(1) \\
\end{aligned}
\]</span></p>
</blockquote>
</div>
<div id="answer-38" class="section level4 unnumbered">
<h4>Answer</h4>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="geocentric.html#cb101-1" aria-hidden="true" tabindex="-1"></a>num_obs <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb101-2"><a href="geocentric.html#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="geocentric.html#cb101-3" aria-hidden="true" tabindex="-1"></a>sim_prior <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(num_obs,</span>
<span id="cb101-4"><a href="geocentric.html#cb101-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mean=</span><span class="fu">rnorm</span>(num_obs, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">10</span>) , </span>
<span id="cb101-5"><a href="geocentric.html#cb101-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd=</span><span class="fu">rexp</span>(num_obs, <span class="at">rate =</span> <span class="dv">1</span>))</span>
<span id="cb101-6"><a href="geocentric.html#cb101-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-7"><a href="geocentric.html#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb101-8"><a href="geocentric.html#cb101-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x=</span>sim_prior))</span></code></pre></div>
<p><img src="04-geocentric_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
</div>
<div id="m2-2" class="section level3 unnumbered">
<h3>4M2</h3>
<div id="question-39" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Translate the model just above into a quap formula.</p>
</blockquote>
</div>
<div id="answer-39" class="section level4 unnumbered">
<h4>Answer</h4>
<p>y ~ dnorm(mu, sigma)
mu ~ dnorm(0, 10)
sigma ~ dexp(1)</p>
</div>
</div>
<div id="m3-2" class="section level3 unnumbered">
<h3>4M3</h3>
<div id="question-40" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Translate the quap model formula below into a mathematical model definition.</p>
<p>y ~ dnorm( mu , sigma ),</p>
<p>mu &lt;- a + b*x,</p>
<p>a ~ dnorm( 0 , 10 ),
.
b ~ dunif( 0 , 1 ),</p>
<p>sigma ~ dexp( 1 )</p>
</blockquote>
</div>
<div id="answer-40" class="section level4" number="4.2.0.1">
<h4><span class="header-section-number">4.2.0.1</span> Answer</h4>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\sim \text{Normal}(\mu, \sigma) \\
\mu_i &amp;= \alpha + \beta x_i\\
\alpha &amp;\sim  \text{Normal}(0, 10) \\
\beta &amp; \sim \text{Uniform}(0,1) \\
\sigma &amp; \sim \text{Exponential}(1)
\end{aligned}
\]</span></p>
</div>
</div>
<div id="m4-2" class="section level3 unnumbered">
<h3>4M4</h3>
<div id="question-41" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>A sample of students is measured for height each year for 3 years. After the third year, you want to fit a linear regression predicting height using year as a predictor.</p>
<p>Write down the mathematical model definition for this regression, using any variable names and priors you choose. Be prepared to defend your choice of priors.</p>
</blockquote>
</div>
<div id="answer-41" class="section level4 unnumbered">
<h4>Answer</h4>
<p>hi ∼ Normal(µ, σ)</p>
<p>µi = α + βyi</p>
<p>α ~ Normal(178, 20)</p>
<p>β ∼ Normal(0,10)</p>
<p>σ ∼ Exponential(0.05)</p>
</div>
</div>
<div id="m5-2" class="section level3 unnumbered">
<h3>4M5</h3>
<div id="question-42" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Now suppose I remind you that every student got taller each year. Does this information lead you to change your choice of priors? How?</p>
</blockquote>
</div>
<div id="answer-42" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Yes, I would revise β to something like β ∼ Exponential(0.2).</p>
<p>Now it can only be positive (before I wasn’t sure if we were following the same students, or the same class with a new intake of students).</p>
<p>Probably still anticipating too much height growth with this prior, assuming these are university students. On the other hand Dennis Rodman grew like 8 inches one summer after high school apparently so want to keep open the possibility.</p>
</div>
</div>
<div id="m6-2" class="section level3 unnumbered">
<h3>4M6</h3>
<div id="question-43" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Now suppose I tell you that the variance among heights for students of the same age is never more than 64cm. How does this lead you to revise your priors?</p>
</blockquote>
</div>
<div id="answer-43" class="section level4 unnumbered">
<h4>Answer</h4>
<p>I think my previous prior σ ∼ Exponential(0.05) is probably still fine. If anything this question makes me think I wasn’t being conservative enough with my first choice of priors.</p>
</div>
</div>
<div id="m7-1" class="section level3 unnumbered">
<h3>4M7</h3>
<div id="question-44" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Refit model m4.3 from the chapter, but omit the mean weight xbar this time.
Compare the new model’s posterior to that of the original model. In particular, look at the covariance among the
parameters. What is different? Then compare the posterior predictions of both models.</p>
</blockquote>
</div>
<div id="answer-44" class="section level4 unnumbered">
<h4>Answer</h4>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="geocentric.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Howell1)</span>
<span id="cb102-2"><a href="geocentric.html#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="geocentric.html#cb102-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> Howell1 </span>
<span id="cb102-4"><a href="geocentric.html#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="geocentric.html#cb102-5" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> d[ d<span class="sc">$</span>age <span class="sc">&gt;=</span> <span class="dv">18</span> , ]</span>
<span id="cb102-6"><a href="geocentric.html#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="geocentric.html#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="co"># define the average weight, x-bar </span></span>
<span id="cb102-8"><a href="geocentric.html#cb102-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-9"><a href="geocentric.html#cb102-9" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(d2<span class="sc">$</span>weight)</span>
<span id="cb102-10"><a href="geocentric.html#cb102-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-11"><a href="geocentric.html#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb102-12"><a href="geocentric.html#cb102-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-13"><a href="geocentric.html#cb102-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb102-14"><a href="geocentric.html#cb102-14" aria-hidden="true" tabindex="-1"></a>m4<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>( <span class="fu">alist</span>(</span>
<span id="cb102-15"><a href="geocentric.html#cb102-15" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb102-16"><a href="geocentric.html#cb102-16" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b<span class="sc">*</span>( weight <span class="sc">-</span> xbar ) , </span>
<span id="cb102-17"><a href="geocentric.html#cb102-17" aria-hidden="true" tabindex="-1"></a>  a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">178</span> , <span class="dv">20</span> ) , </span>
<span id="cb102-18"><a href="geocentric.html#cb102-18" aria-hidden="true" tabindex="-1"></a>  b <span class="sc">~</span> <span class="fu">dlnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) , </span>
<span id="cb102-19"><a href="geocentric.html#cb102-19" aria-hidden="true" tabindex="-1"></a>  sigma <span class="sc">~</span> <span class="fu">dunif</span>( <span class="dv">0</span> , <span class="dv">50</span> )</span>
<span id="cb102-20"><a href="geocentric.html#cb102-20" aria-hidden="true" tabindex="-1"></a>  ) , </span>
<span id="cb102-21"><a href="geocentric.html#cb102-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>d2 )</span>
<span id="cb102-22"><a href="geocentric.html#cb102-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-23"><a href="geocentric.html#cb102-23" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb102-24"><a href="geocentric.html#cb102-24" aria-hidden="true" tabindex="-1"></a>m4.<span class="fl">3.2</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>( <span class="fu">alist</span>(</span>
<span id="cb102-25"><a href="geocentric.html#cb102-25" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb102-26"><a href="geocentric.html#cb102-26" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b<span class="sc">*</span>( weight ) , </span>
<span id="cb102-27"><a href="geocentric.html#cb102-27" aria-hidden="true" tabindex="-1"></a>  a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">178</span> , <span class="dv">20</span> ) , </span>
<span id="cb102-28"><a href="geocentric.html#cb102-28" aria-hidden="true" tabindex="-1"></a>  b <span class="sc">~</span> <span class="fu">dlnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) , </span>
<span id="cb102-29"><a href="geocentric.html#cb102-29" aria-hidden="true" tabindex="-1"></a>  sigma <span class="sc">~</span> <span class="fu">dunif</span>( <span class="dv">0</span> , <span class="dv">50</span> )</span>
<span id="cb102-30"><a href="geocentric.html#cb102-30" aria-hidden="true" tabindex="-1"></a>  ) , </span>
<span id="cb102-31"><a href="geocentric.html#cb102-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>d2 )</span></code></pre></div>
<p>Chapter questions unfinished.</p>
</div>
</div>
</div>
<div id="further-reading-3" class="section level2 unnumbered">
<h2>Further Reading</h2>
<p>This is the first chapter that really refers to E. T. Jaynes in detail. I really want to read <em>Probability Theory: The Logic of Science</em>. I’m not sure how mathematically dense it is but will maybe hold off until summer, once I’ve seen some measure theory and worked through MacKay’s book on information theory.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sampling_imaginary.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="many_variables.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-geocentric.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
