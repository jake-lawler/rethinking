<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 The Haunted DAG &amp; The Causal Terror | Statistical Rethinking Notes</title>
  <meta name="description" content="My notes on Richard McElreath’s ‘Statistical Rethinking.’" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 The Haunted DAG &amp; The Causal Terror | Statistical Rethinking Notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="My notes on Richard McElreath’s ‘Statistical Rethinking.’" />
  <meta name="github-repo" content="jake-lawler/rethinking" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 The Haunted DAG &amp; The Causal Terror | Statistical Rethinking Notes" />
  
  <meta name="twitter:description" content="My notes on Richard McElreath’s ‘Statistical Rethinking.’" />
  

<meta name="author" content="Jake Lawler" />


<meta name="date" content="2022-02-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="many_variables.html"/>
<link rel="next" href="ulysses.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="prague.html"><a href="prague.html"><i class="fa fa-check"></i><b>1</b> The Golem of Prague</a>
<ul>
<li class="chapter" data-level="1.1" data-path="prague.html"><a href="prague.html#chapter-notes"><i class="fa fa-check"></i><b>1.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="1.2" data-path="prague.html"><a href="prague.html#questions"><i class="fa fa-check"></i><b>1.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="prague.html"><a href="prague.html#further-reading"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="small_worlds.html"><a href="small_worlds.html"><i class="fa fa-check"></i><b>2</b> Small Worlds and Large Worlds</a>
<ul>
<li class="chapter" data-level="2.1" data-path="small_worlds.html"><a href="small_worlds.html#chapter-notes-1"><i class="fa fa-check"></i><b>2.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="2.2" data-path="small_worlds.html"><a href="small_worlds.html#questions-1"><i class="fa fa-check"></i><b>2.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e1"><i class="fa fa-check"></i>2E1</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e2"><i class="fa fa-check"></i>2E2</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e3"><i class="fa fa-check"></i>2E3</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e4"><i class="fa fa-check"></i>2E4</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m1"><i class="fa fa-check"></i>2M1</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m2"><i class="fa fa-check"></i>2M2</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m3"><i class="fa fa-check"></i>2M3</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m4"><i class="fa fa-check"></i>2M4</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m5"><i class="fa fa-check"></i>2M5</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m6"><i class="fa fa-check"></i>2M6</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m7"><i class="fa fa-check"></i>2M7</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h1"><i class="fa fa-check"></i>2H1</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h2"><i class="fa fa-check"></i>2H2</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h3"><i class="fa fa-check"></i>2H3</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h4"><i class="fa fa-check"></i>2H4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#further-reading-1"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html"><i class="fa fa-check"></i><b>3</b> Sampling the Imaginary</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#chapter-notes-2"><i class="fa fa-check"></i><b>3.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="3.2" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#questions-2"><i class="fa fa-check"></i><b>3.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e1-1"><i class="fa fa-check"></i>3E1</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e2-1"><i class="fa fa-check"></i>3E2</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e3-1"><i class="fa fa-check"></i>3E3</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e4-1"><i class="fa fa-check"></i>3E4</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e5"><i class="fa fa-check"></i>3E5</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e6"><i class="fa fa-check"></i>3E6</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e7"><i class="fa fa-check"></i>3E7</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m1-1"><i class="fa fa-check"></i>3M1</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m2-1"><i class="fa fa-check"></i>3M2</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m3-1"><i class="fa fa-check"></i>3M3</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m4-1"><i class="fa fa-check"></i>3M4</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m5-1"><i class="fa fa-check"></i>3M5</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m6-1"><i class="fa fa-check"></i>3M6</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h1-1"><i class="fa fa-check"></i>3H1</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h2-1"><i class="fa fa-check"></i>3H2</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h3-1"><i class="fa fa-check"></i>3H3</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h4-1"><i class="fa fa-check"></i>3H4</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h5"><i class="fa fa-check"></i>3H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#further-reading-2"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geocentric.html"><a href="geocentric.html"><i class="fa fa-check"></i><b>4</b> Geocentric Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="geocentric.html"><a href="geocentric.html#chapter-notes-3"><i class="fa fa-check"></i><b>4.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="geocentric.html"><a href="geocentric.html#model-using-grid-approximation"><i class="fa fa-check"></i><b>4.1.1</b> Model Using Grid Approximation</a></li>
<li class="chapter" data-level="4.1.2" data-path="geocentric.html"><a href="geocentric.html#model-using-quadratic-approximation"><i class="fa fa-check"></i><b>4.1.2</b> Model Using Quadratic Approximation</a></li>
<li class="chapter" data-level="4.1.3" data-path="geocentric.html"><a href="geocentric.html#adding-predictors"><i class="fa fa-check"></i><b>4.1.3</b> Adding Predictors</a></li>
<li class="chapter" data-level="4.1.4" data-path="geocentric.html"><a href="geocentric.html#polynomial-regression"><i class="fa fa-check"></i><b>4.1.4</b> Polynomial Regression</a></li>
<li class="chapter" data-level="4.1.5" data-path="geocentric.html"><a href="geocentric.html#b-splines"><i class="fa fa-check"></i><b>4.1.5</b> B-Splines</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="geocentric.html"><a href="geocentric.html#questions-3"><i class="fa fa-check"></i><b>4.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e1-2"><i class="fa fa-check"></i>4E1</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e2-2"><i class="fa fa-check"></i>4E2</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e3-2"><i class="fa fa-check"></i>4E3</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e4-2"><i class="fa fa-check"></i>4E4</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e5-1"><i class="fa fa-check"></i>4E5</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m1-2"><i class="fa fa-check"></i>4M1</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m2-2"><i class="fa fa-check"></i>4M2</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m3-2"><i class="fa fa-check"></i>4M3</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m4-2"><i class="fa fa-check"></i>4M4</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m5-2"><i class="fa fa-check"></i>4M5</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m6-2"><i class="fa fa-check"></i>4M6</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m7-1"><i class="fa fa-check"></i>4M7</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#further-reading-3"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="many_variables.html"><a href="many_variables.html"><i class="fa fa-check"></i><b>5</b> The Many Variables &amp; The Spurious Waffles</a>
<ul>
<li class="chapter" data-level="5.1" data-path="many_variables.html"><a href="many_variables.html#chapter-notes-4"><i class="fa fa-check"></i><b>5.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="5.2" data-path="many_variables.html"><a href="many_variables.html#questions-4"><i class="fa fa-check"></i><b>5.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e1-3"><i class="fa fa-check"></i>5E1</a></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e2-3"><i class="fa fa-check"></i>5E2</a></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e3-3"><i class="fa fa-check"></i>5E3</a></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e4-3"><i class="fa fa-check"></i>5E4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#further-reading-4"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="haunted_dag.html"><a href="haunted_dag.html"><i class="fa fa-check"></i><b>6</b> The Haunted DAG &amp; The Causal Terror</a>
<ul>
<li class="chapter" data-level="6.1" data-path="haunted_dag.html"><a href="haunted_dag.html#chapter-notes-5"><i class="fa fa-check"></i><b>6.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#multicollinearity"><i class="fa fa-check"></i>Multicollinearity</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#post-treatment-bias"><i class="fa fa-check"></i>Post-Treatment Bias</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#collider-bias"><i class="fa fa-check"></i>Collider Bias</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="haunted_dag.html"><a href="haunted_dag.html#questions-5"><i class="fa fa-check"></i><b>6.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#e1-4"><i class="fa fa-check"></i>6E1</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#e3-4"><i class="fa fa-check"></i>6E3</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#e4-4"><i class="fa fa-check"></i>6E4</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#m1-3"><i class="fa fa-check"></i>6M1</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#m2-3"><i class="fa fa-check"></i>6M2</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#m3-3"><i class="fa fa-check"></i>6M3</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h1-2"><i class="fa fa-check"></i>6H1</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h2-2"><i class="fa fa-check"></i>6H2</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h3-2"><i class="fa fa-check"></i>6H3</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h4-2"><i class="fa fa-check"></i>6H4</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h5-1"><i class="fa fa-check"></i>6H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#further-reading-5"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ulysses.html"><a href="ulysses.html"><i class="fa fa-check"></i><b>7</b> Ulysses’ Compass</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ulysses.html"><a href="ulysses.html#chapter-notes-6"><i class="fa fa-check"></i><b>7.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#brain-volume-model"><i class="fa fa-check"></i>Brain Volume model</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#log-pointwise-predictive-density"><i class="fa fa-check"></i>Log Pointwise Predictive Density</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#simulating-in-and-out-of-sample-deviance-for-varying-parameter-numbers"><i class="fa fa-check"></i>Simulating in and out of sample deviance for varying parameter numbers</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#predicting-predicitve-accuracy"><i class="fa fa-check"></i>Predicting Predicitve Accuracy</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ulysses.html"><a href="ulysses.html#questions-6"><i class="fa fa-check"></i><b>7.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e1-5"><i class="fa fa-check"></i>7E1</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e2-4"><i class="fa fa-check"></i>7E2</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e3-5"><i class="fa fa-check"></i>7E3</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e4-5"><i class="fa fa-check"></i>7E4</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m1-4"><i class="fa fa-check"></i>7M1</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m2-4"><i class="fa fa-check"></i>7M2</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m3-4"><i class="fa fa-check"></i>7M3</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m4-3"><i class="fa fa-check"></i>7M4</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m5-3"><i class="fa fa-check"></i>7M5</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m6-3"><i class="fa fa-check"></i>7M6</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h1-3"><i class="fa fa-check"></i>7H1</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h2-3"><i class="fa fa-check"></i>7H2</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h3-3"><i class="fa fa-check"></i>7H3</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h4-3"><i class="fa fa-check"></i>7H4</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h5-2"><i class="fa fa-check"></i>7H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#further-reading-6"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="conditional.html"><a href="conditional.html"><i class="fa fa-check"></i><b>8</b> Conditional Manatees</a>
<ul>
<li class="chapter" data-level="8.1" data-path="conditional.html"><a href="conditional.html#chapter-notes-7"><i class="fa fa-check"></i><b>8.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#ruggedness-gdp-model"><i class="fa fa-check"></i>Ruggedness &amp; GDP Model</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="conditional.html"><a href="conditional.html#questions-7"><i class="fa fa-check"></i><b>8.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#e1-6"><i class="fa fa-check"></i>8E1</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#e2-5"><i class="fa fa-check"></i>8E2</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#e3-6"><i class="fa fa-check"></i>8E3</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#m1-5"><i class="fa fa-check"></i>8M1</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#m2-5"><i class="fa fa-check"></i>8M2</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#m3-5"><i class="fa fa-check"></i>8M3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="markov_chain.html"><a href="markov_chain.html"><i class="fa fa-check"></i><b>9</b> Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="markov_chain.html"><a href="markov_chain.html#chapter-notes-8"><i class="fa fa-check"></i><b>9.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#a-metropolis-algorithm"><i class="fa fa-check"></i>A Metropolis Algorithm</a></li>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#gibbs-sampling-and-hamiltonian-monte-carlo"><i class="fa fa-check"></i>Gibbs Sampling and Hamiltonian Monte Carlo</a></li>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#posterior-predictive-checks-with-stan"><i class="fa fa-check"></i>Posterior Predictive Checks with Stan</a></li>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#prior-predictive-checks-with-stan"><i class="fa fa-check"></i>Prior Predictive Checks with Stan</a></li>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#diagnostics-comparison---trace-plots-waic-psis"><i class="fa fa-check"></i>Diagnostics &amp; Comparison - Trace Plots, WAIC &amp; PSIS</a></li>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#care-and-feeding-of-your-markov-chain"><i class="fa fa-check"></i>Care and Feeding of Your Markov Chain</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="markov_chain.html"><a href="markov_chain.html#questions-8"><i class="fa fa-check"></i><b>9.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#e1-7"><i class="fa fa-check"></i>9E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#further-reading-7"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="big_entropy.html"><a href="big_entropy.html"><i class="fa fa-check"></i><b>10</b> Big Entropy and the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="10.1" data-path="big_entropy.html"><a href="big_entropy.html#chapter-notes-9"><i class="fa fa-check"></i><b>10.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="big_entropy.html"><a href="big_entropy.html#maximum-entropy"><i class="fa fa-check"></i>Maximum Entropy</a></li>
<li class="chapter" data-level="" data-path="big_entropy.html"><a href="big_entropy.html#generalized-linear-models"><i class="fa fa-check"></i>Generalized Linear Models</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="big_entropy.html"><a href="big_entropy.html#questions-9"><i class="fa fa-check"></i><b>10.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="big_entropy.html"><a href="big_entropy.html#further-resources"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="god_spiked.html"><a href="god_spiked.html"><i class="fa fa-check"></i><b>11</b> God Spiked the Integers</a>
<ul>
<li class="chapter" data-level="11.1" data-path="god_spiked.html"><a href="god_spiked.html#chapter-notes-10"><i class="fa fa-check"></i><b>11.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#binomial-regression"><i class="fa fa-check"></i>Binomial Regression</a></li>
<li class="chapter" data-level="11.1.1" data-path="god_spiked.html"><a href="god_spiked.html#poisson-regression"><i class="fa fa-check"></i><b>11.1.1</b> Poisson Regression</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#multinomial-and-categorical-models"><i class="fa fa-check"></i>Multinomial and Categorical Models</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="god_spiked.html"><a href="god_spiked.html#questions-10"><i class="fa fa-check"></i><b>11.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e1-8"><i class="fa fa-check"></i>11E1</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e2-6"><i class="fa fa-check"></i>11E2</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e3-7"><i class="fa fa-check"></i>11E3</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e4-6"><i class="fa fa-check"></i>11E4</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m1-6"><i class="fa fa-check"></i>11M1</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m2-6"><i class="fa fa-check"></i>11M2</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m3-6"><i class="fa fa-check"></i>11M3</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m4-4"><i class="fa fa-check"></i>11M4</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m5-4"><i class="fa fa-check"></i>11M5</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m6-4"><i class="fa fa-check"></i>11M6</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m7-2"><i class="fa fa-check"></i>11M7</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m8"><i class="fa fa-check"></i>11M8</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h1-4"><i class="fa fa-check"></i>11H1</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h2-4"><i class="fa fa-check"></i>11H2</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h3-4"><i class="fa fa-check"></i>11H3</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h4-4"><i class="fa fa-check"></i>11H4</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h5-3"><i class="fa fa-check"></i>11H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#further-resources-1"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html"><i class="fa fa-check"></i><b>12</b> Monsters and Mixtures</a>
<ul>
<li class="chapter" data-level="12.1" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#chapter-notes-11"><i class="fa fa-check"></i><b>12.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#over-dispersed-counts"><i class="fa fa-check"></i>Over-Dispersed Counts</a></li>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#zero-inflated-outcomes"><i class="fa fa-check"></i>Zero-Inflated Outcomes</a></li>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#ordered-categorical-outcomes"><i class="fa fa-check"></i>Ordered Categorical Outcomes</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#questions-11"><i class="fa fa-check"></i><b>12.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#e1-9"><i class="fa fa-check"></i>12E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#further-resources-2"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="models_memory.html"><a href="models_memory.html"><i class="fa fa-check"></i><b>13</b> Models With Memory</a>
<ul>
<li class="chapter" data-level="13.1" data-path="models_memory.html"><a href="models_memory.html#chapter-notes-12"><i class="fa fa-check"></i><b>13.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#more-than-one-type-of-cluster"><i class="fa fa-check"></i>More Than One Type of Cluster</a></li>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#divergent-transitions-and-non-centered-priors"><i class="fa fa-check"></i>Divergent Transitions and Non-Centered Priors</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="models_memory.html"><a href="models_memory.html#questions-12"><i class="fa fa-check"></i><b>13.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#e1-10"><i class="fa fa-check"></i>13E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#further-resources-3"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="covariance.html"><a href="covariance.html"><i class="fa fa-check"></i><b>14</b> Adventures in Covariance</a>
<ul>
<li class="chapter" data-level="14.1" data-path="covariance.html"><a href="covariance.html#chapter-notes-13"><i class="fa fa-check"></i><b>14.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#varying-slopes-by-construction"><i class="fa fa-check"></i>Varying Slopes by Construction</a></li>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#instruments-and-causal-designs"><i class="fa fa-check"></i>Instruments and Causal Designs</a></li>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#continuous-categories-and-the-gaussian-process"><i class="fa fa-check"></i>Continuous Categories and the Gaussian Process</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="covariance.html"><a href="covariance.html#questions-13"><i class="fa fa-check"></i><b>14.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#e1-11"><i class="fa fa-check"></i>14E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#further-resources-4"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="missing_data.html"><a href="missing_data.html"><i class="fa fa-check"></i><b>15</b> Missing Data and Other Opportunities</a>
<ul>
<li class="chapter" data-level="15.1" data-path="missing_data.html"><a href="missing_data.html#chapter-notes-14"><i class="fa fa-check"></i><b>15.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="missing_data.html"><a href="missing_data.html#measurement-error"><i class="fa fa-check"></i>Measurement Error</a></li>
<li class="chapter" data-level="" data-path="missing_data.html"><a href="missing_data.html#missing-data"><i class="fa fa-check"></i>Missing Data</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="missing_data.html"><a href="missing_data.html#questions-14"><i class="fa fa-check"></i><b>15.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="missing_data.html"><a href="missing_data.html#further-reading-8"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="generalized.html"><a href="generalized.html"><i class="fa fa-check"></i><b>16</b> Generalized Linear Madness</a>
<ul>
<li class="chapter" data-level="16.1" data-path="generalized.html"><a href="generalized.html#chapter-notes-15"><i class="fa fa-check"></i><b>16.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#geometric-people"><i class="fa fa-check"></i>Geometric People</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#hidden-minds-and-observed-behaviour"><i class="fa fa-check"></i>Hidden Minds and Observed Behaviour</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#ordinary-differential-nut-cracking"><i class="fa fa-check"></i>Ordinary Differential Nut Cracking</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#population-dynamics"><i class="fa fa-check"></i>Population Dynamics</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="generalized.html"><a href="generalized.html#questions-15"><i class="fa fa-check"></i><b>16.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#further-reading-9"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Rethinking Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="haunted_dag" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> The Haunted DAG &amp; The Causal Terror</h1>
<div id="chapter-notes-5" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Chapter Notes</h2>
<p>The chapter opens with an example of a selection effect. Assuming that journal editors and peer reviewers care about both novelty and rigour, we can expect to see a negative correlation between the two in published papers.</p>
<p>Here’s a simulation and a chart:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="haunted_dag.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1914</span>) </span>
<span id="cb118-2"><a href="haunted_dag.html#cb118-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">200</span> <span class="co"># we simulate 200 papers</span></span>
<span id="cb118-3"><a href="haunted_dag.html#cb118-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.1</span> </span>
<span id="cb118-4"><a href="haunted_dag.html#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="haunted_dag.html#cb118-5" aria-hidden="true" tabindex="-1"></a>nw <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N) <span class="co"># we create a newsworthiness figure for each paper</span></span>
<span id="cb118-6"><a href="haunted_dag.html#cb118-6" aria-hidden="true" tabindex="-1"></a>tw <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N) <span class="co"># we create a trustworthiness figure for each paper</span></span>
<span id="cb118-7"><a href="haunted_dag.html#cb118-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-8"><a href="haunted_dag.html#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="co"># note that there is no correlation between the two in the simualation</span></span>
<span id="cb118-9"><a href="haunted_dag.html#cb118-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-10"><a href="haunted_dag.html#cb118-10" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> nw <span class="sc">+</span> tw </span>
<span id="cb118-11"><a href="haunted_dag.html#cb118-11" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">quantile</span>( s , <span class="dv">1</span><span class="sc">-</span>p ) <span class="co"># the top 10% of papers are accepted</span></span>
<span id="cb118-12"><a href="haunted_dag.html#cb118-12" aria-hidden="true" tabindex="-1"></a>selected <span class="ot">&lt;-</span> <span class="fu">ifelse</span>( s <span class="sc">&gt;=</span> q , <span class="st">&quot;Yes&quot;</span> , <span class="st">&quot;No&quot;</span> ) <span class="co"># are the papers selected? i.e. published</span></span>
<span id="cb118-13"><a href="haunted_dag.html#cb118-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-14"><a href="haunted_dag.html#cb118-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-15"><a href="haunted_dag.html#cb118-15" aria-hidden="true" tabindex="-1"></a>data_pub <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Trustworthiness =</span> tw, <span class="at">Newsworthiness=</span> nw,<span class="at">Selected =</span>selected)</span>
<span id="cb118-16"><a href="haunted_dag.html#cb118-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-17"><a href="haunted_dag.html#cb118-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping=</span><span class="fu">aes</span>(Newsworthiness,Trustworthiness,<span class="at">colour=</span>Selected))<span class="sc">+</span></span>
<span id="cb118-18"><a href="haunted_dag.html#cb118-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>data_pub)<span class="sc">+</span></span>
<span id="cb118-19"><a href="haunted_dag.html#cb118-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">data=</span><span class="fu">filter</span>(data_pub,Selected<span class="sc">==</span><span class="st">&quot;Yes&quot;</span>),<span class="at">method=</span>lm,<span class="at">formula =</span><span class="st">&#39;y ~ x&#39;</span>,<span class="at">se=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>The blue line is the negative correlation between newsworthiness and trustworthiness induced by the selection process. This effect can occur inside of a multiple regression, where it is called collider bias.</p>
<div id="multicollinearity" class="section level3 unnumbered">
<h3>Multicollinearity</h3>
<p>How do multiple regression models behave when the predictor variables are highly correlated?</p>
<p>The chapter contains a simulation for the effect of leg length on height.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="haunted_dag.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">909</span>) </span>
<span id="cb119-2"><a href="haunted_dag.html#cb119-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># we have 100 people</span></span>
<span id="cb119-3"><a href="haunted_dag.html#cb119-3" aria-hidden="true" tabindex="-1"></a>height <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">10</span>,<span class="dv">2</span>) <span class="co"># we simulate their heights</span></span>
<span id="cb119-4"><a href="haunted_dag.html#cb119-4" aria-hidden="true" tabindex="-1"></a>leg_prop <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="fl">0.4</span>,<span class="fl">0.5</span>) <span class="co">#we simulate their leg length as a proportion of their height</span></span>
<span id="cb119-5"><a href="haunted_dag.html#cb119-5" aria-hidden="true" tabindex="-1"></a>leg_left <span class="ot">&lt;-</span> leg_prop<span class="sc">*</span>height <span class="sc">+</span> <span class="fu">rnorm</span>( N , <span class="dv">0</span> , <span class="fl">0.02</span> ) <span class="co"># we calculate the length of each leg using the above </span></span>
<span id="cb119-6"><a href="haunted_dag.html#cb119-6" aria-hidden="true" tabindex="-1"></a>leg_right <span class="ot">&lt;-</span> leg_prop<span class="sc">*</span>height <span class="sc">+</span> <span class="fu">rnorm</span>( N , <span class="dv">0</span> , <span class="fl">0.02</span> ) <span class="co"># making sure to include a little error</span></span>
<span id="cb119-7"><a href="haunted_dag.html#cb119-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-8"><a href="haunted_dag.html#cb119-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-9"><a href="haunted_dag.html#cb119-9" aria-hidden="true" tabindex="-1"></a>data_leg <span class="ot">&lt;-</span> <span class="fu">tibble</span>(height,leg_left,leg_right)</span>
<span id="cb119-10"><a href="haunted_dag.html#cb119-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-11"><a href="haunted_dag.html#cb119-11" aria-hidden="true" tabindex="-1"></a><span class="co"># we fit a model and plot the parameters</span></span>
<span id="cb119-12"><a href="haunted_dag.html#cb119-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-13"><a href="haunted_dag.html#cb119-13" aria-hidden="true" tabindex="-1"></a>m6_1 <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb119-14"><a href="haunted_dag.html#cb119-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb119-15"><a href="haunted_dag.html#cb119-15" aria-hidden="true" tabindex="-1"></a>    height <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb119-16"><a href="haunted_dag.html#cb119-16" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bl<span class="sc">*</span>leg_left <span class="sc">+</span> br<span class="sc">*</span>leg_right , </span>
<span id="cb119-17"><a href="haunted_dag.html#cb119-17" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">10</span> , <span class="dv">100</span> ) , </span>
<span id="cb119-18"><a href="haunted_dag.html#cb119-18" aria-hidden="true" tabindex="-1"></a>    bl <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">2</span> , <span class="dv">10</span> ) , </span>
<span id="cb119-19"><a href="haunted_dag.html#cb119-19" aria-hidden="true" tabindex="-1"></a>    br <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">2</span> , <span class="dv">10</span> ) , </span>
<span id="cb119-20"><a href="haunted_dag.html#cb119-20" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb119-21"><a href="haunted_dag.html#cb119-21" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data=</span>data_leg )</span>
<span id="cb119-22"><a href="haunted_dag.html#cb119-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-23"><a href="haunted_dag.html#cb119-23" aria-hidden="true" tabindex="-1"></a><span class="fu">gather_draws</span>(m6_1,a, bl, br, sigma) <span class="sc">%&gt;%</span></span>
<span id="cb119-24"><a href="haunted_dag.html#cb119-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(<span class="at">.width=</span><span class="fl">0.89</span>)<span class="sc">%&gt;%</span></span>
<span id="cb119-25"><a href="haunted_dag.html#cb119-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_rev</span>(.variable), <span class="at">x =</span> .value, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper), )<span class="sc">+</span></span>
<span id="cb119-26"><a href="haunted_dag.html#cb119-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointinterval</span>(<span class="at">colour =</span> <span class="st">&quot;dark grey&quot;</span>)<span class="sc">+</span></span>
<span id="cb119-27"><a href="haunted_dag.html#cb119-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;parameters&quot;</span>)</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Our simulation specified that leg length would be highly correlated with height. However, the model is very uncertain about the influence of either leg (<span class="math inline">\(b_r\)</span> and <span class="math inline">\(b_l\)</span>) on height. Why is this? The chapter contains a nice explanation. Our predictor variables are so highly correlated that it is almost as if we have only one predictor, used twice:</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;∼ \text{Normal}(\mu_i, \sigma) \\
\mu_i &amp;= \alpha + \beta_1 x_i + \beta_2 x_i
\end{aligned}
\]</span>
or</p>
<p><span class="math display">\[
\mu_i = \alpha + (\beta_1  + \beta_2 )x_i
\]</span>
There are a huge number of combinations of <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> that could produce the data.</p>
<p>Here’s the chapter:</p>
<blockquote>
<p>Recall that a multiple linear regression answers the question: <em>What is the value of knowing each predictor, after already knowing all of the other predictors?</em></p>
</blockquote>
<p>Here we sample the model parameters <span class="math inline">\(b_l\)</span> and <span class="math inline">\(b_r\)</span> and plot them and their sum. There are highly correlated, and their sum is centered on the true parameter value for regressing leg length on height.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="haunted_dag.html#cb120-1" aria-hidden="true" tabindex="-1"></a>data_leg_post <span class="ot">&lt;-</span> <span class="fu">spread_draws</span>(m6_1,br,bl) <span class="sc">%&gt;%</span></span>
<span id="cb120-2"><a href="haunted_dag.html#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">sum of bl and br</span><span class="st">`</span><span class="ot">=</span>br<span class="sc">+</span>bl)</span>
<span id="cb120-3"><a href="haunted_dag.html#cb120-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4"><a href="haunted_dag.html#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_leg_post)<span class="sc">+</span></span>
<span id="cb120-5"><a href="haunted_dag.html#cb120-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>br,<span class="at">y=</span>bl),<span class="at">col=</span><span class="st">&#39;#77AADD&#39;</span>,<span class="at">alpha=</span><span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="haunted_dag.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_leg_post)<span class="sc">+</span></span>
<span id="cb121-2"><a href="haunted_dag.html#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">sum of bl and br</span><span class="st">`</span>),<span class="at">col=</span><span class="st">&#39;#77AADD&#39;</span>,<span class="at">size=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<p>The chapter reintroduces the primate milk example from chapter 5.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="haunted_dag.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb122-2"><a href="haunted_dag.html#cb122-2" aria-hidden="true" tabindex="-1"></a>data_milk <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">&quot;data/milk.csv&quot;</span>, <span class="at">delim =</span> <span class="st">&quot;;&quot;</span>,<span class="at">col_names =</span> <span class="cn">TRUE</span>)<span class="sc">%&gt;%</span></span>
<span id="cb122-3"><a href="haunted_dag.html#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">K=</span><span class="fu">standardize</span>(kcal.per.g),</span>
<span id="cb122-4"><a href="haunted_dag.html#cb122-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">F=</span><span class="fu">standardize</span>(perc.fat),</span>
<span id="cb122-5"><a href="haunted_dag.html#cb122-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">L=</span><span class="fu">standardize</span>(perc.lactose))</span>
<span id="cb122-6"><a href="haunted_dag.html#cb122-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-7"><a href="haunted_dag.html#cb122-7" aria-hidden="true" tabindex="-1"></a><span class="co"># kcal.per.g regressed on perc.fat </span></span>
<span id="cb122-8"><a href="haunted_dag.html#cb122-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-9"><a href="haunted_dag.html#cb122-9" aria-hidden="true" tabindex="-1"></a>m6_3 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb122-10"><a href="haunted_dag.html#cb122-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb122-11"><a href="haunted_dag.html#cb122-11" aria-hidden="true" tabindex="-1"></a>    K <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ), </span>
<span id="cb122-12"><a href="haunted_dag.html#cb122-12" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bF<span class="sc">*</span>F, </span>
<span id="cb122-13"><a href="haunted_dag.html#cb122-13" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.2</span> ), </span>
<span id="cb122-14"><a href="haunted_dag.html#cb122-14" aria-hidden="true" tabindex="-1"></a>    bF <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> ), </span>
<span id="cb122-15"><a href="haunted_dag.html#cb122-15" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb122-16"><a href="haunted_dag.html#cb122-16" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data=</span>data_milk )</span>
<span id="cb122-17"><a href="haunted_dag.html#cb122-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-18"><a href="haunted_dag.html#cb122-18" aria-hidden="true" tabindex="-1"></a><span class="co"># kcal.per.g regressed on perc.lactose </span></span>
<span id="cb122-19"><a href="haunted_dag.html#cb122-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-20"><a href="haunted_dag.html#cb122-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-21"><a href="haunted_dag.html#cb122-21" aria-hidden="true" tabindex="-1"></a>m6_4 <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb122-22"><a href="haunted_dag.html#cb122-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb122-23"><a href="haunted_dag.html#cb122-23" aria-hidden="true" tabindex="-1"></a>    K <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma )</span>
<span id="cb122-24"><a href="haunted_dag.html#cb122-24" aria-hidden="true" tabindex="-1"></a>    , mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bL<span class="sc">*</span>L, </span>
<span id="cb122-25"><a href="haunted_dag.html#cb122-25" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.2</span> ), </span>
<span id="cb122-26"><a href="haunted_dag.html#cb122-26" aria-hidden="true" tabindex="-1"></a>    bL <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> ), </span>
<span id="cb122-27"><a href="haunted_dag.html#cb122-27" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb122-28"><a href="haunted_dag.html#cb122-28" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data=</span>data_milk )</span>
<span id="cb122-29"><a href="haunted_dag.html#cb122-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-30"><a href="haunted_dag.html#cb122-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-31"><a href="haunted_dag.html#cb122-31" aria-hidden="true" tabindex="-1"></a><span class="co"># kcal.per.g regressed on both </span></span>
<span id="cb122-32"><a href="haunted_dag.html#cb122-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-33"><a href="haunted_dag.html#cb122-33" aria-hidden="true" tabindex="-1"></a>m6_5 <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb122-34"><a href="haunted_dag.html#cb122-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb122-35"><a href="haunted_dag.html#cb122-35" aria-hidden="true" tabindex="-1"></a>    K <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma )</span>
<span id="cb122-36"><a href="haunted_dag.html#cb122-36" aria-hidden="true" tabindex="-1"></a>    , mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bF<span class="sc">*</span>F <span class="sc">+</span> bL<span class="sc">*</span>L, </span>
<span id="cb122-37"><a href="haunted_dag.html#cb122-37" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.2</span> ),</span>
<span id="cb122-38"><a href="haunted_dag.html#cb122-38" aria-hidden="true" tabindex="-1"></a>    bF <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> ),</span>
<span id="cb122-39"><a href="haunted_dag.html#cb122-39" aria-hidden="true" tabindex="-1"></a>    bL <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> ), </span>
<span id="cb122-40"><a href="haunted_dag.html#cb122-40" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb122-41"><a href="haunted_dag.html#cb122-41" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data=</span>data_milk )</span></code></pre></div>
<p>Here is the parameter summary for regression of kcal per gram of milk on the fat percentage of the milk:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="haunted_dag.html#cb123-1" aria-hidden="true" tabindex="-1"></a>summary_6_3 <span class="ot">&lt;-</span> m6_3<span class="sc">%&gt;%</span></span>
<span id="cb123-2"><a href="haunted_dag.html#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(a,bF,sigma)<span class="sc">%&gt;%</span></span>
<span id="cb123-3"><a href="haunted_dag.html#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_qi</span>(<span class="at">.width =</span> <span class="fl">0.89</span>)<span class="sc">%&gt;%</span></span>
<span id="cb123-4"><a href="haunted_dag.html#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model=</span><span class="st">&quot;Fat&quot;</span>)</span>
<span id="cb123-5"><a href="haunted_dag.html#cb123-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-6"><a href="haunted_dag.html#cb123-6" aria-hidden="true" tabindex="-1"></a>summary_6_3<span class="sc">%&gt;%</span></span>
<span id="cb123-7"><a href="haunted_dag.html#cb123-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 8
##   .variable   .value .lower .upper .width .point .interval model
##   &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;
## 1 a         0.000384 -0.124  0.124   0.89 mean   qi        Fat  
## 2 bF        0.861     0.725  0.999   0.89 mean   qi        Fat  
## 3 sigma     0.450     0.356  0.545   0.89 mean   qi        Fat</code></pre>
<p>And here’s the summary for the regression of kcals on lactose content:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="haunted_dag.html#cb125-1" aria-hidden="true" tabindex="-1"></a>summary_6_4 <span class="ot">&lt;-</span> m6_4<span class="sc">%&gt;%</span></span>
<span id="cb125-2"><a href="haunted_dag.html#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(a,bL,sigma)<span class="sc">%&gt;%</span></span>
<span id="cb125-3"><a href="haunted_dag.html#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_qi</span>(<span class="at">.width =</span> <span class="fl">0.89</span>)<span class="sc">%&gt;%</span></span>
<span id="cb125-4"><a href="haunted_dag.html#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model=</span><span class="st">&quot;Lactose&quot;</span>)</span>
<span id="cb125-5"><a href="haunted_dag.html#cb125-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-6"><a href="haunted_dag.html#cb125-6" aria-hidden="true" tabindex="-1"></a>summary_6_4<span class="sc">%&gt;%</span></span>
<span id="cb125-7"><a href="haunted_dag.html#cb125-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 8
##   .variable    .value .lower .upper .width .point .interval model  
##   &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;  
## 1 a         -0.000894 -0.106  0.104   0.89 mean   qi        Lactose
## 2 bL        -0.902    -1.01  -0.789   0.89 mean   qi        Lactose
## 3 sigma      0.380     0.300  0.458   0.89 mean   qi        Lactose</code></pre>
<p>The parameters are almost mirror images of each other: the more fat content of the milk the higher the calories, the higher lactose content the lower the calories. This makes sense since fat is more energy dense than carbohydrate and fat and lactose contents are negatively correlated.</p>
<p>Here’s what happens when both are included in the same model:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="haunted_dag.html#cb127-1" aria-hidden="true" tabindex="-1"></a>summary_6_5 <span class="ot">&lt;-</span> m6_5<span class="sc">%&gt;%</span></span>
<span id="cb127-2"><a href="haunted_dag.html#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(a,bF,bL,sigma)<span class="sc">%&gt;%</span></span>
<span id="cb127-3"><a href="haunted_dag.html#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_qi</span>(<span class="at">.width =</span> <span class="fl">0.89</span>)<span class="sc">%&gt;%</span></span>
<span id="cb127-4"><a href="haunted_dag.html#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model=</span><span class="st">&quot;Both&quot;</span>)</span>
<span id="cb127-5"><a href="haunted_dag.html#cb127-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-6"><a href="haunted_dag.html#cb127-6" aria-hidden="true" tabindex="-1"></a>summary_6_5<span class="sc">%&gt;%</span></span>
<span id="cb127-7"><a href="haunted_dag.html#cb127-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 8
##   .variable    .value  .lower .upper .width .point .interval model
##   &lt;chr&gt;         &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;
## 1 a          0.000589 -0.108   0.104   0.89 mean   qi        Both 
## 2 bF         0.245    -0.0567  0.541   0.89 mean   qi        Both 
## 3 bL        -0.676    -0.970  -0.386   0.89 mean   qi        Both 
## 4 sigma      0.378     0.301   0.456   0.89 mean   qi        Both</code></pre>
<p>Here’s a plot:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="haunted_dag.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(summary_6_3, summary_6_4,summary_6_5) <span class="sc">%&gt;%</span></span>
<span id="cb129-2"><a href="haunted_dag.html#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_rev</span>(.variable), <span class="at">x =</span> .value, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb129-3"><a href="haunted_dag.html#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointinterval</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="sc">-</span><span class="fl">0.3</span>))<span class="sc">+</span></span>
<span id="cb129-4"><a href="haunted_dag.html#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb129-5"><a href="haunted_dag.html#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;parameters&quot;</span>)</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Including both fat and lactose contents in the model pulls the parameter estimates <span class="math inline">\(b_F\)</span> and <span class="math inline">\(b_L\)</span> towards zero, and about doubles the uncertainty around both.</p>
<p>Here’s a pairs plot of the two variables:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="haunted_dag.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(<span class="at">data=</span><span class="fu">select</span>(data_milk,kcal.per.g,perc.fat,perc.lactose))</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>The chapter summarises:</p>
<blockquote>
<p>These two variables are negatively correlated, and so strongly so that they are nearly redundant. Either helps in predicting kcal.per.g, but neither helps as much once you already know the other…. The problem of multicollinearity is amember of a family of problems with fitting models, a family sometimes known as non-identifiability. When a parameter is non-identifiable, it means that the structure of the data and model do not make it possible to estimate the parameter’s value.</p>
</blockquote>
<p>And here’s a DAG the chapter suggests for this case. D here is how dense the milk needs to be, and is related to how frequently the species nurses. Species that nurse more often tend to have relatively more lactose and less fat in their milk.</p>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="post-treatment-bias" class="section level3 unnumbered">
<h3>Post-Treatment Bias</h3>
<p>The chapter describes bias that can result from the <em>inclusion</em> of varibels in a model that should be omitted. One example of this is post-treatment bias.</p>
<p>The case study in the chapter concerns anti-fungal soil treatments, and their effect on plant height. Plants are sprouted and their initial heights are measured. Various treatments are applied, the plants’ final heights are measured, and the presence or absence of fungus is noted.</p>
<p>The fungus should <em>not</em> be included in a model designed to estimate the effect of the anti-fungal treatment on plant height. The proposed mechanism by which anti-fungal treatment would lead to more plant growth is by killing fungus. By including the presence/absence in the model we are in effect asking “how helpful is the anti-fungal treatment, relative to some default treatment, assuming fungal growth is the same in each case.” This is not the question we need to answer. Here’s a DAG:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="haunted_dag.html#cb131-1" aria-hidden="true" tabindex="-1"></a>dag_fungus <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">&quot;dag{H_0 -&gt; H_1; F -&gt; H_1; T -&gt; F; }&quot;</span>)</span>
<span id="cb131-2"><a href="haunted_dag.html#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coordinates</span>(dag_fungus) <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">x=</span><span class="fu">c</span>(<span class="at">H_0=</span><span class="dv">0</span>,<span class="at">H_1=</span><span class="dv">1</span>, <span class="at">F=</span><span class="dv">2</span>, <span class="at">T=</span><span class="dv">3</span>) , <span class="at">y=</span><span class="fu">c</span>(<span class="at">H_0=</span><span class="dv">0</span>,<span class="at">H_1=</span><span class="dv">0</span>,<span class="at">F=</span><span class="dv">0</span>, <span class="at">T=</span><span class="dv">0</span>) )</span>
<span id="cb131-3"><a href="haunted_dag.html#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>( dag_fungus)</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Here:</p>
<ul>
<li><span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span> are initial and final heights</li>
<li><span class="math inline">\(F\)</span> is presence or absence of fungus</li>
<li><span class="math inline">\(T\)</span> is the treatment applied to the soil</li>
</ul>
<p>By including the fungus in the treatment we are blocking the causal path between treatment and final height.</p>
<p>Here’s a simulation from the chapter:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="haunted_dag.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">71</span>) </span>
<span id="cb132-2"><a href="haunted_dag.html#cb132-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#1,000 plants</span></span>
<span id="cb132-3"><a href="haunted_dag.html#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inital heights</span></span>
<span id="cb132-4"><a href="haunted_dag.html#cb132-4" aria-hidden="true" tabindex="-1"></a>h0 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">10</span>,<span class="dv">2</span>) </span>
<span id="cb132-5"><a href="haunted_dag.html#cb132-5" aria-hidden="true" tabindex="-1"></a>treatment <span class="ot">&lt;-</span> <span class="fu">rep</span>( <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span> , <span class="at">each=</span>N<span class="sc">/</span><span class="dv">2</span> ) <span class="co"># 0 is no treatment, 1 is the anti-fungal treatment</span></span>
<span id="cb132-6"><a href="haunted_dag.html#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="co">#anti-fungal treatment reduces probability of fungus</span></span>
<span id="cb132-7"><a href="haunted_dag.html#cb132-7" aria-hidden="true" tabindex="-1"></a>fungus <span class="ot">&lt;-</span> <span class="fu">rbinom</span>( N , <span class="at">size=</span><span class="dv">1</span> , <span class="at">prob=</span><span class="fl">0.5</span> <span class="sc">-</span> treatment<span class="sc">*</span><span class="fl">0.4</span>) </span>
<span id="cb132-8"><a href="haunted_dag.html#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="co"># final height depends on initial height and fungus</span></span>
<span id="cb132-9"><a href="haunted_dag.html#cb132-9" aria-hidden="true" tabindex="-1"></a>h1 <span class="ot">&lt;-</span> h0 <span class="sc">+</span> <span class="fu">rnorm</span>( N , <span class="dv">5</span> <span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>fungus) </span>
<span id="cb132-10"><a href="haunted_dag.html#cb132-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-11"><a href="haunted_dag.html#cb132-11" aria-hidden="true" tabindex="-1"></a>data_fungus <span class="ot">&lt;-</span> <span class="fu">tibble</span>( <span class="at">h0=</span>h0 , <span class="at">h1=</span>h1 , <span class="at">treatment=</span>treatment , <span class="at">fungus=</span>fungus )</span></code></pre></div>
<p>And here’s a linear model using the proportion of plant growth <span class="math inline">\(p\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
h_{1,i} &amp;\sim \text{Normal}(\mu_i,\sigma)\\
\mu_i &amp;= h_{0,i} \times p\\
p &amp;= \alpha + \beta_T T_i + \beta_F F_i \\
\alpha &amp;\sim \text{Log-Normal}(0,0.2)\\
\beta_T &amp;\sim \text{Normal}(0,0.5)\\
\beta_F &amp;\sim \text{Normal}(0,0.5) \\
\sigma &amp;=\text{Exponential}(1)
\end{aligned}
\]</span></p>
<p>And here’s the model in quap, with the parameter estimates:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="haunted_dag.html#cb133-1" aria-hidden="true" tabindex="-1"></a>m6_7 <span class="ot">&lt;-</span> <span class="fu">quap</span>( <span class="fu">alist</span>( </span>
<span id="cb133-2"><a href="haunted_dag.html#cb133-2" aria-hidden="true" tabindex="-1"></a>  h1 <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ), </span>
<span id="cb133-3"><a href="haunted_dag.html#cb133-3" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> h0 <span class="sc">*</span> p, </span>
<span id="cb133-4"><a href="haunted_dag.html#cb133-4" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> a <span class="sc">+</span> bt<span class="sc">*</span>treatment <span class="sc">+</span> bf<span class="sc">*</span>fungus, </span>
<span id="cb133-5"><a href="haunted_dag.html#cb133-5" aria-hidden="true" tabindex="-1"></a>  a <span class="sc">~</span> <span class="fu">dlnorm</span>( <span class="dv">0</span> , <span class="fl">0.2</span> ) , </span>
<span id="cb133-6"><a href="haunted_dag.html#cb133-6" aria-hidden="true" tabindex="-1"></a>  bt <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> ), </span>
<span id="cb133-7"><a href="haunted_dag.html#cb133-7" aria-hidden="true" tabindex="-1"></a>  bf <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> ), </span>
<span id="cb133-8"><a href="haunted_dag.html#cb133-8" aria-hidden="true" tabindex="-1"></a>  sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb133-9"><a href="haunted_dag.html#cb133-9" aria-hidden="true" tabindex="-1"></a>), <span class="at">data=</span>data_fungus )</span>
<span id="cb133-10"><a href="haunted_dag.html#cb133-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-11"><a href="haunted_dag.html#cb133-11" aria-hidden="true" tabindex="-1"></a>summary_6_7 <span class="ot">&lt;-</span> m6_7<span class="sc">%&gt;%</span></span>
<span id="cb133-12"><a href="haunted_dag.html#cb133-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(a,bt,bf,sigma)<span class="sc">%&gt;%</span></span>
<span id="cb133-13"><a href="haunted_dag.html#cb133-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_qi</span>(<span class="at">.width=</span><span class="fl">0.89</span>)<span class="sc">%&gt;%</span></span>
<span id="cb133-14"><a href="haunted_dag.html#cb133-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model=</span><span class="st">&quot;Including Fungus&quot;</span>)</span>
<span id="cb133-15"><a href="haunted_dag.html#cb133-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-16"><a href="haunted_dag.html#cb133-16" aria-hidden="true" tabindex="-1"></a>summary_6_7<span class="sc">%&gt;%</span></span>
<span id="cb133-17"><a href="haunted_dag.html#cb133-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 8
##   .variable   .value  .lower  .upper .width .point .interval model           
##   &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;           
## 1 a          1.48     1.46    1.49     0.89 mean   qi        Including Fungus
## 2 bf        -0.282   -0.298  -0.267    0.89 mean   qi        Including Fungus
## 3 bt         0.00238 -0.0115  0.0162   0.89 mean   qi        Including Fungus
## 4 sigma      1.30     1.25    1.35     0.89 mean   qi        Including Fungus</code></pre>
<p>The effect of the treatment, <span class="math inline">\(b_t\)</span> is very close to zero which we know from the simulation is not correct.</p>
<p>Here’s the same model, omitting fungus as a variable:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="haunted_dag.html#cb135-1" aria-hidden="true" tabindex="-1"></a>m6_8 <span class="ot">&lt;-</span> <span class="fu">quap</span>( <span class="fu">alist</span>( </span>
<span id="cb135-2"><a href="haunted_dag.html#cb135-2" aria-hidden="true" tabindex="-1"></a>  h1 <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ), </span>
<span id="cb135-3"><a href="haunted_dag.html#cb135-3" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> h0 <span class="sc">*</span> p, </span>
<span id="cb135-4"><a href="haunted_dag.html#cb135-4" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> a <span class="sc">+</span> bt<span class="sc">*</span>treatment, </span>
<span id="cb135-5"><a href="haunted_dag.html#cb135-5" aria-hidden="true" tabindex="-1"></a>  a <span class="sc">~</span> <span class="fu">dlnorm</span>( <span class="dv">0</span> , <span class="fl">0.2</span> ), </span>
<span id="cb135-6"><a href="haunted_dag.html#cb135-6" aria-hidden="true" tabindex="-1"></a>  bt <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> ), </span>
<span id="cb135-7"><a href="haunted_dag.html#cb135-7" aria-hidden="true" tabindex="-1"></a>  sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb135-8"><a href="haunted_dag.html#cb135-8" aria-hidden="true" tabindex="-1"></a>), <span class="at">data=</span>data_fungus )</span>
<span id="cb135-9"><a href="haunted_dag.html#cb135-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-10"><a href="haunted_dag.html#cb135-10" aria-hidden="true" tabindex="-1"></a>summary_6_8 <span class="ot">&lt;-</span> m6_8<span class="sc">%&gt;%</span></span>
<span id="cb135-11"><a href="haunted_dag.html#cb135-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(a,bt,sigma)<span class="sc">%&gt;%</span></span>
<span id="cb135-12"><a href="haunted_dag.html#cb135-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_qi</span>(<span class="at">.width=</span><span class="fl">0.89</span>)<span class="sc">%&gt;%</span></span>
<span id="cb135-13"><a href="haunted_dag.html#cb135-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model=</span><span class="st">&quot;Omitting Fungus&quot;</span>)</span>
<span id="cb135-14"><a href="haunted_dag.html#cb135-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-15"><a href="haunted_dag.html#cb135-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-16"><a href="haunted_dag.html#cb135-16" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(summary_6_7, summary_6_8) <span class="sc">%&gt;%</span></span>
<span id="cb135-17"><a href="haunted_dag.html#cb135-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_rev</span>(.variable), <span class="at">x =</span> .value, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb135-18"><a href="haunted_dag.html#cb135-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointinterval</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="sc">-</span><span class="fl">0.1</span>))<span class="sc">+</span></span>
<span id="cb135-19"><a href="haunted_dag.html#cb135-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb135-20"><a href="haunted_dag.html#cb135-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;parameters&quot;</span>)</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Moving from the model that includes fungus to one that omits it, the model changes from being very confident that treatment doesn’t make a difference, to being very confident that it does.</p>
<p>Let’s revisit the DAG from earlier, and look at the conditional independencies that it implies:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="haunted_dag.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">impliedConditionalIndependencies</span>(dag_fungus)</span></code></pre></div>
<pre><code>## F _||_ H_0
## H_0 _||_ T
## H_1 _||_ T | F</code></pre>
<p>The third one here means that final height is independent from treatment, conditioning on fungus.</p>
<p>This section in the chapter closes with an example where conditioning on a post-treatment variable gives the false impression that a treatment <em>does</em> work:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="haunted_dag.html#cb138-1" aria-hidden="true" tabindex="-1"></a>dag_fungus_M <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">&quot;dag{M [unobserved]; H_0 -&gt; H_1; M -&gt; H_1; M -&gt; F; T -&gt; F; }&quot;</span>)</span>
<span id="cb138-2"><a href="haunted_dag.html#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coordinates</span>(dag_fungus_M) <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">x=</span><span class="fu">c</span>(<span class="at">H_0=</span><span class="dv">0</span>,<span class="at">H_1=</span><span class="dv">1</span>,<span class="at">M=</span><span class="fl">1.5</span>, <span class="at">F=</span><span class="dv">2</span>, <span class="at">T=</span><span class="dv">3</span>) , <span class="at">y=</span><span class="fu">c</span>(<span class="at">H_0=</span><span class="dv">0</span>,<span class="at">H_1=</span><span class="dv">0</span>,<span class="at">M=</span><span class="fl">1.1</span>, <span class="at">F=</span><span class="dv">0</span>, <span class="at">T=</span><span class="dv">0</span>) )</span>
<span id="cb138-3"><a href="haunted_dag.html#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>( dag_fungus_M)</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>The unobserved variable here is moisture. In this DAG, treatment does not affect plant growth at all, but both plant growth and fungal growth are encouraged by moisture. From the chapter:</p>
<blockquote>
<p>A regression of <span class="math inline">\(H_1\)</span> on <span class="math inline">\(T\)</span> will show no association between the treatment and plant growth. But if we include <span class="math inline">\(F\)</span> in the model, suddenly there will be an association.</p>
</blockquote>
<p>This is an example of collider bias. The rest of the chapter walks through a couple of examples of collider bias, including one where a measured variable becomes a collider because of the influence of an unmeasured one.</p>
</div>
<div id="collider-bias" class="section level3 unnumbered">
<h3>Collider Bias</h3>
<p>Here are the four elemental relations that make up DAGs:</p>
<ol style="list-style-type: decimal">
<li>The Fork
<img src="06-haunted_dag_files/figure-html/unnamed-chunk-18-1.png" width="672" /></li>
</ol>
<p>In a fork, <span class="math inline">\(Z\)</span> is a common cause of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, and this creates a correlation between them. However <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent, conditional on <span class="math inline">\(Z\)</span>.</p>
<ol start="2" style="list-style-type: decimal">
<li>The Pipe
<img src="06-haunted_dag_files/figure-html/unnamed-chunk-19-1.png" width="672" /></li>
</ol>
<p>In a pipe, conditioning on <span class="math inline">\(Z\)</span> blocks the causal path between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. This is like the fungus example from earlier.</p>
<ol start="3" style="list-style-type: decimal">
<li>The Collider
<img src="06-haunted_dag_files/figure-html/unnamed-chunk-20-1.png" width="672" /></li>
</ol>
<p>In a collider, there will be no association between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, <em>unless</em> you condition on <span class="math inline">\(Z\)</span>. Think about the academic paper example from the start of the chapter.</p>
<ol start="4" style="list-style-type: decimal">
<li>The Descendant
<img src="06-haunted_dag_files/figure-html/unnamed-chunk-21-1.png" width="672" /></li>
</ol>
<p>From the chapter:</p>
<blockquote>
<p>A descendent is a variable influenced by another variable. Conditioning on a descendent partly conditions on its parent … in [this DAG], conditioning on <span class="math inline">\(D\)</span> will also condition, to a lesser extent, on <span class="math inline">\(Z\)</span>. The reason is that <span class="math inline">\(D\)</span> has some information about <span class="math inline">\(Z\)</span>. In this example, this will partially open the path from <span class="math inline">\(X\)</span> to <span class="math inline">\(Y\)</span>, because <span class="math inline">\(Z\)</span> is a collider. But in general the consequence of conditioning on a descendent depends upon the nature of its parent.</p>
</blockquote>
<p>The chapter closes with a recipe for deciding which variables to condition on, along with some practice examples:</p>
<blockquote>
<ol style="list-style-type: decimal">
<li><p>List all of the paths connecting <span class="math inline">\(X\)</span> (the potential cause of interest) and <span class="math inline">\(Y\)</span> (the outcome).</p></li>
<li><p>Classify each path by whether it is open or closed. A path is open unless it contains a collider.</p></li>
<li><p>Classify each path by whether it is a backdoor path. A backdoor path has an arrow entering <span class="math inline">\(X\)</span>.</p></li>
<li><p>If there are any open backdoor paths, decide which variable(s) to condition on to close it (if possible).</p></li>
</ol>
</blockquote>
<p>Here’s an example from the chapter:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="haunted_dag.html#cb139-1" aria-hidden="true" tabindex="-1"></a>dag_6_1 <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">&quot;dag { U [unobserved] X -&gt; Y X &lt;- U &lt;- A -&gt; C -&gt; Y U -&gt; B &lt;- C}&quot;</span>)</span>
<span id="cb139-2"><a href="haunted_dag.html#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coordinates</span>(dag_6_1) <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">x=</span><span class="fu">c</span>(<span class="at">X=</span><span class="dv">0</span>,<span class="at">U=</span><span class="dv">0</span>,<span class="at">A=</span><span class="dv">1</span>,<span class="at">B=</span><span class="dv">1</span>, <span class="at">C=</span><span class="dv">2</span>, <span class="at">Y=</span><span class="dv">2</span>) , <span class="at">y=</span><span class="fu">c</span>(<span class="at">X=</span><span class="dv">1</span>,<span class="at">U=</span><span class="fl">0.5</span>,<span class="at">A=</span><span class="fl">0.25</span>,<span class="at">B=</span><span class="fl">0.75</span>, <span class="at">C=</span><span class="fl">0.5</span>, <span class="at">Y=</span><span class="dv">1</span>) )</span>
<span id="cb139-3"><a href="haunted_dag.html#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>(dag_6_1)</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>We are interested in the causal effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>. To close the open backdoor path through <span class="math inline">\(A\)</span>, we can condition on either <span class="math inline">\(A\)</span> or <span class="math inline">\(C\)</span>. The dagitty package can tell us this:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="haunted_dag.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>( dag_6_1 , <span class="at">exposure=</span><span class="st">&quot;X&quot;</span> , <span class="at">outcome=</span><span class="st">&quot;Y&quot;</span> )</span></code></pre></div>
<pre><code>## { C }
## { A }</code></pre>
<p>We must not condition on <span class="math inline">\(B\)</span>, this would open a backdoor path that is currently closed.</p>
</div>
</div>
<div id="questions-5" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Questions</h2>
<div id="e1-4" class="section level3 unnumbered">
<h3>6E1</h3>
<div id="question-49" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>List three mechanisms by which multiple regression can produce false inferences about causal effects.</p>
</blockquote>
</div>
<div id="answer-49" class="section level4 unnumbered">
<h4>Answer</h4>
<ol style="list-style-type: decimal">
<li><p>Multicollinearity - regression on highly correlated predictors can produce misleading parameters, as in the leg, or primate milk examples.</p></li>
<li><p>Post-treatment bias - regression on post-treatment effects can make it appear that the treatment is not effective, as in the fungus example.</p></li>
<li><p>Collider bias - regression on a collider can create the appearance of an association between two variables that does not exist.</p></li>
</ol>
</div>
</div>
<div id="e3-4" class="section level3 unnumbered">
<h3>6E3</h3>
<div id="question-50" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>List the four elemental confounds. Can you explain the conditional dependencies of each?</p>
</blockquote>
</div>
<div id="answer-50" class="section level4 unnumbered">
<h4>Answer</h4>
<ol style="list-style-type: decimal">
<li>Fork - X and Y are independent, once we condition on Z.</li>
</ol>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Pipe - X and Y are independent, once we condition on Z.</li>
</ol>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Collider - Conditioning on Z creates an association between X and Y.</li>
</ol>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Descendant - Conditioning on D partly conditions on Z.</li>
</ol>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
</div>
<div id="e4-4" class="section level3 unnumbered">
<h3>6E4</h3>
<div id="question-51" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>How is a biased sample like conditioning on a collider? Think of the example at the open of the chapter.</p>
</blockquote>
</div>
<div id="answer-51" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Using the publishing example at the beginning of the chapter, we know that there is no causal relationship between trustworthiness and newsworthiness (because that’s how the simulation is constructed). However, both cause selection for publication, creating a collider. We saw that sampling only the published papers created a negative correlation between the two predictors.</p>
<p>Conditioning on publication would have the same effect - once we know newsworthiness and publication status, we can deduce some information about trustworthiness, or vice versa. For example, a study that was published but had low newsworthiness must be quite trustworthy. A study with high trustworthiness that wasn’t published is probably not very newsworthy.</p>
<p>Conditioning on the collider has the same result as only sampling from papers that were published: the creation of a spurious association.</p>
</div>
</div>
<div id="m1-3" class="section level3 unnumbered">
<h3>6M1</h3>
<div id="question-52" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Modify the DAG on page 186 to include the variable V, an unobserved cause of C and Y: C ← V→ Y. Reanalyze the DAG. How many paths connect X to Y? Which must be closed? Which variables should you condition on now?</p>
</blockquote>
</div>
<div id="answer-52" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Here’s the original DAG:</p>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>Now we add the unobserved V:</p>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>Previously, we could condition on either A or C to find the direct casual effect of X on Y. Now C is a collider, so we should condition on A.</p>
<p>The dagitty package corrobates this:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="haunted_dag.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>( dag_6M1B , <span class="at">exposure=</span><span class="st">&quot;X&quot;</span> , <span class="at">outcome=</span><span class="st">&quot;Y&quot;</span> )</span></code></pre></div>
<pre><code>## { A }</code></pre>
</div>
</div>
<div id="m2-3" class="section level3 unnumbered">
<h3>6M2</h3>
<div id="question-53" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Sometimes, in order to avoid multicollinearity, people inspect pairwise correlations among predictors before including them in a model. This is a bad procedure, because what matters is the conditional association, not the association before the variables are included in the model. To highlight this, consider the DAG X → Z → Y. Simulate data from this DAG so that the correlation between X and Z is very large. Then include both in a model predicting Y.</p>
<p>Do you observe any multicollinearity? Why or why not? What is different from the legs example in the chapter?</p>
</blockquote>
</div>
<div id="answer-53" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Modifying the leg example:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="haunted_dag.html#cb144-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb144-2"><a href="haunted_dag.html#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">909</span>) </span>
<span id="cb144-3"><a href="haunted_dag.html#cb144-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4"><a href="haunted_dag.html#cb144-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">10</span>,<span class="dv">2</span>)</span>
<span id="cb144-5"><a href="haunted_dag.html#cb144-5" aria-hidden="true" tabindex="-1"></a>Y_prop <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="fl">0.4</span>,<span class="fl">0.5</span>) </span>
<span id="cb144-6"><a href="haunted_dag.html#cb144-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-7"><a href="haunted_dag.html#cb144-7" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> Y_prop<span class="sc">*</span>Y <span class="sc">+</span> <span class="fu">rnorm</span>( N , <span class="dv">0</span> , <span class="fl">0.02</span> )</span>
<span id="cb144-8"><a href="haunted_dag.html#cb144-8" aria-hidden="true" tabindex="-1"></a>Z_prop <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="fl">0.8</span>,<span class="fl">0.9</span>) </span>
<span id="cb144-9"><a href="haunted_dag.html#cb144-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-10"><a href="haunted_dag.html#cb144-10" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="sc">-</span>Z_prop<span class="sc">*</span>Z <span class="sc">+</span> <span class="fu">rnorm</span>( N , <span class="dv">0</span> , <span class="fl">0.02</span> )</span>
<span id="cb144-11"><a href="haunted_dag.html#cb144-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-12"><a href="haunted_dag.html#cb144-12" aria-hidden="true" tabindex="-1"></a>data_6M2 <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(<span class="at">X=</span>X,<span class="at">Z=</span>Z,<span class="at">Y=</span>Y)</span>
<span id="cb144-13"><a href="haunted_dag.html#cb144-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-14"><a href="haunted_dag.html#cb144-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(data_6M2)</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="haunted_dag.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb145-2"><a href="haunted_dag.html#cb145-2" aria-hidden="true" tabindex="-1"></a>m6M2 <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb145-3"><a href="haunted_dag.html#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb145-4"><a href="haunted_dag.html#cb145-4" aria-hidden="true" tabindex="-1"></a>    Y <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb145-5"><a href="haunted_dag.html#cb145-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bX<span class="sc">*</span>X <span class="sc">+</span> bZ<span class="sc">*</span>Z , </span>
<span id="cb145-6"><a href="haunted_dag.html#cb145-6" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">10</span> , <span class="dv">100</span> ) , </span>
<span id="cb145-7"><a href="haunted_dag.html#cb145-7" aria-hidden="true" tabindex="-1"></a>    bX <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="sc">-</span><span class="dv">3</span> , <span class="dv">10</span> ) , </span>
<span id="cb145-8"><a href="haunted_dag.html#cb145-8" aria-hidden="true" tabindex="-1"></a>    bZ <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">2</span> , <span class="dv">10</span> ) , </span>
<span id="cb145-9"><a href="haunted_dag.html#cb145-9" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb145-10"><a href="haunted_dag.html#cb145-10" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data=</span>data_6M2 )</span>
<span id="cb145-11"><a href="haunted_dag.html#cb145-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-12"><a href="haunted_dag.html#cb145-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-13"><a href="haunted_dag.html#cb145-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">precis</span>(m6M2))<span class="sc">+</span></span>
<span id="cb145-14"><a href="haunted_dag.html#cb145-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">rownames</span>(<span class="fu">precis</span>(m6M2)),<span class="at">y=</span>mean,<span class="at">ymin=</span><span class="st">`</span><span class="at">5.5%</span><span class="st">`</span>,<span class="at">ymax=</span><span class="st">`</span><span class="at">94.5%</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb145-15"><a href="haunted_dag.html#cb145-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb145-16"><a href="haunted_dag.html#cb145-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;parameter&quot;</span>)<span class="sc">+</span></span>
<span id="cb145-17"><a href="haunted_dag.html#cb145-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<pre><code>## Warning in sqrt(diag(vcov(model))): NaNs produced

## Warning in sqrt(diag(vcov(model))): NaNs produced

## Warning in sqrt(diag(vcov(model))): NaNs produced

## Warning in sqrt(diag(vcov(model))): NaNs produced

## Warning in sqrt(diag(vcov(model))): NaNs produced

## Warning in sqrt(diag(vcov(model))): NaNs produced

## Warning in sqrt(diag(vcov(model))): NaNs produced

## Warning in sqrt(diag(vcov(model))): NaNs produced

## Warning in sqrt(diag(vcov(model))): NaNs produced</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_segment).</code></pre>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-31-2.png" width="672" /></p>
<p>In the legs example, the model was very uncertain about the parameter values for both legs. This is not the case here, the parameter estimate for the influence of Z is about as expected, 2-2.5. The model has correctly identified that the only influence of X on Y is through Z, and so produces parameter estimates for X much smaller than expected. We have a pipe, and including Z blocks the path from X to Y, but we don’t have the problems with identifiability that we had in the legs example.</p>
<p>There is no way to tell this scenario apart from the legs example simply from looking at the pairwise correlations.</p>
</div>
</div>
<div id="m3-3" class="section level3 unnumbered">
<h3>6M3</h3>
<div id="question-54" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Learning to analyze DAGs requires practice. For each of the four DAGs below, state which variables, if any, you must adjust for (condition on) to estimate the total causal influence of X on Y.</p>
</blockquote>
</div>
<div id="answer-54" class="section level4 unnumbered">
<h4>Answer</h4>
<ol style="list-style-type: decimal">
<li>We should condition on Z to block the backdoor path.</li>
</ol>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="haunted_dag.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>(dag_6M3<span class="fl">.1</span>)</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="haunted_dag.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>(dag_6M3<span class="fl">.1</span>,<span class="at">exposure =</span> <span class="st">&quot;X&quot;</span>,<span class="at">outcome =</span> <span class="st">&quot;Y&quot;</span>,<span class="at">effect =</span> <span class="st">&quot;total&quot;</span>)</span></code></pre></div>
<pre><code>## { Z }</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>We no longer want to condition on Z - it is a collider.</li>
</ol>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="haunted_dag.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>(dag_6M3<span class="fl">.2</span>)</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="haunted_dag.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>(dag_6M3<span class="fl">.2</span>,<span class="at">exposure =</span> <span class="st">&quot;X&quot;</span>,<span class="at">outcome =</span> <span class="st">&quot;Y&quot;</span>,<span class="at">effect =</span> <span class="st">&quot;total&quot;</span>)</span></code></pre></div>
<pre><code>##  {}</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>We no longer want to condition on Z - it is a collider.</li>
</ol>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="haunted_dag.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>(dag_6M3<span class="fl">.3</span>)</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="haunted_dag.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>(dag_6M3<span class="fl">.3</span>,<span class="at">exposure =</span> <span class="st">&quot;X&quot;</span>,<span class="at">outcome =</span> <span class="st">&quot;Y&quot;</span>,<span class="at">effect =</span> <span class="st">&quot;total&quot;</span>)</span></code></pre></div>
<pre><code>##  {}</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>We don’t want to condition on Z here because we are looking for the <em>total</em> casual influence of X on Y - one route of this influence goes through Z. We should condition on A however, to block the backdoor path.</li>
</ol>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="haunted_dag.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>(dag_6M3<span class="fl">.4</span>)</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="haunted_dag.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>(dag_6M3<span class="fl">.4</span>,<span class="at">exposure =</span> <span class="st">&quot;X&quot;</span>,<span class="at">outcome =</span> <span class="st">&quot;Y&quot;</span>,<span class="at">effect =</span> <span class="st">&quot;total&quot;</span>)</span></code></pre></div>
<pre><code>## { A }</code></pre>
</div>
</div>
<div id="h1-2" class="section level3 unnumbered">
<h3>6H1</h3>
<div id="question-55" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Use the Waffle House data to find the total causal influence of number of Waffle Houses on divorce rate. Justify your model or models with a causal graph.</p>
</blockquote>
</div>
<div id="answer-55" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Looking through the available variables, I think I want to consider the following:
* Number of Waffle Houses (W)
* Divorce rate (D)
* Whether we’re in the South (S)
* Marriage rate (M)
* Median age of marriage (A)</p>
<p>Here’s my proposed DAG:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="haunted_dag.html#cb160-1" aria-hidden="true" tabindex="-1"></a>dag_waf <span class="ot">&lt;-</span> <span class="fu">dagitty</span>( <span class="st">&quot;dag {S -&gt; W; S -&gt; M; S-&gt;A; W -&gt; D ; M -&gt; D; A -&gt; D;}&quot;</span>)</span>
<span id="cb160-2"><a href="haunted_dag.html#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coordinates</span>(dag_waf) <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">x=</span><span class="fu">c</span>(<span class="at">W=</span><span class="dv">0</span>,<span class="at">S=</span><span class="dv">1</span>,<span class="at">M=</span><span class="dv">1</span>,<span class="at">D=</span><span class="dv">1</span>,<span class="at">A=</span><span class="dv">2</span>) , <span class="at">y=</span><span class="fu">c</span>(<span class="at">S=</span><span class="dv">0</span>,<span class="at">W=</span><span class="dv">1</span>,<span class="at">M=</span><span class="dv">1</span>,<span class="at">A=</span><span class="dv">1</span>,<span class="at">D=</span><span class="dv">2</span>) )</span>
<span id="cb160-3"><a href="haunted_dag.html#cb160-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-4"><a href="haunted_dag.html#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>(dag_waf )</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="haunted_dag.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>(dag_waf,<span class="at">exposure =</span> <span class="st">&quot;W&quot;</span>,<span class="at">outcome =</span> <span class="st">&quot;D&quot;</span>,<span class="at">effect =</span> <span class="st">&quot;total&quot;</span>)</span></code></pre></div>
<pre><code>## { A, M }
## { S }</code></pre>
<p>So we need to include S in the model, to block the backdoor path through A and M.</p>
<p>After loading the data, standardising, and doing some prior simulation, I have the model below:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="haunted_dag.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb163-2"><a href="haunted_dag.html#cb163-2" aria-hidden="true" tabindex="-1"></a>m6H1 <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb163-3"><a href="haunted_dag.html#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb163-4"><a href="haunted_dag.html#cb163-4" aria-hidden="true" tabindex="-1"></a>    Divorce <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb163-5"><a href="haunted_dag.html#cb163-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a[South] <span class="sc">+</span> bW<span class="sc">*</span>WaffleHouses, </span>
<span id="cb163-6"><a href="haunted_dag.html#cb163-6" aria-hidden="true" tabindex="-1"></a>    a[South] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.6</span> ) , </span>
<span id="cb163-7"><a href="haunted_dag.html#cb163-7" aria-hidden="true" tabindex="-1"></a>    bW <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.2</span> ) , </span>
<span id="cb163-8"><a href="haunted_dag.html#cb163-8" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb163-9"><a href="haunted_dag.html#cb163-9" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data=</span>data_waf )</span>
<span id="cb163-10"><a href="haunted_dag.html#cb163-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-11"><a href="haunted_dag.html#cb163-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-12"><a href="haunted_dag.html#cb163-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">precis</span>(m6H1,<span class="at">depth =</span> <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb163-13"><a href="haunted_dag.html#cb163-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">rownames</span>(<span class="fu">precis</span>(m6H1,<span class="at">depth =</span> <span class="dv">2</span>)),<span class="at">y=</span>mean,<span class="at">ymin=</span><span class="st">`</span><span class="at">5.5%</span><span class="st">`</span>,<span class="at">ymax=</span><span class="st">`</span><span class="at">94.5%</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb163-14"><a href="haunted_dag.html#cb163-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb163-15"><a href="haunted_dag.html#cb163-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;parameter&quot;</span>)<span class="sc">+</span></span>
<span id="cb163-16"><a href="haunted_dag.html#cb163-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>This is consistent with the number of Waffle Houses having no causal effect on the divorce rate.</p>
</div>
</div>
<div id="h2-2" class="section level3 unnumbered">
<h3>6H2</h3>
<div id="question-56" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Build a series of models to test the implied conditional independencies of the causal graph you used in the previous problem. If any of the tests fail, how do you think the graph needs to be amended?</p>
<p>Does the graph need more or fewer arrows? Feel free to nominate variables that aren’t in the data.</p>
</blockquote>
</div>
<div id="answer-56" class="section level4 unnumbered">
<h4>Answer</h4>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="haunted_dag.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">impliedConditionalIndependencies</span>(dag_waf)</span></code></pre></div>
<pre><code>## A _||_ M | S
## A _||_ W | S
## D _||_ S | A, M, W
## M _||_ W | S</code></pre>
<p>We’ll first test that the divorce rate is independent of being in the South, conditional on number of waffle houses, median age of marriage, and marriage rate.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="haunted_dag.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb166-2"><a href="haunted_dag.html#cb166-2" aria-hidden="true" tabindex="-1"></a>m6H2<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb166-3"><a href="haunted_dag.html#cb166-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb166-4"><a href="haunted_dag.html#cb166-4" aria-hidden="true" tabindex="-1"></a>    Divorce <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb166-5"><a href="haunted_dag.html#cb166-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a[South] <span class="sc">+</span> bW<span class="sc">*</span>WaffleHouses <span class="sc">+</span> bM<span class="sc">*</span>Marriage <span class="sc">+</span> bA<span class="sc">*</span>MedianAgeMarriage, </span>
<span id="cb166-6"><a href="haunted_dag.html#cb166-6" aria-hidden="true" tabindex="-1"></a>    a[South] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.6</span> ) , </span>
<span id="cb166-7"><a href="haunted_dag.html#cb166-7" aria-hidden="true" tabindex="-1"></a>    bW <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.2</span> ) , </span>
<span id="cb166-8"><a href="haunted_dag.html#cb166-8" aria-hidden="true" tabindex="-1"></a>    bM <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) ,</span>
<span id="cb166-9"><a href="haunted_dag.html#cb166-9" aria-hidden="true" tabindex="-1"></a>    bA <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) ,</span>
<span id="cb166-10"><a href="haunted_dag.html#cb166-10" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb166-11"><a href="haunted_dag.html#cb166-11" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data=</span>data_waf )</span>
<span id="cb166-12"><a href="haunted_dag.html#cb166-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-13"><a href="haunted_dag.html#cb166-13" aria-hidden="true" tabindex="-1"></a>m6H2<span class="fl">.1</span>_post <span class="ot">&lt;-</span> post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m6H2<span class="fl">.1</span>)</span>
<span id="cb166-14"><a href="haunted_dag.html#cb166-14" aria-hidden="true" tabindex="-1"></a>m6H2<span class="fl">.1</span>_post<span class="sc">$</span>diff_south <span class="ot">&lt;-</span> m6H2<span class="fl">.1</span>_post<span class="sc">$</span>a[,<span class="dv">1</span>] <span class="sc">-</span> m6H2<span class="fl">.1</span>_post<span class="sc">$</span>a[,<span class="dv">2</span>]</span>
<span id="cb166-15"><a href="haunted_dag.html#cb166-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-16"><a href="haunted_dag.html#cb166-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">precis</span>( m6H2<span class="fl">.1</span>_post , <span class="at">depth=</span><span class="dv">2</span> ))<span class="sc">+</span></span>
<span id="cb166-17"><a href="haunted_dag.html#cb166-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">rownames</span>(<span class="fu">precis</span>( m6H2<span class="fl">.1</span>_post , <span class="at">depth=</span><span class="dv">2</span> )),<span class="at">y=</span>mean,<span class="at">ymin=</span><span class="st">`</span><span class="at">5.5%</span><span class="st">`</span>,<span class="at">ymax=</span><span class="st">`</span><span class="at">94.5%</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb166-18"><a href="haunted_dag.html#cb166-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb166-19"><a href="haunted_dag.html#cb166-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;parameter&quot;</span>)<span class="sc">+</span></span>
<span id="cb166-20"><a href="haunted_dag.html#cb166-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>The values of the diff_south parameter are consistent with the conditional independence, but I’m not completely happy that I’ve caught all the ways that being in the South can influence the divorce rate. Perhaps I should add an arrow directly from the South to the divorce rate, or add in an unobserved variable to stand in for cultural/ religious attitudes towards divorce.</p>
<p>We’ll test one more conditional independence, one that I think is more likely to be true. Let’s see if the median age of marriage is independent of the number of waffle houses, once we condition on being in the south.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="haunted_dag.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb167-2"><a href="haunted_dag.html#cb167-2" aria-hidden="true" tabindex="-1"></a>m6H2<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb167-3"><a href="haunted_dag.html#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb167-4"><a href="haunted_dag.html#cb167-4" aria-hidden="true" tabindex="-1"></a>    MedianAgeMarriage <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb167-5"><a href="haunted_dag.html#cb167-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a[South] <span class="sc">+</span> bW<span class="sc">*</span>WaffleHouses, </span>
<span id="cb167-6"><a href="haunted_dag.html#cb167-6" aria-hidden="true" tabindex="-1"></a>    a[South] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.6</span> ) , </span>
<span id="cb167-7"><a href="haunted_dag.html#cb167-7" aria-hidden="true" tabindex="-1"></a>    bW <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) , </span>
<span id="cb167-8"><a href="haunted_dag.html#cb167-8" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb167-9"><a href="haunted_dag.html#cb167-9" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data=</span>data_waf )</span>
<span id="cb167-10"><a href="haunted_dag.html#cb167-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-11"><a href="haunted_dag.html#cb167-11" aria-hidden="true" tabindex="-1"></a>m6H2<span class="fl">.2</span>_post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m6H2<span class="fl">.2</span>)</span>
<span id="cb167-12"><a href="haunted_dag.html#cb167-12" aria-hidden="true" tabindex="-1"></a>m6H2<span class="fl">.2</span>_post<span class="sc">$</span>diff_south <span class="ot">&lt;-</span> m6H2<span class="fl">.2</span>_post<span class="sc">$</span>a[,<span class="dv">1</span>] <span class="sc">-</span> m6H2<span class="fl">.2</span>_post<span class="sc">$</span>a[,<span class="dv">2</span>]</span>
<span id="cb167-13"><a href="haunted_dag.html#cb167-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-14"><a href="haunted_dag.html#cb167-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">precis</span>( m6H2<span class="fl">.2</span>_post , <span class="at">depth=</span><span class="dv">2</span> ))<span class="sc">+</span></span>
<span id="cb167-15"><a href="haunted_dag.html#cb167-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">rownames</span>(<span class="fu">precis</span>( m6H2<span class="fl">.2</span>_post , <span class="at">depth=</span><span class="dv">2</span> )),<span class="at">y=</span>mean,<span class="at">ymin=</span><span class="st">`</span><span class="at">5.5%</span><span class="st">`</span>,<span class="at">ymax=</span><span class="st">`</span><span class="at">94.5%</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb167-16"><a href="haunted_dag.html#cb167-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb167-17"><a href="haunted_dag.html#cb167-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;parameter&quot;</span>)<span class="sc">+</span></span>
<span id="cb167-18"><a href="haunted_dag.html#cb167-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>The parameter bW is estimated to be quite close to zero.</p>
</div>
</div>
<div id="h3-2" class="section level3 unnumbered">
<h3>6H3</h3>
<div id="question-57" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Use a model to infer the total causal influence of area on weight. Would increasing the area available to each fox make it heavier (healthier)?</p>
<p>You might want to standardize the variables. Regardless, use prior predictive simulation to show that your model’s prior predictions stay within the possible outcome range.</p>
</blockquote>
</div>
<div id="answer-57" class="section level4 unnumbered">
<h4>Answer</h4>
<p>We don’t need to condition on any other parameters since we’re looking for the total causal effect.</p>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<pre><code>##  {}</code></pre>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-43-2.png" width="672" /></p>
<p>Unexpectedly, the total causal impact of area on weight appears to be zero, or slightly negative. Increasing area would not make foxes heavier.</p>
</div>
</div>
<div id="h4-2" class="section level3 unnumbered">
<h3>6H4</h3>
<div id="question-58" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Now infer the causal impact of adding food to a territory. Would this make foxes heavier? Which covariates do you need to adjust for to estimate the total causal influence of food?</p>
</blockquote>
</div>
<div id="answer-58" class="section level4 unnumbered">
<h4>Answer</h4>
<p>We don’t need to condition on any other parameters assuming the DAG we’re given is correct.</p>
<pre><code>##  {}</code></pre>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>The total causal impact of food on weight again appears to be negative. Increasing food would not make foxes heavier.</p>
</div>
</div>
<div id="h5-1" class="section level3 unnumbered">
<h3>6H5</h3>
<div id="question-59" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Now infer the causal impact of group size. Which covariates do you need to adjust for? Looking at the posterior distribution of the resulting model, what do you think explains these data? That is, can you explain the estimates for all three problems? How do they go together?</p>
</blockquote>
</div>
<div id="answer-59" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Now we have to condition on food to block the backdoor path.</p>
<pre><code>## { F }</code></pre>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p>We see that the causal impact of group size is negative, and that the direct effect of food is zero or slightly positive. It is at least not so negative as the total causal effect.</p>
<p>I’d suggest that what’s happening here is that the main effect of an increase in food (either directly or by an increase in area) would be to increase group size, which has a detrimental effect on weight. This effect seems to overwhelm any direct effect of increasing food on weight.</p>
</div>
</div>
</div>
<div id="further-reading-5" class="section level2 unnumbered">
<h2>Further Reading</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="many_variables.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ulysses.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/06-haunted_dag.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
