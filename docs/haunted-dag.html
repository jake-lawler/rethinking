<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 The Haunted DAG &amp; The Causal Terror | Statistical Rethinking Notes</title>
  <meta name="description" content="My notes on Richard McElreath’s ‘Statistical Rethinking.’" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 The Haunted DAG &amp; The Causal Terror | Statistical Rethinking Notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="My notes on Richard McElreath’s ‘Statistical Rethinking.’" />
  <meta name="github-repo" content="jake-lawler/rethinking" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 The Haunted DAG &amp; The Causal Terror | Statistical Rethinking Notes" />
  
  <meta name="twitter:description" content="My notes on Richard McElreath’s ‘Statistical Rethinking.’" />
  

<meta name="author" content="Jake Lawler" />


<meta name="date" content="2021-04-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="many-variables.html"/>
<link rel="next" href="ulysses.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="prague.html"><a href="prague.html"><i class="fa fa-check"></i><b>1</b> The Golem of Prague</a>
<ul>
<li class="chapter" data-level="1.1" data-path="prague.html"><a href="prague.html#chapter-notes"><i class="fa fa-check"></i><b>1.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="1.2" data-path="prague.html"><a href="prague.html#questions"><i class="fa fa-check"></i><b>1.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="prague.html"><a href="prague.html#further-reading"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="small-worlds.html"><a href="small-worlds.html"><i class="fa fa-check"></i><b>2</b> Small Worlds and Large Worlds</a>
<ul>
<li class="chapter" data-level="2.1" data-path="small-worlds.html"><a href="small-worlds.html#chapter-notes-1"><i class="fa fa-check"></i><b>2.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="2.2" data-path="small-worlds.html"><a href="small-worlds.html#questions-1"><i class="fa fa-check"></i><b>2.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="small-worlds.html"><a href="small-worlds.html#e1"><i class="fa fa-check"></i>2E1</a></li>
<li class="chapter" data-level="" data-path="small-worlds.html"><a href="small-worlds.html#e2"><i class="fa fa-check"></i>2E2</a></li>
<li class="chapter" data-level="" data-path="small-worlds.html"><a href="small-worlds.html#e3"><i class="fa fa-check"></i>2E3</a></li>
<li class="chapter" data-level="" data-path="small-worlds.html"><a href="small-worlds.html#e4"><i class="fa fa-check"></i>2E4</a></li>
<li class="chapter" data-level="" data-path="small-worlds.html"><a href="small-worlds.html#m1"><i class="fa fa-check"></i>2M1</a></li>
<li class="chapter" data-level="" data-path="small-worlds.html"><a href="small-worlds.html#m2"><i class="fa fa-check"></i>2M2</a></li>
<li class="chapter" data-level="" data-path="small-worlds.html"><a href="small-worlds.html#m3"><i class="fa fa-check"></i>2M3</a></li>
<li class="chapter" data-level="" data-path="small-worlds.html"><a href="small-worlds.html#m4"><i class="fa fa-check"></i>2M4</a></li>
<li class="chapter" data-level="" data-path="small-worlds.html"><a href="small-worlds.html#m5"><i class="fa fa-check"></i>2M5</a></li>
<li class="chapter" data-level="" data-path="small-worlds.html"><a href="small-worlds.html#m6"><i class="fa fa-check"></i>2M6</a></li>
<li class="chapter" data-level="" data-path="small-worlds.html"><a href="small-worlds.html#m7"><i class="fa fa-check"></i>2M7</a></li>
<li class="chapter" data-level="" data-path="small-worlds.html"><a href="small-worlds.html#h1"><i class="fa fa-check"></i>2H1</a></li>
<li class="chapter" data-level="" data-path="small-worlds.html"><a href="small-worlds.html#h2"><i class="fa fa-check"></i>2H2</a></li>
<li class="chapter" data-level="" data-path="small-worlds.html"><a href="small-worlds.html#h3"><i class="fa fa-check"></i>2H3</a></li>
<li class="chapter" data-level="" data-path="small-worlds.html"><a href="small-worlds.html#h4"><i class="fa fa-check"></i>2H4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="small-worlds.html"><a href="small-worlds.html#further-reading-1"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html"><i class="fa fa-check"></i><b>3</b> Sampling the Imaginary</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#chapter-notes-2"><i class="fa fa-check"></i><b>3.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="3.2" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#questions-2"><i class="fa fa-check"></i><b>3.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#e1-1"><i class="fa fa-check"></i>3E1</a></li>
<li class="chapter" data-level="" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#e2-1"><i class="fa fa-check"></i>3E2</a></li>
<li class="chapter" data-level="" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#e3-1"><i class="fa fa-check"></i>3E3</a></li>
<li class="chapter" data-level="" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#e4-1"><i class="fa fa-check"></i>3E4</a></li>
<li class="chapter" data-level="" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#e5"><i class="fa fa-check"></i>3E5</a></li>
<li class="chapter" data-level="" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#e6"><i class="fa fa-check"></i>3E6</a></li>
<li class="chapter" data-level="" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#e7"><i class="fa fa-check"></i>3E7</a></li>
<li class="chapter" data-level="" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#m1-1"><i class="fa fa-check"></i>3M1</a></li>
<li class="chapter" data-level="" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#m2-1"><i class="fa fa-check"></i>3M2</a></li>
<li class="chapter" data-level="" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#m3-1"><i class="fa fa-check"></i>3M3</a></li>
<li class="chapter" data-level="" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#m4-1"><i class="fa fa-check"></i>3M4</a></li>
<li class="chapter" data-level="" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#m5-1"><i class="fa fa-check"></i>3M5</a></li>
<li class="chapter" data-level="" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#m6-1"><i class="fa fa-check"></i>3M6</a></li>
<li class="chapter" data-level="" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#h1-1"><i class="fa fa-check"></i>3H1</a></li>
<li class="chapter" data-level="" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#h2-1"><i class="fa fa-check"></i>3H2</a></li>
<li class="chapter" data-level="" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#h3-1"><i class="fa fa-check"></i>3H3</a></li>
<li class="chapter" data-level="" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#h4-1"><i class="fa fa-check"></i>3H4</a></li>
<li class="chapter" data-level="" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#h5"><i class="fa fa-check"></i>3H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sampling-imaginary.html"><a href="sampling-imaginary.html#further-reading-2"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geocentric.html"><a href="geocentric.html"><i class="fa fa-check"></i><b>4</b> Geocentric Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="geocentric.html"><a href="geocentric.html#chapter-notes-3"><i class="fa fa-check"></i><b>4.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="4.2" data-path="geocentric.html"><a href="geocentric.html#questions-3"><i class="fa fa-check"></i><b>4.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e1-2"><i class="fa fa-check"></i>4E1</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e2-2"><i class="fa fa-check"></i>4E2</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e3-2"><i class="fa fa-check"></i>4E3</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e4-2"><i class="fa fa-check"></i>4E4</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e5-1"><i class="fa fa-check"></i>4E5</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m1-2"><i class="fa fa-check"></i>4M1</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m2-2"><i class="fa fa-check"></i>4M2</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m3-2"><i class="fa fa-check"></i>4M3</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m4-2"><i class="fa fa-check"></i>4M4</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m5-2"><i class="fa fa-check"></i>4M5</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m6-2"><i class="fa fa-check"></i>4M6</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m7-1"><i class="fa fa-check"></i>4M7</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#further-reading-3"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="many-variables.html"><a href="many-variables.html"><i class="fa fa-check"></i><b>5</b> The Many Variables &amp; The Spurious Waffles</a>
<ul>
<li class="chapter" data-level="5.1" data-path="many-variables.html"><a href="many-variables.html#chapter-notes-4"><i class="fa fa-check"></i><b>5.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="5.2" data-path="many-variables.html"><a href="many-variables.html#questions-4"><i class="fa fa-check"></i><b>5.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="many-variables.html"><a href="many-variables.html#e1-3"><i class="fa fa-check"></i>5E1</a></li>
<li class="chapter" data-level="" data-path="many-variables.html"><a href="many-variables.html#e2-3"><i class="fa fa-check"></i>5E2</a></li>
<li class="chapter" data-level="" data-path="many-variables.html"><a href="many-variables.html#e3-3"><i class="fa fa-check"></i>5E3</a></li>
<li class="chapter" data-level="" data-path="many-variables.html"><a href="many-variables.html#e4-3"><i class="fa fa-check"></i>5E4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="many-variables.html"><a href="many-variables.html#further-reading-4"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="haunted-dag.html"><a href="haunted-dag.html"><i class="fa fa-check"></i><b>6</b> The Haunted DAG &amp; The Causal Terror</a>
<ul>
<li class="chapter" data-level="6.1" data-path="haunted-dag.html"><a href="haunted-dag.html#chapter-notes-5"><i class="fa fa-check"></i><b>6.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="6.2" data-path="haunted-dag.html"><a href="haunted-dag.html#questions-5"><i class="fa fa-check"></i><b>6.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="haunted-dag.html"><a href="haunted-dag.html#e1-4"><i class="fa fa-check"></i>6E1</a></li>
<li class="chapter" data-level="" data-path="haunted-dag.html"><a href="haunted-dag.html#e3-4"><i class="fa fa-check"></i>6E3</a></li>
<li class="chapter" data-level="" data-path="haunted-dag.html"><a href="haunted-dag.html#e4-4"><i class="fa fa-check"></i>6E4</a></li>
<li class="chapter" data-level="" data-path="haunted-dag.html"><a href="haunted-dag.html#m1-3"><i class="fa fa-check"></i>6M1</a></li>
<li class="chapter" data-level="" data-path="haunted-dag.html"><a href="haunted-dag.html#m2-3"><i class="fa fa-check"></i>6M2</a></li>
<li class="chapter" data-level="" data-path="haunted-dag.html"><a href="haunted-dag.html#m3-3"><i class="fa fa-check"></i>6M3</a></li>
<li class="chapter" data-level="" data-path="haunted-dag.html"><a href="haunted-dag.html#h1-2"><i class="fa fa-check"></i>6H1</a></li>
<li class="chapter" data-level="" data-path="haunted-dag.html"><a href="haunted-dag.html#h2-2"><i class="fa fa-check"></i>6H2</a></li>
<li class="chapter" data-level="" data-path="haunted-dag.html"><a href="haunted-dag.html#h3-2"><i class="fa fa-check"></i>6H3</a></li>
<li class="chapter" data-level="" data-path="haunted-dag.html"><a href="haunted-dag.html#h4-2"><i class="fa fa-check"></i>6H4</a></li>
<li class="chapter" data-level="" data-path="haunted-dag.html"><a href="haunted-dag.html#h5-1"><i class="fa fa-check"></i>6H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="haunted-dag.html"><a href="haunted-dag.html#further-reading-5"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ulysses.html"><a href="ulysses.html"><i class="fa fa-check"></i><b>7</b> Ulysses’ Compass</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ulysses.html"><a href="ulysses.html#chapter-notes-6"><i class="fa fa-check"></i><b>7.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#brain-volume-model"><i class="fa fa-check"></i>Brain Volume model</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#log-pointwise-predictive-density"><i class="fa fa-check"></i>Log Pointwise Predictive Density</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#simulating-in-and-out-of-sample-deviance-for-varying-parameter-numbers"><i class="fa fa-check"></i>Simulating in and out of sample deviance for varying parameter numbers</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ulysses.html"><a href="ulysses.html#questions-6"><i class="fa fa-check"></i><b>7.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e1-5"><i class="fa fa-check"></i>7E1</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e2-4"><i class="fa fa-check"></i>7E2</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e3-5"><i class="fa fa-check"></i>7E3</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e4-5"><i class="fa fa-check"></i>7E4</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m1-4"><i class="fa fa-check"></i>7M1</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m2-4"><i class="fa fa-check"></i>7M2</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m3-4"><i class="fa fa-check"></i>7M3</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m4-3"><i class="fa fa-check"></i>7M4</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m5-3"><i class="fa fa-check"></i>7M5</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m6-3"><i class="fa fa-check"></i>7M6</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h1-3"><i class="fa fa-check"></i>7H1</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h2-3"><i class="fa fa-check"></i>7H2</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h3-3"><i class="fa fa-check"></i>7H3</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h4-3"><i class="fa fa-check"></i>7H4</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h5-2"><i class="fa fa-check"></i>7H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#further-reading-6"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="conditional.html"><a href="conditional.html"><i class="fa fa-check"></i><b>8</b> Conditional Manatees</a>
<ul>
<li class="chapter" data-level="8.1" data-path="conditional.html"><a href="conditional.html#chapter-notes-7"><i class="fa fa-check"></i><b>8.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#ruggedness-gdp-model"><i class="fa fa-check"></i>Ruggedness &amp; GDP Model</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="conditional.html"><a href="conditional.html#questions-7"><i class="fa fa-check"></i><b>8.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#e1-6"><i class="fa fa-check"></i>8E1</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#e2-5"><i class="fa fa-check"></i>8E2</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#e3-6"><i class="fa fa-check"></i>8E3</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#m1-5"><i class="fa fa-check"></i>8M1</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#m2-5"><i class="fa fa-check"></i>8M2</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#m3-5"><i class="fa fa-check"></i>8M3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="markov-chain.html"><a href="markov-chain.html"><i class="fa fa-check"></i><b>9</b> Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="markov-chain.html"><a href="markov-chain.html#chapter-notes-8"><i class="fa fa-check"></i><b>9.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="markov-chain.html"><a href="markov-chain.html#simulating-king-markovs-journey-a-metropolis-algorithm"><i class="fa fa-check"></i>Simulating King Markov’s Journey (A Metropolis Algorithm)</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="markov-chain.html"><a href="markov-chain.html#questions-8"><i class="fa fa-check"></i><b>9.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="markov-chain.html"><a href="markov-chain.html#e1-7"><i class="fa fa-check"></i>9E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chain.html"><a href="markov-chain.html#further-reading-7"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="big-entropy.html"><a href="big-entropy.html"><i class="fa fa-check"></i><b>10</b> Big Entropy and the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="10.1" data-path="big-entropy.html"><a href="big-entropy.html#chapter-notes-9"><i class="fa fa-check"></i><b>10.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="big-entropy.html"><a href="big-entropy.html#maximum-entropy"><i class="fa fa-check"></i>Maximum Entropy</a></li>
<li class="chapter" data-level="" data-path="big-entropy.html"><a href="big-entropy.html#generalized-linear-models"><i class="fa fa-check"></i>Generalized Linear Models</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="big-entropy.html"><a href="big-entropy.html#questions-9"><i class="fa fa-check"></i><b>10.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="big-entropy.html"><a href="big-entropy.html#further-resources"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="god-spiked.html"><a href="god-spiked.html"><i class="fa fa-check"></i><b>11</b> God Spiked the Integers</a>
<ul>
<li class="chapter" data-level="11.1" data-path="god-spiked.html"><a href="god-spiked.html#chapter-notes-10"><i class="fa fa-check"></i><b>11.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#binomial-regression"><i class="fa fa-check"></i>Binomial Regression</a></li>
<li class="chapter" data-level="11.1.1" data-path="god-spiked.html"><a href="god-spiked.html#poisson-regression"><i class="fa fa-check"></i><b>11.1.1</b> Poisson Regression</a></li>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#multinomial-and-categorical-models"><i class="fa fa-check"></i>Multinomial and Categorical Models</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="god-spiked.html"><a href="god-spiked.html#questions-10"><i class="fa fa-check"></i><b>11.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#e1-8"><i class="fa fa-check"></i>11E1</a></li>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#e2-6"><i class="fa fa-check"></i>11E2</a></li>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#e3-7"><i class="fa fa-check"></i>11E3</a></li>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#e4-6"><i class="fa fa-check"></i>11E4</a></li>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#m1-6"><i class="fa fa-check"></i>11M1</a></li>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#m2-6"><i class="fa fa-check"></i>11M2</a></li>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#m3-6"><i class="fa fa-check"></i>11M3</a></li>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#m4-4"><i class="fa fa-check"></i>11M4</a></li>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#m5-4"><i class="fa fa-check"></i>11M5</a></li>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#m6-4"><i class="fa fa-check"></i>11M6</a></li>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#m7-2"><i class="fa fa-check"></i>11M7</a></li>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#m8"><i class="fa fa-check"></i>11M8</a></li>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#h1-4"><i class="fa fa-check"></i>11H1</a></li>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#h2-4"><i class="fa fa-check"></i>11H2</a></li>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#h3-4"><i class="fa fa-check"></i>11H3</a></li>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#h4-4"><i class="fa fa-check"></i>11H4</a></li>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#h5-3"><i class="fa fa-check"></i>11H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="god-spiked.html"><a href="god-spiked.html#further-resources-1"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="monsters-mixtures.html"><a href="monsters-mixtures.html"><i class="fa fa-check"></i><b>12</b> Monsters and Mixtures</a>
<ul>
<li class="chapter" data-level="12.1" data-path="monsters-mixtures.html"><a href="monsters-mixtures.html#chapter-notes-11"><i class="fa fa-check"></i><b>12.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="monsters-mixtures.html"><a href="monsters-mixtures.html#over-dispersed-counts"><i class="fa fa-check"></i>Over-Dispersed Counts</a></li>
<li class="chapter" data-level="" data-path="monsters-mixtures.html"><a href="monsters-mixtures.html#zero-inflated-outcomes"><i class="fa fa-check"></i>Zero-Inflated Outcomes</a></li>
<li class="chapter" data-level="" data-path="monsters-mixtures.html"><a href="monsters-mixtures.html#ordered-categorical-outcomes"><i class="fa fa-check"></i>Ordered Categorical Outcomes</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="monsters-mixtures.html"><a href="monsters-mixtures.html#questions-11"><i class="fa fa-check"></i><b>12.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="monsters-mixtures.html"><a href="monsters-mixtures.html#e1-9"><i class="fa fa-check"></i>12E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="monsters-mixtures.html"><a href="monsters-mixtures.html#further-resources-2"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="models-memory.html"><a href="models-memory.html"><i class="fa fa-check"></i><b>13</b> Models With Memory</a>
<ul>
<li class="chapter" data-level="13.1" data-path="models-memory.html"><a href="models-memory.html#chapter-notes-12"><i class="fa fa-check"></i><b>13.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="models-memory.html"><a href="models-memory.html#more-than-one-type-of-cluster"><i class="fa fa-check"></i>More Than One Type of Cluster</a></li>
<li class="chapter" data-level="" data-path="models-memory.html"><a href="models-memory.html#divergent-transitions-and-non-centered-priors"><i class="fa fa-check"></i>Divergent Transitions and Non-Centered Priors</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="models-memory.html"><a href="models-memory.html#questions-12"><i class="fa fa-check"></i><b>13.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="models-memory.html"><a href="models-memory.html#e1-10"><i class="fa fa-check"></i>13E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="models-memory.html"><a href="models-memory.html#further-resources-3"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="covariance.html"><a href="covariance.html"><i class="fa fa-check"></i><b>14</b> Adventures in Covariance</a>
<ul>
<li class="chapter" data-level="14.1" data-path="covariance.html"><a href="covariance.html#chapter-notes-13"><i class="fa fa-check"></i><b>14.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#varying-slopes-by-construction"><i class="fa fa-check"></i>Varying Slopes by Construction</a></li>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#instruments-and-causal-designs"><i class="fa fa-check"></i>Instruments and Causal Designs</a></li>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#continuous-categories-and-the-gaussian-process"><i class="fa fa-check"></i>Continuous Categories and the Gaussian Process</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="covariance.html"><a href="covariance.html#questions-13"><i class="fa fa-check"></i><b>14.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#e1-11"><i class="fa fa-check"></i>14E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#further-resources-4"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i><b>15</b> Missing Data and Other Opportunities</a>
<ul>
<li class="chapter" data-level="15.1" data-path="missing-data.html"><a href="missing-data.html#chapter-notes-14"><i class="fa fa-check"></i><b>15.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="missing-data.html"><a href="missing-data.html#measurement-error"><i class="fa fa-check"></i>Measurement Error</a></li>
<li class="chapter" data-level="" data-path="missing-data.html"><a href="missing-data.html#missing-data"><i class="fa fa-check"></i>Missing Data</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="missing-data.html"><a href="missing-data.html#questions-14"><i class="fa fa-check"></i><b>15.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="missing-data.html"><a href="missing-data.html#further-reading-8"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="generalized.html"><a href="generalized.html"><i class="fa fa-check"></i><b>16</b> Generalized Linear Madness</a>
<ul>
<li class="chapter" data-level="16.1" data-path="generalized.html"><a href="generalized.html#chapter-notes-15"><i class="fa fa-check"></i><b>16.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#geometric-people"><i class="fa fa-check"></i>Geometric People</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#hidden-minds-and-observed-behaviour"><i class="fa fa-check"></i>Hidden Minds and Observed Behaviour</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#ordinary-differential-nut-cracking"><i class="fa fa-check"></i>Ordinary Differential Nut Cracking</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#population-dynamics"><i class="fa fa-check"></i>Population Dynamics</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="generalized.html"><a href="generalized.html#questions-15"><i class="fa fa-check"></i><b>16.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#further-reading-9"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Rethinking Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="haunted_dag" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> The Haunted DAG &amp; The Causal Terror</h1>
<div id="chapter-notes-5" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Chapter Notes</h2>
<p>Figure 6.1 Selection Bias</p>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Parameters estimates for effect of leg length on height.</p>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Figure 6.2 Posterior of height~leg Model</p>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-4-1.png" width="672" /><img src="06-haunted_dag_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<p>Figure 6.3</p>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Primate Milk DAG</p>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Simulating Colliinearity</p>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-8-1.png" width="672" /><img src="06-haunted_dag_files/figure-html/unnamed-chunk-8-2.png" width="672" /><img src="06-haunted_dag_files/figure-html/unnamed-chunk-8-3.png" width="672" /></p>
<p>Here’s my very rough attempt at explaining to myself why conditioning on fungus makes treatment appear to have a small positive effect.</p>
<p>If fungus is present we may have:</p>
<ul>
<li>treatment present and moisture present</li>
<li>treatment absent and moisture either way (leaning towards present)</li>
</ul>
<p>If fungus is absent we may have:</p>
<ul>
<li>treatment absent and moisture absent</li>
<li>treatment present and moisture either way (leaning towards absent)</li>
</ul>
<p>So once we know fungus there is a weak positive correlation between treatment and moisture. Since moisture is good for plant growth, this means a positive relationship between treatment and growth.</p>
</div>
<div id="questions-5" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Questions</h2>
<div id="e1-4" class="section level3 unnumbered">
<h3>6E1</h3>
<div id="question-49" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>List three mechanisms by which multiple regression can produce false inferences about causal effects.</p>
</blockquote>
</div>
<div id="answer-49" class="section level4 unnumbered">
<h4>Answer</h4>
<ol style="list-style-type: decimal">
<li><p>Multicollinearity - regression on highly correlated predictors can produce misleading parameters, as in the leg, or primate milk examples.</p></li>
<li><p>Post-treatment bias - regression on post-treatment effects can make it appear that the treatment is not effective, as in the fungus example.</p></li>
<li><p>Collider bias - regression on a collider can create the appearance of an association between two variables that does not exist.</p></li>
</ol>
</div>
</div>
<div id="e3-4" class="section level3 unnumbered">
<h3>6E3</h3>
<div id="question-50" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>List the four elemental confounds. Can you explain the conditional dependencies of each?</p>
</blockquote>
</div>
<div id="answer-50" class="section level4 unnumbered">
<h4>Answer</h4>
<ol style="list-style-type: decimal">
<li>Fork - X and Y are independent, once we condition on Z.</li>
</ol>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Pipe - X and Y are independent, once we condition on Z.</li>
</ol>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Collider - Conditioning on Z creates an association between X and Y.</li>
</ol>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Descendant - Conditioning on D partly conditions on Z.</li>
</ol>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
</div>
<div id="e4-4" class="section level3 unnumbered">
<h3>6E4</h3>
<div id="question-51" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>How is a biased sample like conditioning on a collider? Think of the example at the open of the chapter.</p>
</blockquote>
</div>
<div id="answer-51" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Using the publishing example at the beginning of the chapter, we know that there is no causal relationship between trustworthiness and newsworthiness (because that’s how the simulation is constructed). However, both cause selection for publication, creating a collider. We saw that sampling only the published papers created a negative correlation between the two predictors.</p>
<p>Conditioning on publication would have the same effect - once we know newsworthiness and publication status, we can deduce some information about trustworthiness, or vice versa. For example, a study that was published but had low newsworthiness must be quite trustworthy. A study with high trustworthiness that wasn’t published is probably not very newsworthy.</p>
<p>Conditioning on the collider has the same result as only sampling from papers that were published: the creation of a spurious association.</p>
</div>
</div>
<div id="m1-3" class="section level3 unnumbered">
<h3>6M1</h3>
<div id="question-52" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Modify the DAG on page 186 to include the variable V, an unobserved cause of C and Y: C ← V→ Y. Reanalyze the DAG. How many paths connect X to Y? Which must be closed? Which variables should you condition on now?</p>
</blockquote>
</div>
<div id="answer-52" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Here’s the original DAG:</p>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Now we add the unobserved V:</p>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Previously, we could condition on either A or C to find the direct casual effect of X on Y. Now C is a collider, so we should condition on A.</p>
<p>The dagitty package corrobates this:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="haunted-dag.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>( dag_6M1B , <span class="at">exposure=</span><span class="st">&quot;X&quot;</span> , <span class="at">outcome=</span><span class="st">&quot;Y&quot;</span> )</span></code></pre></div>
<pre><code>## { A }</code></pre>
</div>
</div>
<div id="m2-3" class="section level3 unnumbered">
<h3>6M2</h3>
<div id="question-53" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Sometimes, in order to avoid multicollinearity, people inspect pairwise correlations among predictors before including them in a model. This is a bad procedure, because what matters is the conditional association, not the association before the variables are included in the model. To highlight this, consider the DAG X → Z → Y. Simulate data from this DAG so that the correlation between X and Z is very large. Then include both in a model predicting Y.</p>
<p>Do you observe any multicollinearity? Why or why not? What is different from the legs example in the chapter?</p>
</blockquote>
</div>
<div id="answer-53" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Modifying the leg example:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="haunted-dag.html#cb51-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb51-2"><a href="haunted-dag.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">909</span>) </span>
<span id="cb51-3"><a href="haunted-dag.html#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="haunted-dag.html#cb51-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">10</span>,<span class="dv">2</span>)</span>
<span id="cb51-5"><a href="haunted-dag.html#cb51-5" aria-hidden="true" tabindex="-1"></a>Y_prop <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="fl">0.4</span>,<span class="fl">0.5</span>) </span>
<span id="cb51-6"><a href="haunted-dag.html#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="haunted-dag.html#cb51-7" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> Y_prop<span class="sc">*</span>Y <span class="sc">+</span> <span class="fu">rnorm</span>( N , <span class="dv">0</span> , <span class="fl">0.02</span> )</span>
<span id="cb51-8"><a href="haunted-dag.html#cb51-8" aria-hidden="true" tabindex="-1"></a>Z_prop <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="fl">0.8</span>,<span class="fl">0.9</span>) </span>
<span id="cb51-9"><a href="haunted-dag.html#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="haunted-dag.html#cb51-10" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="sc">-</span>Z_prop<span class="sc">*</span>Z <span class="sc">+</span> <span class="fu">rnorm</span>( N , <span class="dv">0</span> , <span class="fl">0.02</span> )</span>
<span id="cb51-11"><a href="haunted-dag.html#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="haunted-dag.html#cb51-12" aria-hidden="true" tabindex="-1"></a>data_6M2 <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(<span class="at">X=</span>X,<span class="at">Z=</span>Z,<span class="at">Y=</span>Y)</span>
<span id="cb51-13"><a href="haunted-dag.html#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="haunted-dag.html#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(data_6M2)</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="haunted-dag.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb52-2"><a href="haunted-dag.html#cb52-2" aria-hidden="true" tabindex="-1"></a>m6M2 <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb52-3"><a href="haunted-dag.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb52-4"><a href="haunted-dag.html#cb52-4" aria-hidden="true" tabindex="-1"></a>    Y <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb52-5"><a href="haunted-dag.html#cb52-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bX<span class="sc">*</span>X <span class="sc">+</span> bZ<span class="sc">*</span>Z , </span>
<span id="cb52-6"><a href="haunted-dag.html#cb52-6" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">10</span> , <span class="dv">100</span> ) , </span>
<span id="cb52-7"><a href="haunted-dag.html#cb52-7" aria-hidden="true" tabindex="-1"></a>    bX <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="sc">-</span><span class="dv">3</span> , <span class="dv">10</span> ) , </span>
<span id="cb52-8"><a href="haunted-dag.html#cb52-8" aria-hidden="true" tabindex="-1"></a>    bZ <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">2</span> , <span class="dv">10</span> ) , </span>
<span id="cb52-9"><a href="haunted-dag.html#cb52-9" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb52-10"><a href="haunted-dag.html#cb52-10" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data=</span>data_6M2 )</span>
<span id="cb52-11"><a href="haunted-dag.html#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="haunted-dag.html#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="haunted-dag.html#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">precis</span>(m6M2))<span class="sc">+</span></span>
<span id="cb52-14"><a href="haunted-dag.html#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">rownames</span>(<span class="fu">precis</span>(m6M2)),<span class="at">y=</span>mean,<span class="at">ymin=</span><span class="st">`</span><span class="at">5.5%</span><span class="st">`</span>,<span class="at">ymax=</span><span class="st">`</span><span class="at">94.5%</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb52-15"><a href="haunted-dag.html#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb52-16"><a href="haunted-dag.html#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;parameter&quot;</span>)<span class="sc">+</span></span>
<span id="cb52-17"><a href="haunted-dag.html#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<pre><code>## Warning in sqrt(diag(vcov(model))): NaNs produced

## Warning in sqrt(diag(vcov(model))): NaNs produced

## Warning in sqrt(diag(vcov(model))): NaNs produced

## Warning in sqrt(diag(vcov(model))): NaNs produced

## Warning in sqrt(diag(vcov(model))): NaNs produced

## Warning in sqrt(diag(vcov(model))): NaNs produced

## Warning in sqrt(diag(vcov(model))): NaNs produced

## Warning in sqrt(diag(vcov(model))): NaNs produced

## Warning in sqrt(diag(vcov(model))): NaNs produced</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_segment).</code></pre>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-16-2.png" width="672" /></p>
<p>In the legs example, the model was very uncertain about the parameter values for both legs. This is not the case here, the parameter estimate for the influence of Z is about as expected, 2-2.5. The model has correctly identified that the only influence of X on Y is through Z, and so produces parameter estimates for X much smaller than expected. We have a pipe, and including Z blocks the path from X to Y, but we don’t have the problems with identifiability that we had in the legs example.</p>
<p>There is no way to tell this scenario apart from the legs example simply from looking at the pairwise correlations.</p>
</div>
</div>
<div id="m3-3" class="section level3 unnumbered">
<h3>6M3</h3>
<div id="question-54" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Learning to analyze DAGs requires practice. For each of the four DAGs below, state which variables, if any, you must adjust for (condition on) to estimate the total causal influence of X on Y.</p>
</blockquote>
</div>
<div id="answer-54" class="section level4 unnumbered">
<h4>Answer</h4>
<ol style="list-style-type: decimal">
<li>We should condition on Z to block the backdoor path.</li>
</ol>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="haunted-dag.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>(dag_6M3<span class="fl">.1</span>)</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="haunted-dag.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>(dag_6M3<span class="fl">.1</span>,<span class="at">exposure =</span> <span class="st">&quot;X&quot;</span>,<span class="at">outcome =</span> <span class="st">&quot;Y&quot;</span>,<span class="at">effect =</span> <span class="st">&quot;total&quot;</span>)</span></code></pre></div>
<pre><code>## { Z }</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>We no longer want to condition on Z - it is a collider.</li>
</ol>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="haunted-dag.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>(dag_6M3<span class="fl">.2</span>)</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="haunted-dag.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>(dag_6M3<span class="fl">.2</span>,<span class="at">exposure =</span> <span class="st">&quot;X&quot;</span>,<span class="at">outcome =</span> <span class="st">&quot;Y&quot;</span>,<span class="at">effect =</span> <span class="st">&quot;total&quot;</span>)</span></code></pre></div>
<pre><code>##  {}</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>We no longer want to condition on Z - it is a collider.</li>
</ol>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="haunted-dag.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>(dag_6M3<span class="fl">.3</span>)</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="haunted-dag.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>(dag_6M3<span class="fl">.3</span>,<span class="at">exposure =</span> <span class="st">&quot;X&quot;</span>,<span class="at">outcome =</span> <span class="st">&quot;Y&quot;</span>,<span class="at">effect =</span> <span class="st">&quot;total&quot;</span>)</span></code></pre></div>
<pre><code>##  {}</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>We don’t want to condition on Z here because we are looking for the <em>total</em> casual influence of X on Y - one route of this influence goes through Z. We should condition on A however, to block the backdoor path.</li>
</ol>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="haunted-dag.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>(dag_6M3<span class="fl">.4</span>)</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="haunted-dag.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>(dag_6M3<span class="fl">.4</span>,<span class="at">exposure =</span> <span class="st">&quot;X&quot;</span>,<span class="at">outcome =</span> <span class="st">&quot;Y&quot;</span>,<span class="at">effect =</span> <span class="st">&quot;total&quot;</span>)</span></code></pre></div>
<pre><code>## { A }</code></pre>
</div>
</div>
<div id="h1-2" class="section level3 unnumbered">
<h3>6H1</h3>
<div id="question-55" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Use the Waffle House data to find the total causal influence of number of Waffle Houses on divorce rate. Justify your model or models with a causal graph.</p>
</blockquote>
</div>
<div id="answer-55" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Looking through the available variables, I think I want to consider the following:
* Number of Waffle Houses (W)
* Divorce rate (D)
* Whether we’re in the South (S)
* Marriage rate (M)
* Median age of marriage (A)</p>
<p>Here’s my proposed DAG:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="haunted-dag.html#cb67-1" aria-hidden="true" tabindex="-1"></a>dag_waf <span class="ot">&lt;-</span> <span class="fu">dagitty</span>( <span class="st">&quot;dag {S -&gt; W; S -&gt; M; S-&gt;A; W -&gt; D ; M -&gt; D; A -&gt; D;}&quot;</span>)</span>
<span id="cb67-2"><a href="haunted-dag.html#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coordinates</span>(dag_waf) <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">x=</span><span class="fu">c</span>(<span class="at">W=</span><span class="dv">0</span>,<span class="at">S=</span><span class="dv">1</span>,<span class="at">M=</span><span class="dv">1</span>,<span class="at">D=</span><span class="dv">1</span>,<span class="at">A=</span><span class="dv">2</span>) , <span class="at">y=</span><span class="fu">c</span>(<span class="at">S=</span><span class="dv">0</span>,<span class="at">W=</span><span class="dv">1</span>,<span class="at">M=</span><span class="dv">1</span>,<span class="at">A=</span><span class="dv">1</span>,<span class="at">D=</span><span class="dv">2</span>) )</span>
<span id="cb67-3"><a href="haunted-dag.html#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="haunted-dag.html#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>(dag_waf )</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="haunted-dag.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>(dag_waf,<span class="at">exposure =</span> <span class="st">&quot;W&quot;</span>,<span class="at">outcome =</span> <span class="st">&quot;D&quot;</span>,<span class="at">effect =</span> <span class="st">&quot;total&quot;</span>)</span></code></pre></div>
<pre><code>## { A, M }
## { S }</code></pre>
<p>So we need to include S in the model, to block the backdoor path through A and M.</p>
<p>After loading the data, standardising, and doing some prior simulation, I have the model below:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="haunted-dag.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb70-2"><a href="haunted-dag.html#cb70-2" aria-hidden="true" tabindex="-1"></a>m6H1 <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb70-3"><a href="haunted-dag.html#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb70-4"><a href="haunted-dag.html#cb70-4" aria-hidden="true" tabindex="-1"></a>    Divorce <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb70-5"><a href="haunted-dag.html#cb70-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a[South] <span class="sc">+</span> bW<span class="sc">*</span>WaffleHouses, </span>
<span id="cb70-6"><a href="haunted-dag.html#cb70-6" aria-hidden="true" tabindex="-1"></a>    a[South] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.6</span> ) , </span>
<span id="cb70-7"><a href="haunted-dag.html#cb70-7" aria-hidden="true" tabindex="-1"></a>    bW <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.2</span> ) , </span>
<span id="cb70-8"><a href="haunted-dag.html#cb70-8" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb70-9"><a href="haunted-dag.html#cb70-9" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data=</span>data_waf )</span>
<span id="cb70-10"><a href="haunted-dag.html#cb70-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-11"><a href="haunted-dag.html#cb70-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-12"><a href="haunted-dag.html#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">precis</span>(m6H1,<span class="at">depth =</span> <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb70-13"><a href="haunted-dag.html#cb70-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">rownames</span>(<span class="fu">precis</span>(m6H1,<span class="at">depth =</span> <span class="dv">2</span>)),<span class="at">y=</span>mean,<span class="at">ymin=</span><span class="st">`</span><span class="at">5.5%</span><span class="st">`</span>,<span class="at">ymax=</span><span class="st">`</span><span class="at">94.5%</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb70-14"><a href="haunted-dag.html#cb70-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb70-15"><a href="haunted-dag.html#cb70-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;parameter&quot;</span>)<span class="sc">+</span></span>
<span id="cb70-16"><a href="haunted-dag.html#cb70-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>This is consistent with the number of Waffle Houses having no causal effect on the divorce rate.</p>
</div>
</div>
<div id="h2-2" class="section level3 unnumbered">
<h3>6H2</h3>
<div id="question-56" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Build a series of models to test the implied conditional independencies of the causal graph you used in the previous problem. If any of the tests fail, how do you think the graph needs to be amended?</p>
<p>Does the graph need more or fewer arrows? Feel free to nominate variables that aren’t in the data.</p>
</blockquote>
</div>
<div id="answer-56" class="section level4 unnumbered">
<h4>Answer</h4>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="haunted-dag.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">impliedConditionalIndependencies</span>(dag_waf)</span></code></pre></div>
<pre><code>## A _||_ M | S
## A _||_ W | S
## D _||_ S | A, M, W
## M _||_ W | S</code></pre>
<p>We’ll first test that the divorce rate is independent of being in the South, conditional on number of waffle houses, median age of marriage, and marriage rate.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="haunted-dag.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb73-2"><a href="haunted-dag.html#cb73-2" aria-hidden="true" tabindex="-1"></a>m6H2<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb73-3"><a href="haunted-dag.html#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb73-4"><a href="haunted-dag.html#cb73-4" aria-hidden="true" tabindex="-1"></a>    Divorce <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb73-5"><a href="haunted-dag.html#cb73-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a[South] <span class="sc">+</span> bW<span class="sc">*</span>WaffleHouses <span class="sc">+</span> bM<span class="sc">*</span>Marriage <span class="sc">+</span> bA<span class="sc">*</span>MedianAgeMarriage, </span>
<span id="cb73-6"><a href="haunted-dag.html#cb73-6" aria-hidden="true" tabindex="-1"></a>    a[South] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.6</span> ) , </span>
<span id="cb73-7"><a href="haunted-dag.html#cb73-7" aria-hidden="true" tabindex="-1"></a>    bW <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.2</span> ) , </span>
<span id="cb73-8"><a href="haunted-dag.html#cb73-8" aria-hidden="true" tabindex="-1"></a>    bM <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) ,</span>
<span id="cb73-9"><a href="haunted-dag.html#cb73-9" aria-hidden="true" tabindex="-1"></a>    bA <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) ,</span>
<span id="cb73-10"><a href="haunted-dag.html#cb73-10" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb73-11"><a href="haunted-dag.html#cb73-11" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data=</span>data_waf )</span>
<span id="cb73-12"><a href="haunted-dag.html#cb73-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-13"><a href="haunted-dag.html#cb73-13" aria-hidden="true" tabindex="-1"></a>m6H2<span class="fl">.1</span>_post <span class="ot">&lt;-</span> post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m6H2<span class="fl">.1</span>)</span>
<span id="cb73-14"><a href="haunted-dag.html#cb73-14" aria-hidden="true" tabindex="-1"></a>m6H2<span class="fl">.1</span>_post<span class="sc">$</span>diff_south <span class="ot">&lt;-</span> m6H2<span class="fl">.1</span>_post<span class="sc">$</span>a[,<span class="dv">1</span>] <span class="sc">-</span> m6H2<span class="fl">.1</span>_post<span class="sc">$</span>a[,<span class="dv">2</span>]</span>
<span id="cb73-15"><a href="haunted-dag.html#cb73-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-16"><a href="haunted-dag.html#cb73-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">precis</span>( m6H2<span class="fl">.1</span>_post , <span class="at">depth=</span><span class="dv">2</span> ))<span class="sc">+</span></span>
<span id="cb73-17"><a href="haunted-dag.html#cb73-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">rownames</span>(<span class="fu">precis</span>( m6H2<span class="fl">.1</span>_post , <span class="at">depth=</span><span class="dv">2</span> )),<span class="at">y=</span>mean,<span class="at">ymin=</span><span class="st">`</span><span class="at">5.5%</span><span class="st">`</span>,<span class="at">ymax=</span><span class="st">`</span><span class="at">94.5%</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb73-18"><a href="haunted-dag.html#cb73-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb73-19"><a href="haunted-dag.html#cb73-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;parameter&quot;</span>)<span class="sc">+</span></span>
<span id="cb73-20"><a href="haunted-dag.html#cb73-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>The values of the diff_south parameter are consistent with the conditional independence, but I’m not completely happy that I’ve caught all the ways that being in the South can influence the divorce rate. Perhaps I should add an arrow directly from the South to the divorce rate, or add in an unobserved variable to stand in for cultural/ religious attitudes towards divorce.</p>
<p>We’ll test one more conditional independence, one that I think is more likely to be true. Let’s see if the median age of marriage is independent of the number of waffle houses, once we condition on being in the south.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="haunted-dag.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb74-2"><a href="haunted-dag.html#cb74-2" aria-hidden="true" tabindex="-1"></a>m6H2<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb74-3"><a href="haunted-dag.html#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb74-4"><a href="haunted-dag.html#cb74-4" aria-hidden="true" tabindex="-1"></a>    MedianAgeMarriage <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb74-5"><a href="haunted-dag.html#cb74-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a[South] <span class="sc">+</span> bW<span class="sc">*</span>WaffleHouses, </span>
<span id="cb74-6"><a href="haunted-dag.html#cb74-6" aria-hidden="true" tabindex="-1"></a>    a[South] <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.6</span> ) , </span>
<span id="cb74-7"><a href="haunted-dag.html#cb74-7" aria-hidden="true" tabindex="-1"></a>    bW <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="dv">1</span> ) , </span>
<span id="cb74-8"><a href="haunted-dag.html#cb74-8" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb74-9"><a href="haunted-dag.html#cb74-9" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data=</span>data_waf )</span>
<span id="cb74-10"><a href="haunted-dag.html#cb74-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-11"><a href="haunted-dag.html#cb74-11" aria-hidden="true" tabindex="-1"></a>m6H2<span class="fl">.2</span>_post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m6H2<span class="fl">.2</span>)</span>
<span id="cb74-12"><a href="haunted-dag.html#cb74-12" aria-hidden="true" tabindex="-1"></a>m6H2<span class="fl">.2</span>_post<span class="sc">$</span>diff_south <span class="ot">&lt;-</span> m6H2<span class="fl">.2</span>_post<span class="sc">$</span>a[,<span class="dv">1</span>] <span class="sc">-</span> m6H2<span class="fl">.2</span>_post<span class="sc">$</span>a[,<span class="dv">2</span>]</span>
<span id="cb74-13"><a href="haunted-dag.html#cb74-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-14"><a href="haunted-dag.html#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">precis</span>( m6H2<span class="fl">.2</span>_post , <span class="at">depth=</span><span class="dv">2</span> ))<span class="sc">+</span></span>
<span id="cb74-15"><a href="haunted-dag.html#cb74-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">rownames</span>(<span class="fu">precis</span>( m6H2<span class="fl">.2</span>_post , <span class="at">depth=</span><span class="dv">2</span> )),<span class="at">y=</span>mean,<span class="at">ymin=</span><span class="st">`</span><span class="at">5.5%</span><span class="st">`</span>,<span class="at">ymax=</span><span class="st">`</span><span class="at">94.5%</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb74-16"><a href="haunted-dag.html#cb74-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb74-17"><a href="haunted-dag.html#cb74-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;parameter&quot;</span>)<span class="sc">+</span></span>
<span id="cb74-18"><a href="haunted-dag.html#cb74-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>The parameter bW is estimated to be quite close to zero.</p>
</div>
</div>
<div id="h3-2" class="section level3 unnumbered">
<h3>6H3</h3>
<div id="question-57" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Use a model to infer the total causal influence of area on weight. Would increasing the area available to each fox make it heavier (healthier)?</p>
<p>You might want to standardize the variables. Regardless, use prior predictive simulation to show that your model’s prior predictions stay within the possible outcome range.</p>
</blockquote>
</div>
<div id="answer-57" class="section level4 unnumbered">
<h4>Answer</h4>
<p>We don’t need to condition on any other parameters since we’re looking for the total causal effect.</p>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<pre><code>##  {}</code></pre>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-28-2.png" width="672" /></p>
<p>Unexpectedly, the total causal impact of area on weight appears to be zero, or slightly negative. Increasing area would not make foxes heavier.</p>
</div>
</div>
<div id="h4-2" class="section level3 unnumbered">
<h3>6H4</h3>
<div id="question-58" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Now infer the causal impact of adding food to a territory. Would this make foxes heavier? Which covariates do you need to adjust for to estimate the total causal influence of food?</p>
</blockquote>
</div>
<div id="answer-58" class="section level4 unnumbered">
<h4>Answer</h4>
<p>We don’t need to condition on any other parameters assuming the DAG we’re given is correct.</p>
<pre><code>##  {}</code></pre>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>The total causal impact of food on weight again appears to be negative. Increasing food would not make foxes heavier.</p>
</div>
</div>
<div id="h5-1" class="section level3 unnumbered">
<h3>6H5</h3>
<div id="question-59" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Now infer the causal impact of group size. Which covariates do you need to adjust for? Looking at the posterior distribution of the resulting model, what do you think explains these data? That is, can you explain the estimates for all three problems? How do they go together?</p>
</blockquote>
</div>
<div id="answer-59" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Now we have to condition on food to block the backdoor path.</p>
<pre><code>## { F }</code></pre>
<p><img src="06-haunted_dag_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p>We see that the causal impact of group size is negative, and that the direct effect of food is zero or slightly positive. It is at least not so negative as the total causal effect.</p>
<p>I’d suggest that what’s happening here is that the main effect of an increase in food (either directly or by an increase in area) would be to increase group size, which has a detrimental effect on weight. This effect seems to overwhelm any direct effect of increasing food on weight.</p>
</div>
</div>
</div>
<div id="further-reading-5" class="section level2 unnumbered">
<h2>Further Reading</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="many-variables.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ulysses.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/06-haunted_dag.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
