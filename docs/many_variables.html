<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 The Many Variables &amp; The Spurious Waffles | Statistical Rethinking Notes</title>
  <meta name="description" content="My notes on Richard McElreath’s ‘Statistical Rethinking.’" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 The Many Variables &amp; The Spurious Waffles | Statistical Rethinking Notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="My notes on Richard McElreath’s ‘Statistical Rethinking.’" />
  <meta name="github-repo" content="jake-lawler/rethinking" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 The Many Variables &amp; The Spurious Waffles | Statistical Rethinking Notes" />
  
  <meta name="twitter:description" content="My notes on Richard McElreath’s ‘Statistical Rethinking.’" />
  

<meta name="author" content="Jake Lawler" />


<meta name="date" content="2022-02-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="geocentric.html"/>
<link rel="next" href="haunted_dag.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="prague.html"><a href="prague.html"><i class="fa fa-check"></i><b>1</b> The Golem of Prague</a>
<ul>
<li class="chapter" data-level="1.1" data-path="prague.html"><a href="prague.html#chapter-notes"><i class="fa fa-check"></i><b>1.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="1.2" data-path="prague.html"><a href="prague.html#questions"><i class="fa fa-check"></i><b>1.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="prague.html"><a href="prague.html#further-reading"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="small_worlds.html"><a href="small_worlds.html"><i class="fa fa-check"></i><b>2</b> Small Worlds and Large Worlds</a>
<ul>
<li class="chapter" data-level="2.1" data-path="small_worlds.html"><a href="small_worlds.html#chapter-notes-1"><i class="fa fa-check"></i><b>2.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="2.2" data-path="small_worlds.html"><a href="small_worlds.html#questions-1"><i class="fa fa-check"></i><b>2.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e1"><i class="fa fa-check"></i>2E1</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e2"><i class="fa fa-check"></i>2E2</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e3"><i class="fa fa-check"></i>2E3</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#e4"><i class="fa fa-check"></i>2E4</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m1"><i class="fa fa-check"></i>2M1</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m2"><i class="fa fa-check"></i>2M2</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m3"><i class="fa fa-check"></i>2M3</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m4"><i class="fa fa-check"></i>2M4</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m5"><i class="fa fa-check"></i>2M5</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m6"><i class="fa fa-check"></i>2M6</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#m7"><i class="fa fa-check"></i>2M7</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h1"><i class="fa fa-check"></i>2H1</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h2"><i class="fa fa-check"></i>2H2</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h3"><i class="fa fa-check"></i>2H3</a></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#h4"><i class="fa fa-check"></i>2H4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="small_worlds.html"><a href="small_worlds.html#further-reading-1"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html"><i class="fa fa-check"></i><b>3</b> Sampling the Imaginary</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#chapter-notes-2"><i class="fa fa-check"></i><b>3.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="3.2" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#questions-2"><i class="fa fa-check"></i><b>3.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e1-1"><i class="fa fa-check"></i>3E1</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e2-1"><i class="fa fa-check"></i>3E2</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e3-1"><i class="fa fa-check"></i>3E3</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e4-1"><i class="fa fa-check"></i>3E4</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e5"><i class="fa fa-check"></i>3E5</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e6"><i class="fa fa-check"></i>3E6</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#e7"><i class="fa fa-check"></i>3E7</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m1-1"><i class="fa fa-check"></i>3M1</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m2-1"><i class="fa fa-check"></i>3M2</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m3-1"><i class="fa fa-check"></i>3M3</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m4-1"><i class="fa fa-check"></i>3M4</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m5-1"><i class="fa fa-check"></i>3M5</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#m6-1"><i class="fa fa-check"></i>3M6</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h1-1"><i class="fa fa-check"></i>3H1</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h2-1"><i class="fa fa-check"></i>3H2</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h3-1"><i class="fa fa-check"></i>3H3</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h4-1"><i class="fa fa-check"></i>3H4</a></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#h5"><i class="fa fa-check"></i>3H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sampling_imaginary.html"><a href="sampling_imaginary.html#further-reading-2"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geocentric.html"><a href="geocentric.html"><i class="fa fa-check"></i><b>4</b> Geocentric Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="geocentric.html"><a href="geocentric.html#chapter-notes-3"><i class="fa fa-check"></i><b>4.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="geocentric.html"><a href="geocentric.html#model-using-grid-approximation"><i class="fa fa-check"></i><b>4.1.1</b> Model Using Grid Approximation</a></li>
<li class="chapter" data-level="4.1.2" data-path="geocentric.html"><a href="geocentric.html#model-using-quadratic-approximation"><i class="fa fa-check"></i><b>4.1.2</b> Model Using Quadratic Approximation</a></li>
<li class="chapter" data-level="4.1.3" data-path="geocentric.html"><a href="geocentric.html#adding-predictors"><i class="fa fa-check"></i><b>4.1.3</b> Adding Predictors</a></li>
<li class="chapter" data-level="4.1.4" data-path="geocentric.html"><a href="geocentric.html#polynomial-regression"><i class="fa fa-check"></i><b>4.1.4</b> Polynomial Regression</a></li>
<li class="chapter" data-level="4.1.5" data-path="geocentric.html"><a href="geocentric.html#b-splines"><i class="fa fa-check"></i><b>4.1.5</b> B-Splines</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="geocentric.html"><a href="geocentric.html#questions-3"><i class="fa fa-check"></i><b>4.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e1-2"><i class="fa fa-check"></i>4E1</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e2-2"><i class="fa fa-check"></i>4E2</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e3-2"><i class="fa fa-check"></i>4E3</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e4-2"><i class="fa fa-check"></i>4E4</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#e5-1"><i class="fa fa-check"></i>4E5</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m1-2"><i class="fa fa-check"></i>4M1</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m2-2"><i class="fa fa-check"></i>4M2</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m3-2"><i class="fa fa-check"></i>4M3</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m4-2"><i class="fa fa-check"></i>4M4</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m5-2"><i class="fa fa-check"></i>4M5</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m6-2"><i class="fa fa-check"></i>4M6</a></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#m7-1"><i class="fa fa-check"></i>4M7</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="geocentric.html"><a href="geocentric.html#further-reading-3"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="many_variables.html"><a href="many_variables.html"><i class="fa fa-check"></i><b>5</b> The Many Variables &amp; The Spurious Waffles</a>
<ul>
<li class="chapter" data-level="5.1" data-path="many_variables.html"><a href="many_variables.html#chapter-notes-4"><i class="fa fa-check"></i><b>5.1</b> Chapter Notes</a></li>
<li class="chapter" data-level="5.2" data-path="many_variables.html"><a href="many_variables.html#questions-4"><i class="fa fa-check"></i><b>5.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e1-3"><i class="fa fa-check"></i>5E1</a></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e2-3"><i class="fa fa-check"></i>5E2</a></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e3-3"><i class="fa fa-check"></i>5E3</a></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#e4-3"><i class="fa fa-check"></i>5E4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="many_variables.html"><a href="many_variables.html#further-reading-4"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="haunted_dag.html"><a href="haunted_dag.html"><i class="fa fa-check"></i><b>6</b> The Haunted DAG &amp; The Causal Terror</a>
<ul>
<li class="chapter" data-level="6.1" data-path="haunted_dag.html"><a href="haunted_dag.html#chapter-notes-5"><i class="fa fa-check"></i><b>6.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#multicollinearity"><i class="fa fa-check"></i>Multicollinearity</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#post-treatment-bias"><i class="fa fa-check"></i>Post-Treatment Bias</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#collider-bias"><i class="fa fa-check"></i>Collider Bias</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="haunted_dag.html"><a href="haunted_dag.html#questions-5"><i class="fa fa-check"></i><b>6.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#e1-4"><i class="fa fa-check"></i>6E1</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#e3-4"><i class="fa fa-check"></i>6E3</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#e4-4"><i class="fa fa-check"></i>6E4</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#m1-3"><i class="fa fa-check"></i>6M1</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#m2-3"><i class="fa fa-check"></i>6M2</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#m3-3"><i class="fa fa-check"></i>6M3</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h1-2"><i class="fa fa-check"></i>6H1</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h2-2"><i class="fa fa-check"></i>6H2</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h3-2"><i class="fa fa-check"></i>6H3</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h4-2"><i class="fa fa-check"></i>6H4</a></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#h5-1"><i class="fa fa-check"></i>6H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="haunted_dag.html"><a href="haunted_dag.html#further-reading-5"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ulysses.html"><a href="ulysses.html"><i class="fa fa-check"></i><b>7</b> Ulysses’ Compass</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ulysses.html"><a href="ulysses.html#chapter-notes-6"><i class="fa fa-check"></i><b>7.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#brain-volume-model"><i class="fa fa-check"></i>Brain Volume model</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#log-pointwise-predictive-density"><i class="fa fa-check"></i>Log Pointwise Predictive Density</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#simulating-in-and-out-of-sample-deviance-for-varying-parameter-numbers"><i class="fa fa-check"></i>Simulating in and out of sample deviance for varying parameter numbers</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#predicting-predicitve-accuracy"><i class="fa fa-check"></i>Predicting Predicitve Accuracy</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ulysses.html"><a href="ulysses.html#questions-6"><i class="fa fa-check"></i><b>7.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e1-5"><i class="fa fa-check"></i>7E1</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e2-4"><i class="fa fa-check"></i>7E2</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e3-5"><i class="fa fa-check"></i>7E3</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#e4-5"><i class="fa fa-check"></i>7E4</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m1-4"><i class="fa fa-check"></i>7M1</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m2-4"><i class="fa fa-check"></i>7M2</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m3-4"><i class="fa fa-check"></i>7M3</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m4-3"><i class="fa fa-check"></i>7M4</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m5-3"><i class="fa fa-check"></i>7M5</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#m6-3"><i class="fa fa-check"></i>7M6</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h1-3"><i class="fa fa-check"></i>7H1</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h2-3"><i class="fa fa-check"></i>7H2</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h3-3"><i class="fa fa-check"></i>7H3</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h4-3"><i class="fa fa-check"></i>7H4</a></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#h5-2"><i class="fa fa-check"></i>7H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ulysses.html"><a href="ulysses.html#further-reading-6"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="conditional.html"><a href="conditional.html"><i class="fa fa-check"></i><b>8</b> Conditional Manatees</a>
<ul>
<li class="chapter" data-level="8.1" data-path="conditional.html"><a href="conditional.html#chapter-notes-7"><i class="fa fa-check"></i><b>8.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#ruggedness-gdp-model"><i class="fa fa-check"></i>Ruggedness &amp; GDP Model</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="conditional.html"><a href="conditional.html#questions-7"><i class="fa fa-check"></i><b>8.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#e1-6"><i class="fa fa-check"></i>8E1</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#e2-5"><i class="fa fa-check"></i>8E2</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#e3-6"><i class="fa fa-check"></i>8E3</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#m1-5"><i class="fa fa-check"></i>8M1</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#m2-5"><i class="fa fa-check"></i>8M2</a></li>
<li class="chapter" data-level="" data-path="conditional.html"><a href="conditional.html#m3-5"><i class="fa fa-check"></i>8M3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="markov_chain.html"><a href="markov_chain.html"><i class="fa fa-check"></i><b>9</b> Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="markov_chain.html"><a href="markov_chain.html#chapter-notes-8"><i class="fa fa-check"></i><b>9.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#simulating-king-markovs-journey-a-metropolis-algorithm"><i class="fa fa-check"></i>Simulating King Markov’s Journey (A Metropolis Algorithm)</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="markov_chain.html"><a href="markov_chain.html#questions-8"><i class="fa fa-check"></i><b>9.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#e1-7"><i class="fa fa-check"></i>9E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov_chain.html"><a href="markov_chain.html#further-reading-7"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="big_entropy.html"><a href="big_entropy.html"><i class="fa fa-check"></i><b>10</b> Big Entropy and the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="10.1" data-path="big_entropy.html"><a href="big_entropy.html#chapter-notes-9"><i class="fa fa-check"></i><b>10.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="big_entropy.html"><a href="big_entropy.html#maximum-entropy"><i class="fa fa-check"></i>Maximum Entropy</a></li>
<li class="chapter" data-level="" data-path="big_entropy.html"><a href="big_entropy.html#generalized-linear-models"><i class="fa fa-check"></i>Generalized Linear Models</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="big_entropy.html"><a href="big_entropy.html#questions-9"><i class="fa fa-check"></i><b>10.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="big_entropy.html"><a href="big_entropy.html#further-resources"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="god_spiked.html"><a href="god_spiked.html"><i class="fa fa-check"></i><b>11</b> God Spiked the Integers</a>
<ul>
<li class="chapter" data-level="11.1" data-path="god_spiked.html"><a href="god_spiked.html#chapter-notes-10"><i class="fa fa-check"></i><b>11.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#binomial-regression"><i class="fa fa-check"></i>Binomial Regression</a></li>
<li class="chapter" data-level="11.1.1" data-path="god_spiked.html"><a href="god_spiked.html#poisson-regression"><i class="fa fa-check"></i><b>11.1.1</b> Poisson Regression</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#multinomial-and-categorical-models"><i class="fa fa-check"></i>Multinomial and Categorical Models</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="god_spiked.html"><a href="god_spiked.html#questions-10"><i class="fa fa-check"></i><b>11.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e1-8"><i class="fa fa-check"></i>11E1</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e2-6"><i class="fa fa-check"></i>11E2</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e3-7"><i class="fa fa-check"></i>11E3</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#e4-6"><i class="fa fa-check"></i>11E4</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m1-6"><i class="fa fa-check"></i>11M1</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m2-6"><i class="fa fa-check"></i>11M2</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m3-6"><i class="fa fa-check"></i>11M3</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m4-4"><i class="fa fa-check"></i>11M4</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m5-4"><i class="fa fa-check"></i>11M5</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m6-4"><i class="fa fa-check"></i>11M6</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m7-2"><i class="fa fa-check"></i>11M7</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#m8"><i class="fa fa-check"></i>11M8</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h1-4"><i class="fa fa-check"></i>11H1</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h2-4"><i class="fa fa-check"></i>11H2</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h3-4"><i class="fa fa-check"></i>11H3</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h4-4"><i class="fa fa-check"></i>11H4</a></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#h5-3"><i class="fa fa-check"></i>11H5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="god_spiked.html"><a href="god_spiked.html#further-resources-1"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html"><i class="fa fa-check"></i><b>12</b> Monsters and Mixtures</a>
<ul>
<li class="chapter" data-level="12.1" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#chapter-notes-11"><i class="fa fa-check"></i><b>12.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#over-dispersed-counts"><i class="fa fa-check"></i>Over-Dispersed Counts</a></li>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#zero-inflated-outcomes"><i class="fa fa-check"></i>Zero-Inflated Outcomes</a></li>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#ordered-categorical-outcomes"><i class="fa fa-check"></i>Ordered Categorical Outcomes</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#questions-11"><i class="fa fa-check"></i><b>12.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#e1-9"><i class="fa fa-check"></i>12E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="monsters_mixtures.html"><a href="monsters_mixtures.html#further-resources-2"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="models_memory.html"><a href="models_memory.html"><i class="fa fa-check"></i><b>13</b> Models With Memory</a>
<ul>
<li class="chapter" data-level="13.1" data-path="models_memory.html"><a href="models_memory.html#chapter-notes-12"><i class="fa fa-check"></i><b>13.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#more-than-one-type-of-cluster"><i class="fa fa-check"></i>More Than One Type of Cluster</a></li>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#divergent-transitions-and-non-centered-priors"><i class="fa fa-check"></i>Divergent Transitions and Non-Centered Priors</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="models_memory.html"><a href="models_memory.html#questions-12"><i class="fa fa-check"></i><b>13.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#e1-10"><i class="fa fa-check"></i>13E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="models_memory.html"><a href="models_memory.html#further-resources-3"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="covariance.html"><a href="covariance.html"><i class="fa fa-check"></i><b>14</b> Adventures in Covariance</a>
<ul>
<li class="chapter" data-level="14.1" data-path="covariance.html"><a href="covariance.html#chapter-notes-13"><i class="fa fa-check"></i><b>14.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#varying-slopes-by-construction"><i class="fa fa-check"></i>Varying Slopes by Construction</a></li>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#instruments-and-causal-designs"><i class="fa fa-check"></i>Instruments and Causal Designs</a></li>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#continuous-categories-and-the-gaussian-process"><i class="fa fa-check"></i>Continuous Categories and the Gaussian Process</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="covariance.html"><a href="covariance.html#questions-13"><i class="fa fa-check"></i><b>14.2</b> Questions</a>
<ul>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#e1-11"><i class="fa fa-check"></i>14E1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="covariance.html"><a href="covariance.html#further-resources-4"><i class="fa fa-check"></i>Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="missing_data.html"><a href="missing_data.html"><i class="fa fa-check"></i><b>15</b> Missing Data and Other Opportunities</a>
<ul>
<li class="chapter" data-level="15.1" data-path="missing_data.html"><a href="missing_data.html#chapter-notes-14"><i class="fa fa-check"></i><b>15.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="missing_data.html"><a href="missing_data.html#measurement-error"><i class="fa fa-check"></i>Measurement Error</a></li>
<li class="chapter" data-level="" data-path="missing_data.html"><a href="missing_data.html#missing-data"><i class="fa fa-check"></i>Missing Data</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="missing_data.html"><a href="missing_data.html#questions-14"><i class="fa fa-check"></i><b>15.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="missing_data.html"><a href="missing_data.html#further-reading-8"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="generalized.html"><a href="generalized.html"><i class="fa fa-check"></i><b>16</b> Generalized Linear Madness</a>
<ul>
<li class="chapter" data-level="16.1" data-path="generalized.html"><a href="generalized.html#chapter-notes-15"><i class="fa fa-check"></i><b>16.1</b> Chapter Notes</a>
<ul>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#geometric-people"><i class="fa fa-check"></i>Geometric People</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#hidden-minds-and-observed-behaviour"><i class="fa fa-check"></i>Hidden Minds and Observed Behaviour</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#ordinary-differential-nut-cracking"><i class="fa fa-check"></i>Ordinary Differential Nut Cracking</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#population-dynamics"><i class="fa fa-check"></i>Population Dynamics</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="generalized.html"><a href="generalized.html#questions-15"><i class="fa fa-check"></i><b>16.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="generalized.html"><a href="generalized.html#further-reading-9"><i class="fa fa-check"></i>Further Reading</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Rethinking Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="many_variables" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> The Many Variables &amp; The Spurious Waffles</h1>
<div id="chapter-notes-4" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Chapter Notes</h2>
<p>This chapter introduces multiple regression and causal models. Will try to race through it, just getting some practice visualising priors, using tidybayes to display model uncertainty etc.</p>
<p>Model 5.1: Modelling divorce rate on age at marriage.</p>
<p><span class="math display">\[
\begin{aligned}
D_i &amp;\sim \text{Normal}(\mu_i, \sigma) \\
\mu_i &amp;= \alpha + \beta_A A_i \\
\alpha &amp;\sim \text{Normal}(0, 0.2) \\ 
\beta_A &amp;\sim \text{Normal}(0, 0.5) \\
\sigma &amp;\sim \text{Exponential}(1) \\
\end{aligned}
\]</span>
Here are the variables we’ll use in this model and later on:</p>
<ul>
<li><span class="math inline">\(D_i\)</span> - the 2009 divorce rate per 1,000 adults for each U.S. state.</li>
<li><span class="math inline">\(A_i\)</span> - The 2005-2010 median age at marriage for each state</li>
</ul>
<p>Plot of these priors:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="many_variables.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we generate 100 samples from our prior distributions</span></span>
<span id="cb103-2"><a href="many_variables.html#cb103-2" aria-hidden="true" tabindex="-1"></a>prior_sim_5_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">a=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd=</span><span class="fl">0.2</span>),</span>
<span id="cb103-3"><a href="many_variables.html#cb103-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">bA =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.5</span>))</span>
<span id="cb103-4"><a href="many_variables.html#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="many_variables.html#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="co"># and plot the lines they imply</span></span>
<span id="cb103-6"><a href="many_variables.html#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(prior_sim_5_1)<span class="sc">+</span></span>
<span id="cb103-7"><a href="many_variables.html#cb103-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> bA,</span>
<span id="cb103-8"><a href="many_variables.html#cb103-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">intercept =</span> a))<span class="sc">+</span></span>
<span id="cb103-9"><a href="many_variables.html#cb103-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb103-10"><a href="many_variables.html#cb103-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb103-11"><a href="many_variables.html#cb103-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Median Age of Marriage (std)&quot;</span>)<span class="sc">+</span></span>
<span id="cb103-12"><a href="many_variables.html#cb103-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Divorce Rate (std)&quot;</span>)</span></code></pre></div>
<p><img src="05-many_variables_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Here’s the model and the posterior mean/expected divorce rate:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="many_variables.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(WaffleDivorce) </span>
<span id="cb104-2"><a href="many_variables.html#cb104-2" aria-hidden="true" tabindex="-1"></a>data_divorce <span class="ot">&lt;-</span> WaffleDivorce<span class="sc">%&gt;%</span><span class="fu">as_tibble</span>()</span>
<span id="cb104-3"><a href="many_variables.html#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="many_variables.html#cb104-4" aria-hidden="true" tabindex="-1"></a>data_divorce <span class="sc">%&lt;&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb104-5"><a href="many_variables.html#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">divorce_s =</span> (Divorce <span class="sc">-</span> <span class="fu">mean</span>(Divorce))<span class="sc">/</span><span class="fu">sd</span>(Divorce),</span>
<span id="cb104-6"><a href="many_variables.html#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">marriage_s =</span> (Marriage <span class="sc">-</span> <span class="fu">mean</span>(Marriage))<span class="sc">/</span><span class="fu">sd</span>(Marriage),</span>
<span id="cb104-7"><a href="many_variables.html#cb104-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_s =</span> (MedianAgeMarriage <span class="sc">-</span> <span class="fu">mean</span>(MedianAgeMarriage))<span class="sc">/</span><span class="fu">sd</span>(MedianAgeMarriage),</span>
<span id="cb104-8"><a href="many_variables.html#cb104-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb104-9"><a href="many_variables.html#cb104-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-10"><a href="many_variables.html#cb104-10" aria-hidden="true" tabindex="-1"></a>m5_1 <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb104-11"><a href="many_variables.html#cb104-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>( </span>
<span id="cb104-12"><a href="many_variables.html#cb104-12" aria-hidden="true" tabindex="-1"></a>    divorce_s <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb104-13"><a href="many_variables.html#cb104-13" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bA <span class="sc">*</span> age_s , </span>
<span id="cb104-14"><a href="many_variables.html#cb104-14" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.2</span> ) , </span>
<span id="cb104-15"><a href="many_variables.html#cb104-15" aria-hidden="true" tabindex="-1"></a>    bA <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> ) , </span>
<span id="cb104-16"><a href="many_variables.html#cb104-16" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb104-17"><a href="many_variables.html#cb104-17" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data =</span> data_divorce )</span>
<span id="cb104-18"><a href="many_variables.html#cb104-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-19"><a href="many_variables.html#cb104-19" aria-hidden="true" tabindex="-1"></a>summary_5_1 <span class="ot">&lt;-</span> m5_1 <span class="sc">%&gt;%</span></span>
<span id="cb104-20"><a href="many_variables.html#cb104-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(a, bA, sigma) <span class="sc">%&gt;%</span></span>
<span id="cb104-21"><a href="many_variables.html#cb104-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(<span class="at">.width=</span><span class="fl">0.89</span>)<span class="sc">%&gt;%</span></span>
<span id="cb104-22"><a href="many_variables.html#cb104-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;m5_1&quot;</span>)</span>
<span id="cb104-23"><a href="many_variables.html#cb104-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-24"><a href="many_variables.html#cb104-24" aria-hidden="true" tabindex="-1"></a><span class="fu">data_grid</span>(data_divorce,<span class="at">age_s=</span><span class="fu">seq_range</span>(age_s, <span class="at">n =</span> <span class="dv">51</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb104-25"><a href="many_variables.html#cb104-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_linpred_draws</span>(m5_1) <span class="sc">%&gt;%</span> <span class="co"># add draws for mean divorce rate</span></span>
<span id="cb104-26"><a href="many_variables.html#cb104-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MedianAgeMarriage=</span> age_s <span class="sc">*</span> <span class="fu">sd</span>(data_divorce<span class="sc">$</span>MedianAgeMarriage) <span class="sc">+</span> <span class="fu">mean</span>(data_divorce<span class="sc">$</span>MedianAgeMarriage),</span>
<span id="cb104-27"><a href="many_variables.html#cb104-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">Divorce =</span> .linpred <span class="sc">*</span> <span class="fu">sd</span>(data_divorce<span class="sc">$</span>Divorce) <span class="sc">+</span> <span class="fu">mean</span>(data_divorce<span class="sc">$</span>Divorce))<span class="sc">%&gt;%</span> </span>
<span id="cb104-28"><a href="many_variables.html#cb104-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MedianAgeMarriage, <span class="at">y=</span>Divorce)) <span class="sc">+</span></span>
<span id="cb104-29"><a href="many_variables.html#cb104-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>() <span class="sc">+</span></span>
<span id="cb104-30"><a href="many_variables.html#cb104-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_divorce, <span class="at">colour =</span> <span class="st">&quot;light blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb104-31"><a href="many_variables.html#cb104-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Greys&quot;</span>)</span></code></pre></div>
<p><img src="05-many_variables_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Here’s the same plot for model 5.2 - which uses marriage rate as a predictor instead of age at marriage:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="many_variables.html#cb105-1" aria-hidden="true" tabindex="-1"></a>m5_2 <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb105-2"><a href="many_variables.html#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>( </span>
<span id="cb105-3"><a href="many_variables.html#cb105-3" aria-hidden="true" tabindex="-1"></a>    divorce_s <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb105-4"><a href="many_variables.html#cb105-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bM <span class="sc">*</span> marriage_s , </span>
<span id="cb105-5"><a href="many_variables.html#cb105-5" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.2</span> ) , </span>
<span id="cb105-6"><a href="many_variables.html#cb105-6" aria-hidden="true" tabindex="-1"></a>    bM <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> ) , </span>
<span id="cb105-7"><a href="many_variables.html#cb105-7" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb105-8"><a href="many_variables.html#cb105-8" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data =</span> data_divorce )</span>
<span id="cb105-9"><a href="many_variables.html#cb105-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-10"><a href="many_variables.html#cb105-10" aria-hidden="true" tabindex="-1"></a>summary_5_2 <span class="ot">&lt;-</span> m5_2 <span class="sc">%&gt;%</span></span>
<span id="cb105-11"><a href="many_variables.html#cb105-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(a, bM, sigma) <span class="sc">%&gt;%</span></span>
<span id="cb105-12"><a href="many_variables.html#cb105-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(<span class="at">.width=</span><span class="fl">0.89</span>)<span class="sc">%&gt;%</span></span>
<span id="cb105-13"><a href="many_variables.html#cb105-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;m5_2&quot;</span>)</span>
<span id="cb105-14"><a href="many_variables.html#cb105-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-15"><a href="many_variables.html#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="fu">data_grid</span>(data_divorce,<span class="at">marriage_s=</span><span class="fu">seq_range</span>(marriage_s, <span class="at">n =</span> <span class="dv">51</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb105-16"><a href="many_variables.html#cb105-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_linpred_draws</span>(m5_2) <span class="sc">%&gt;%</span> <span class="co"># add draws for mean divorce rate</span></span>
<span id="cb105-17"><a href="many_variables.html#cb105-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Marriage=</span> marriage_s <span class="sc">*</span> <span class="fu">sd</span>(data_divorce<span class="sc">$</span>Marriage) <span class="sc">+</span> <span class="fu">mean</span>(data_divorce<span class="sc">$</span>Marriage),</span>
<span id="cb105-18"><a href="many_variables.html#cb105-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">Divorce =</span> .linpred <span class="sc">*</span> <span class="fu">sd</span>(data_divorce<span class="sc">$</span>Divorce) <span class="sc">+</span> <span class="fu">mean</span>(data_divorce<span class="sc">$</span>Divorce))<span class="sc">%&gt;%</span> </span>
<span id="cb105-19"><a href="many_variables.html#cb105-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Marriage, <span class="at">y=</span>Divorce)) <span class="sc">+</span></span>
<span id="cb105-20"><a href="many_variables.html#cb105-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>() <span class="sc">+</span></span>
<span id="cb105-21"><a href="many_variables.html#cb105-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_divorce, <span class="at">colour =</span> <span class="st">&quot;light blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb105-22"><a href="many_variables.html#cb105-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Greys&quot;</span>)</span></code></pre></div>
<p><img src="05-many_variables_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>The chapter goes on to introduce DAGs and causal reasoning, before coming back to define a regression model that uses both marriage rate and median age at marriage as predictors.</p>
<p>Here are a couple of possible DAGs for how marriage rate and median age of marriage influence the divorce rate:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="many_variables.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, .<span class="dv">1</span>, .<span class="dv">1</span>))</span>
<span id="cb106-2"><a href="many_variables.html#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="many_variables.html#cb106-3" aria-hidden="true" tabindex="-1"></a>dag_div1 <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">&quot;dag{A -&gt; M; M -&gt; D; A -&gt; D }&quot;</span>)</span>
<span id="cb106-4"><a href="many_variables.html#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coordinates</span>(dag_div1) <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">x=</span><span class="fu">c</span>(<span class="at">A=</span><span class="dv">0</span>,<span class="at">D=</span><span class="fl">0.5</span>,<span class="at">M=</span><span class="dv">1</span>) , <span class="at">y=</span><span class="fu">c</span>(<span class="at">A=</span><span class="dv">0</span>,<span class="at">M=</span><span class="dv">0</span>,<span class="at">D=</span><span class="dv">1</span>))</span>
<span id="cb106-5"><a href="many_variables.html#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>(dag_div1)</span>
<span id="cb106-6"><a href="many_variables.html#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="many_variables.html#cb106-7" aria-hidden="true" tabindex="-1"></a>dag_div2 <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">&quot;dag{A -&gt; M; A -&gt; D }&quot;</span>)</span>
<span id="cb106-8"><a href="many_variables.html#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="fu">coordinates</span>(dag_div2) <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">x=</span><span class="fu">c</span>(<span class="at">A=</span><span class="dv">0</span>,<span class="at">D=</span><span class="fl">0.5</span>,<span class="at">M=</span><span class="dv">1</span>) , <span class="at">y=</span><span class="fu">c</span>(<span class="at">A=</span><span class="dv">0</span>,<span class="at">M=</span><span class="dv">0</span>,<span class="at">D=</span><span class="dv">1</span>))</span>
<span id="cb106-9"><a href="many_variables.html#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="fu">drawdag</span>(dag_div2)</span></code></pre></div>
<p><img src="05-many_variables_files/figure-html/figures-side-1.png" width="50%" /><img src="05-many_variables_files/figure-html/figures-side-2.png" width="50%" /></p>
<p>We can use our data to test these proposed causal models, because they make different predictions. The first has no conditional independencies:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="many_variables.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">impliedConditionalIndependencies</span>(dag_div1)</span></code></pre></div>
<p>The second predicts that D is independent from M, conditional on A:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="many_variables.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">impliedConditionalIndependencies</span>(dag_div2)</span></code></pre></div>
<pre><code>## D _||_ M | A</code></pre>
<p>Here’s our statistical model:</p>
<p><span class="math display">\[
\begin{aligned}
D_i &amp;\sim \text{Normal}(\mu_i, \sigma) \\
\mu_i &amp;= \alpha + \beta_M M_i + \beta_A A_i \\
\alpha &amp;\sim \text{Normal}(0, 0.2) \\ 
\beta_M &amp;\sim \text{Normal}(0, 0.5) \\
\beta_A &amp;\sim \text{Normal}(0, 0.5) \\
\sigma &amp;\sim \text{Exponential}(1) \\
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="many_variables.html#cb110-1" aria-hidden="true" tabindex="-1"></a>m5_3 <span class="ot">&lt;-</span> <span class="fu">quap</span>( </span>
<span id="cb110-2"><a href="many_variables.html#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>( </span>
<span id="cb110-3"><a href="many_variables.html#cb110-3" aria-hidden="true" tabindex="-1"></a>    divorce_s <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) , </span>
<span id="cb110-4"><a href="many_variables.html#cb110-4" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bM <span class="sc">*</span> marriage_s <span class="sc">+</span> bA <span class="sc">*</span> age_s , </span>
<span id="cb110-5"><a href="many_variables.html#cb110-5" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.2</span> ) , </span>
<span id="cb110-6"><a href="many_variables.html#cb110-6" aria-hidden="true" tabindex="-1"></a>    bM <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> ) ,</span>
<span id="cb110-7"><a href="many_variables.html#cb110-7" aria-hidden="true" tabindex="-1"></a>    bA <span class="sc">~</span> <span class="fu">dnorm</span>( <span class="dv">0</span> , <span class="fl">0.5</span> ) , </span>
<span id="cb110-8"><a href="many_variables.html#cb110-8" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>( <span class="dv">1</span> )</span>
<span id="cb110-9"><a href="many_variables.html#cb110-9" aria-hidden="true" tabindex="-1"></a>) , <span class="at">data =</span> data_divorce )</span>
<span id="cb110-10"><a href="many_variables.html#cb110-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-11"><a href="many_variables.html#cb110-11" aria-hidden="true" tabindex="-1"></a>summary_5_3 <span class="ot">&lt;-</span> m5_3 <span class="sc">%&gt;%</span></span>
<span id="cb110-12"><a href="many_variables.html#cb110-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_draws</span>(a, bM, bA, sigma) <span class="sc">%&gt;%</span></span>
<span id="cb110-13"><a href="many_variables.html#cb110-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(<span class="at">.width=</span><span class="fl">0.89</span>)<span class="sc">%&gt;%</span></span>
<span id="cb110-14"><a href="many_variables.html#cb110-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;m5_3&quot;</span>)</span>
<span id="cb110-15"><a href="many_variables.html#cb110-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-16"><a href="many_variables.html#cb110-16" aria-hidden="true" tabindex="-1"></a>summary_5_3<span class="sc">%&gt;%</span></span>
<span id="cb110-17"><a href="many_variables.html#cb110-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 8
##   .variable   .value .lower .upper .width .point .interval model
##   &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;
## 1 a         -0.00261 -0.155  0.152   0.89 median qi        m5_3 
## 2 bA        -0.615   -0.855 -0.370   0.89 median qi        m5_3 
## 3 bM        -0.0628  -0.313  0.178   0.89 median qi        m5_3 
## 4 sigma      0.786    0.663  0.909   0.89 median qi        m5_3</code></pre>
<p>Here’s a plot for the three models:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="many_variables.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(summary_5_1, summary_5_2,summary_5_3) <span class="sc">%&gt;%</span></span>
<span id="cb112-2"><a href="many_variables.html#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_rev</span>(.variable), <span class="at">x =</span> .value, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb112-3"><a href="many_variables.html#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointinterval</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="sc">-</span><span class="fl">0.3</span>))<span class="sc">+</span></span>
<span id="cb112-4"><a href="many_variables.html#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;parameters&quot;</span>)</span></code></pre></div>
<p><img src="05-many_variables_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>As predicted by the second DAG, marriage rate is not associated with divorce rate once you condition on age of marriage.</p>
<p>The chapter then describes three plots to help visualise inferences from more complicated models then the simple one predictor models from chapter 4.</p>
<ol style="list-style-type: decimal">
<li>Predictor residual plots</li>
<li>Posterior prediction plots</li>
<li>Counterfactual plots</li>
</ol>
<p>For now I’ll only recreate the posterior prediction plot.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="many_variables.html#cb113-1" aria-hidden="true" tabindex="-1"></a>plot_data_m5_3 <span class="ot">&lt;-</span> data_divorce<span class="sc">%&gt;%</span></span>
<span id="cb113-2"><a href="many_variables.html#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Loc, divorce_s, marriage_s, age_s)<span class="sc">%&gt;%</span></span>
<span id="cb113-3"><a href="many_variables.html#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_linpred_draws</span>(m5_3)<span class="sc">%&gt;%</span> <span class="co"># add the predicted mean divorce rates</span></span>
<span id="cb113-4"><a href="many_variables.html#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Loc, divorce_s)<span class="sc">%&gt;%</span></span>
<span id="cb113-5"><a href="many_variables.html#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_qi</span>(<span class="at">x=</span>.linpred, <span class="at">.width =</span> <span class="fl">0.89</span>)<span class="sc">%&gt;%</span> <span class="co"># summarise each group in the df </span></span>
<span id="cb113-6"><a href="many_variables.html#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 50 x 8
##    Loc   divorce_s      x   .lower   .upper .width .point .interval
##    &lt;fct&gt;     &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
##  1 AK        1.54   0.323  0.00191  0.637     0.89 mean   qi       
##  2 AL        1.65   0.370  0.158    0.578     0.89 mean   qi       
##  3 AR        2.09   0.762  0.431    1.09      0.89 mean   qi       
##  4 AZ        0.611  0.121 -0.0380   0.278     0.89 mean   qi       
##  5 CA       -0.927 -0.353 -0.545   -0.162     0.89 mean   qi       
##  6 CO        1.05   0.118 -0.116    0.345     0.89 mean   qi       
##  7 CT       -1.64  -0.716 -0.982   -0.445     0.89 mean   qi       
##  8 DC       -1.86  -1.76  -2.40    -1.12      0.89 mean   qi       
##  9 DE       -0.433 -0.321 -0.639   -0.00287   0.89 mean   qi       
## 10 FL       -0.652 -0.120 -0.339    0.0988    0.89 mean   qi       
## # ... with 40 more rows</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="many_variables.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(plot_data_m5_3) <span class="co"># x is mean predicted divorce rate, .lower and .upper are 0.89 confidence interval limits</span></span></code></pre></div>
<pre><code>## # A tibble: 6 x 8
##   Loc   divorce_s      x   .lower .upper .width .point .interval
##   &lt;fct&gt;     &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 AK        1.54   0.323  0.00191  0.637   0.89 mean   qi       
## 2 AL        1.65   0.370  0.158    0.578   0.89 mean   qi       
## 3 AR        2.09   0.762  0.431    1.09    0.89 mean   qi       
## 4 AZ        0.611  0.121 -0.0380   0.278   0.89 mean   qi       
## 5 CA       -0.927 -0.353 -0.545   -0.162   0.89 mean   qi       
## 6 CO        1.05   0.118 -0.116    0.345   0.89 mean   qi</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="many_variables.html#cb117-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(plot_data_m5_3)<span class="sc">+</span></span>
<span id="cb117-2"><a href="many_variables.html#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointinterval</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>divorce_s, <span class="at">y=</span>x,<span class="at">ymin=</span>.lower,<span class="at">ymax=</span>.upper), </span>
<span id="cb117-3"><a href="many_variables.html#cb117-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">orientation =</span> <span class="st">&quot;vertical&quot;</span>,</span>
<span id="cb117-4"><a href="many_variables.html#cb117-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">colour =</span> <span class="st">&#39;#EE8866&#39;</span>)<span class="sc">+</span></span>
<span id="cb117-5"><a href="many_variables.html#cb117-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Observed Divorce Rate (std)&quot;</span>)<span class="sc">+</span></span>
<span id="cb117-6"><a href="many_variables.html#cb117-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Predicted Mean Divorce Rate (std)&quot;</span>)<span class="sc">+</span></span>
<span id="cb117-7"><a href="many_variables.html#cb117-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">intercept=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb117-8"><a href="many_variables.html#cb117-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data=</span>   plot_data_m5_3<span class="sc">%&gt;%</span></span>
<span id="cb117-9"><a href="many_variables.html#cb117-9" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">filter</span>(Loc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;ID&quot;</span>,<span class="st">&quot;UT&quot;</span>,<span class="st">&quot;RI&quot;</span>,<span class="st">&quot;ME&quot;</span>)),</span>
<span id="cb117-10"><a href="many_variables.html#cb117-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span> divorce_s, <span class="at">y=</span> x, <span class="at">label =</span> Loc ), <span class="at">nudge_x =</span> <span class="sc">-</span><span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="05-many_variables_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>States above the line have lower divorce rates than the model expects, given marriage rate and median age at marriage. States below the line have a higher divorce rate than the model expects.</p>
<p>There is a section in the chapter on variables that mask the influence of each other on the outcome of interest. A case study of primate milk and brain size is used to illustrate.</p>
<p>There is a section on using categorical data in regression models. The key point in this section is the argument for index variables over indicators variables when coding categorical variables.</p>
<p>With indicator variables you might look at the !Kung San data from the previous chapter, and decide to code men as 1 and women as 0 in a variable called <span class="math inline">\(m\)</span>. Your model for height might look like:</p>
<p><span class="math display">\[
\begin{aligned}
h_i &amp;∼ \text{Normal}(\mu_i, \sigma) \\
\mu_i &amp;= \alpha + \beta_m m_i
\end{aligned}
\]</span>
One problem with this is that the parameter <span class="math inline">\(\beta_m\)</span> now means the expected difference in height between men and women, and it may be difficult to set a prior. This approach also assumes that there is more uncertainty about male height than female height, since <span class="math inline">\(\beta_m\)</span> and its distribution doesn’t enter into our predictions for the height of women.</p>
<p>An alternative approach is to use index variables. You might code the !Kung San men as 1 and the women as 2 and your model might look like:</p>
<p><span class="math display">\[
\begin{aligned}
h_i &amp;∼ \text{Normal}(\mu_i, \sigma) \\
\mu_i &amp;= \alpha_{\text{sex}[i]} 
\end{aligned}
\]</span>
We have a vector of two intercept parameters and select either <span class="math inline">\(\alpha_1\)</span> or <span class="math inline">\(\alpha_2\)</span> depending on the index at each row of data. The same prior can be assigned to each, and neither is inherently more uncertain than the other.</p>
<p>The index approach also extends much more simply to more than two categories.</p>
</div>
<div id="questions-4" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Questions</h2>
<div id="e1-3" class="section level3 unnumbered">
<h3>5E1</h3>
<div id="question-45" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Which of the linear models below are multiple linear regressions?</p>
<ol style="list-style-type: decimal">
<li><p>µi = α + βxi</p></li>
<li><p>µi = βx * xi + βz * zi</p></li>
<li><p>µi = α + β(xi − zi)</p></li>
<li><p>µi = α + βx * xi + βz * zi</p></li>
</ol>
</blockquote>
</div>
<div id="answer-45" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Number 4 looks the most like the multiple regressions in the chapter: µ is regressed on both xi and zi with the “intercept” α. (2) is just (4) with the α set to zero, so that counts too.</p>
<p>Number 1 is just a bivariate regression.</p>
<p>Number 3 is interesting. I think this is not really a multiple regression, even though there are two variables. Rather than attempting to determine separately the influence of x and z on µ, you are asserting in the model that they have and equal and opposite impact. I think this is not really what you want a multiple regression to do, but don’t feel confident about my answer.</p>
</div>
</div>
<div id="e2-3" class="section level3 unnumbered">
<h3>5E2</h3>
<div id="question-46" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Write down a multiple regression to evaluate the claim:</p>
<p>Animal diversity is linearly related to latitude, but only after controlling for plant diversity. You just need to write down the model definition.</p>
</blockquote>
</div>
<div id="answer-46" class="section level4 unnumbered">
<h4>Answer</h4>
<p>Oh boy. This question immediately feels like a trap with “animal diversity is <em>linearly</em> related to latitude.” Surely if I choose to use a multiple linear regression with two variables, and control for one, the only relationships I’ll observe will be linear.</p>
<p>I’m going to ignore the “linearly” part of the question from this point. It seems like the claim is that if I naively regress animal diversity on to latitude without accounting for plant diversity, I would find no relationship. I.e. that the relationship between latitude and animal diversity is masked.</p>
<p>If that interpretation is correct, I would start with a bivariate model.</p>
<p>$$
A_i Normal(, ) \</p>
<p>_i = + _L*L
$$</p>
<p>Where if the claim is true I would expect to see little relationship. I would then move on to a multiple regression including plant diversity:</p>
<p>$$
A_i Normal(, ) \</p>
<p>_i = + _L*L +_P * P
$$</p>
<p>and examine whether it appears as if a relationship has now emerged.</p>
</div>
</div>
<div id="e3-3" class="section level3 unnumbered">
<h3>5E3</h3>
<div id="question-47" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Write down a multiple regression to evaluate the claim: Neither amount of funding nor size of laboratory is by itself a good predictor of time to PhD degree; but together these variables are both positively associated with time to degree.</p>
<p>Write down the model definition and indicate which side of zero each slope parameter should be on.</p>
</blockquote>
</div>
<div id="answer-47" class="section level4 unnumbered">
<h4>Answer</h4>
<p>$$
T_i Normal(, ) \</p>
<p>_i = + _F*F +_S * S
$$</p>
<p>T - time to PhD degree
F - amount of funding
S - size of laboratory</p>
</div>
</div>
<div id="e4-3" class="section level3 unnumbered">
<h3>5E4</h3>
<div id="question-48" class="section level4 unnumbered">
<h4>Question</h4>
<blockquote>
<p>Suppose you have a single categorical predictor with 4 levels (unique values), labeled A, B, C and D. Let <span class="math inline">\(A_i\)</span> be an indicator variable that is 1 where case i is in category A. Also suppose <span class="math inline">\(B_i\)</span>, <span class="math inline">\(C_i\)</span>, and <span class="math inline">\(D_i\)</span> for the other categories.
Now which of the following linear models are inferentially equivalent ways to include the categorical variable in a regression? Models are inferentially equivalent when it’s possible to compute one posterior distribution from the posterior distribution of another model.</p>
<p><span class="math display">\[
\begin{aligned}
(1) \mu_i &amp;= \alpha + \beta_A A_i + \beta_B B_i + \beta_D D_i  \\
(2) \mu_i &amp;= \alpha + \beta_A A_i + \beta_B B_i + \beta_C C_i + \beta_D D_i \\ 
(3) \mu_i &amp;= \alpha + \beta_B B_i + \beta_C C_i + \beta_D D_i \\
(4) \mu_i &amp;= \alpha_A A_i + α_B B_i + α_C C_i + α_D D_i \\
(5) \mu_i &amp;= \alpha_A(1 − B_i − C_i −D_i) + \alpha_B B_i + \alpha_C C_i + \alpha_D D_i
\end{aligned}
\]</span></p>
</blockquote>
</div>
<div id="answer-48" class="section level4 unnumbered">
<h4>Answer</h4>
<p>1 is the standard indicator variable approach. Where A, B and D are equal to 0, <span class="math inline">\(\alpha\)</span> is the mean <span class="math inline">\(\mu\)</span> where the predictor is at level C.
2 There is redundancy in two, surely it wouldn’t be possible to estimate <span class="math inline">\(\alpha\)</span> - it can take any value and produce the same <span class="math inline">\(\mu\)</span> so long as the appropriate <span class="math inline">\(\beta_x\)</span> adjusts to compensate. I don’t know if that means it is not inferentially equivalent though.
3 is clearly equivalent to (1), it doesn’t make a difference (except for interpretation) which of the levels you label null.
4 Is equivalent also, just set <span class="math inline">\(\alpha_c\)</span> equal to <span class="math inline">\(\alpha\)</span> from (1).
5 Is an incredibly annoying way to set up your model, but can be pretty easily transformed into (3) with some algebra and relabelling:</p>
<p><span class="math display">\[
\begin{aligned}
\mu_i &amp;= \alpha_A(1 − B_i − C_i −D_i) + \alpha_B B_i + \alpha_C C_i + \alpha_D D_i \\
&amp;= \alpha_A + (\alpha_B-\alpha_A)B_i + (\alpha_C -\alpha_A)C_i +(\alpha_D-\alpha_A)D_i  \\
&amp;= \alpha + \beta_B B_i + \beta_C C_i + \beta_D D_i
\end{aligned}          
\]</span></p>
</div>
</div>
</div>
<div id="further-reading-4" class="section level2 unnumbered">
<h2>Further Reading</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="geocentric.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="haunted_dag.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-many_variables.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
